import{_ as M}from"./Pagination.f4a9fc5d.js";import{_ as Z}from"./LoadingOverlay.vue_vue_type_script_setup_true_lang.89ce9ad6.js";/* empty css                                                       */import{d as T,a as H,bO as K,B as y,c as z,Z as O,h as Q,y as W,w,i as L,o as u,e as c,j as _,k as f,f as a,t as s,bR as X,u as x,bq as ee,b6 as ae,z as C,bs as te,s as G,l as j,F as I,r as R,q as se,aR as oe}from"./index.3390162f.js";import{a as le}from"./index.f77b8e59.js";import{q as ne,D as re,E as ie,I as de,J as ue}from"./index.30e99442.js";import{_ as ce}from"./PageHeader.vue_vue_type_script_setup_true_lang.546c13dd.js";import{h as _e}from"./helper.569bc08f.js";import"./_plugin-vue_export-helper.cdc0426e.js";import"./vue.runtime.esm-bundler.84001772.js";import"./sweetalert2.all.fdef424e.js";import"./moment.2cad4b18.js";const me={class:"collapse__block"},pe={class:"row"},fe={class:"my-2 col-md-6 form--item"},he={for:"yu"},ve={class:"my-2 col-md-6 form--item"},ye={for:"yu"},be={class:"my-2 col-md-3 form--item"},ge={for:"yu"},$e={class:"my-2 col-md-3 form--item"},we={for:"yu"},Fe={class:"text-danger"},ke={class:"my-2 col-md-4 form--item"},Ee={for:"yu"},Ne={class:"text-danger"},Ce={class:"my-2 col-md-2"},Pe=["disabled"],Be={key:0,class:"spinner-border spinner-border-sm me-1",role:"status","aria-hidden":"true"},Se={key:1,class:"mdi mdi-plus font-size-14 align-middle me-1"},Ve=T({__name:"ExamScheduleFilter",props:{filterForm:{}},emits:["search","open","update:filterForm"],setup(A,{emit:b}){const P=A,B=b,{t:S}=H(),F=K(),h=y(!1),n=y([]),p=y([]),k=y([]),E=y([]),i=y([]),m=y(),d=z({get(){return P.filterForm},set(e){B("update:filterForm",e)}}),g=O({academic_group_id:[],edu_plan_id:[],semester_id:[]}),$=Q(),N=z(()=>{var e,t;return(t=(e=$==null?void 0:$.user)==null?void 0:e.faculty)==null?void 0:t.name});W(async()=>{Promise.all([ne()]).then(e=>{n.value=e.result}),await D(),await l(),await V(),P.filterForm.academic_year_id=m.value}),w(d,async(e,t)=>{B("search")},{deep:!0}),w(()=>d.value.faculty_id,async e=>D(e)),w(()=>d.value.edu_plan_id,e=>{l()},{immediate:!0}),w(()=>d.value.academic_year_id,async(e,t)=>{U(d.value)},{immediate:!0}),w(()=>d.value.edu_plan_id,async(e,t)=>{U(d.value)},{immediate:!0}),w(()=>d.value.edu_plan_id,async e=>V(e));async function q(){var e,t;try{h.value=!0;const o={semester_id:d.value.semester_id,academic_group_id:d.value.academic_group_id},r=await le(o);F.success(S("Data_stored_successfully")),B("open",r.result.id)}catch(o){Object.assign(g,(t=(e=o.response)==null?void 0:e.data)==null?void 0:t.errors)}finally{h.value=!1}}async function D(e){var o;const t=await re(e);p.value=(o=t.result)==null?void 0:o.data}async function l(){var t,o;const e=await ie();k.value=(t=e.result)==null?void 0:t.data,m.value=(o=e.result)==null?void 0:o.data.find(r=>r.is_current==!0).id}async function U(e){var t;if(e.edu_plan_id){const o=await de(e);E.value=(t=o==null?void 0:o.result)==null?void 0:t.data.map(r=>({id:r.id,name:r.semester+"-"+S("semester_number")+" / "+r.course+"-"+S("course_number")}))}}async function V(e){var o;const t=await ue(e);i.value=(o=t.result)==null?void 0:o.data}return(e,t)=>{const o=L("a-select"),r=L("a-space"),Y=L("b-card"),J=L("b-collapse");return u(),c("div",me,[_(J,{visible:"",id:"collapse-3"},{default:f(()=>[_(Y,null,{default:f(()=>[a("div",pe,[a("div",fe,[_(r,null,{default:f(()=>[_(o,{class:"form--item",value:N.value,"onUpdate:value":t[0]||(t[0]=v=>N.value=v),"field-names":{value:"id",label:"name"},options:n.value,disabled:"","allow-clear":"","show-search":""},null,8,["value","options"])]),_:1}),a("label",he,s(e.$t("Choose_faculty")),1)]),a("div",ve,[_(r,null,{default:f(()=>[_(o,{value:e.filterForm.edu_plan_id,"onUpdate:value":t[1]||(t[1]=v=>e.filterForm.edu_plan_id=v),class:"form--item","field-names":{value:"id",label:"name"},options:p.value,"allow-clear":"","show-search":""},null,8,["value","options"])]),_:1}),a("label",ye,s(e.$t("Choose_Curriculum")),1)]),a("div",be,[_(r,null,{default:f(()=>[_(o,{class:"form--item",value:e.filterForm.academic_year_id,"onUpdate:value":t[2]||(t[2]=v=>e.filterForm.academic_year_id=v),"field-names":{value:"id",label:"name"},options:k.value,disabled:!e.filterForm.edu_plan_id,"allow-clear":"","show-search":""},null,8,["value","options","disabled"])]),_:1}),a("label",ge,s(e.$t("Choose_Education_Year")),1)]),a("div",$e,[_(r,null,{default:f(()=>[_(o,{class:"form--item",value:e.filterForm.semester_id,"onUpdate:value":t[3]||(t[3]=v=>e.filterForm.semester_id=v),"field-names":{value:"id",label:"name"},options:E.value,"allow-clear":"",disabled:E.value.length==0,"show-search":""},null,8,["value","options","disabled"])]),_:1}),a("label",we,s(e.$t("Choose_Semester")),1),a("span",Fe,s(g.semester_id[0]),1)]),a("div",ke,[_(r,null,{default:f(()=>[_(o,{class:"form--item",value:e.filterForm.academic_group_id,"onUpdate:value":t[4]||(t[4]=v=>e.filterForm.academic_group_id=v),"field-names":{value:"id",label:"name"},options:i.value,disabled:E.value.length==0,"allow-clear":"","show-search":""},null,8,["value","options","disabled"])]),_:1}),a("label",Ee,s(e.$t("Select_Group")),1),a("span",Ne,s(g.academic_group_id[0]),1)]),a("div",Ce,[a("button",{class:"btn-search c-save",type:"button",onClick:q,disabled:!e.filterForm.academic_group_id||!e.filterForm.semester_id},[h.value?(u(),c("span",Be)):(u(),c("i",Se)),a("span",null,s(e.$t("Create")),1)],8,Pe)])])]),_:1})]),_:1})])}}}),Le=X();async function Ae(A){try{const{data:b}=await Le({url:"/api/exam-schedules",params:A});return b}catch(b){throw b}}const De={pagetitle:"'Dars jadvali'",class:"schedule-list-page"},Ue={class:"filterBlock"},Ye={class:"btns c-save py-1.5 px-4 me-3",type:"submit"},je=a("i",{class:"mdi mdi-download font-size-14 align-middle me-1"},null,-1),qe={class:"btns c-filter py-1.5 px-4"},Oe=a("i",{class:"mdi mdi-filter font-size-14 align-middle me-1"},null,-1),ze={class:"card"},Ge={class:"card-body"},Ie={key:1,class:"table-responsive"},Re={class:"content-table"},Te={class:"table-row w-100 d-grid"},He=a("i",{class:"mdi mdi-arrow-top-right me-1"},null,-1),Je={key:0},Me={key:1},Ze={key:2},Ke={class:"text-center"},Qe={class:"text-center mb-0"},We={key:0,class:"element-count mb-2"},Xe={key:0},ca=T({__name:"index",async setup(A){let b,P;const{t:B}=H(),S=x(),F=y(!1),h=y({sequenceNumber:null,theNumber:null,sorting:null}),n=O({current_page:1,data:[],links:[]}),p=O({faculty_id:null,edu_plan_id:null,edu_form_id:null,academic_year_id:null,semester_id:null,academic_group_id:null,per_page:_e.pagePer});[b,P]=ee(()=>k()),await b,P(),w(()=>n.current_page,async i=>{i&&await k()});async function k(){F.value=!0;const i={...p,page:n.current_page},m=await Ae(i);Object.assign(n,m.result),p.academic_group_id&&n.data.length&&n.data.map(N=>({id:N.id}));let d=`${n.current_page}- ${n.data.length+n.per_page*(n.current_page-1)}`,g=`${B("Total_Point")} : ${n.total}`,$=n.per_page*(n.current_page-1);F.value=!1,h.value.sequenceNumber=d,h.value.theNumber=g,h.value.sorting=$}function E(i){Object.getOwnPropertyNames(p).forEach(d=>{p[d]&&p[d]});const m=`/curriculum/exam-schedule/${i}`;S.push({path:m})}return(i,m)=>{const d=ce,g=Ve,$=Z,N=L("router-link"),q=M,D=ae("b-toggle");return u(),c("div",De,[_(d,null,{title:f(()=>[C(s(i.$t("Curriculum_Exam_Schedule")),1)]),default:f(()=>[a("div",Ue,[a("button",Ye,[je,C(s(i.$t("Download")),1)]),te((u(),c("button",qe,[Oe,C(s(i.$t("Filter")),1)])),[[D,void 0,void 0,{"collapse-3":!0}]])])]),_:1}),_(g,{"filter-form":p,"onUpdate:filterForm":m[0]||(m[0]=l=>p=l),onSearch:k,onOpen:E},null,8,["filter-form"]),a("div",ze,[a("div",Ge,[F.value?(u(),G($,{key:0})):j("",!0),n.data.length?(u(),c("div",Ie,[a("table",Re,[a("thead",null,[a("tr",Te,[a("th",null,s(i.$t("Curriculum")),1),a("th",null,s(i.$t("Education_Year_Name")),1),a("th",null,s(i.$t("Semester_Name")),1),a("th",null,s(i.$t("Group")),1),a("th",null,s(i.$t("Subjects_midterm_final")),1)])]),a("tbody",null,[(u(!0),c(I,null,R(n.data,(l,U)=>{var V,e,t,o;return u(),c("tr",{class:"table-row w-100 d-grid",key:U},[a("td",null,s((V=l==null?void 0:l.edu_plan)==null?void 0:V.name),1),a("td",null,s((e=l==null?void 0:l.academic_year)==null?void 0:e.name),1),a("td",null,s((t=l==null?void 0:l.semester)==null?void 0:t.semester)+"- "+s(i.$t("semester_number")),1),a("td",null,[_(N,{class:"btn text-primary p-0",type:"button",to:`/curriculum/exam-schedule/${l.id}?semester_id=${(o=l==null?void 0:l.semester)==null?void 0:o.id}`},{default:f(()=>{var r;return[He,C(" "+s((r=l==null?void 0:l.academic_group)==null?void 0:r.name),1)]}),_:2},1032,["to"])]),a("td",null,[(u(!0),c(I,null,R(l.exams,(r,Y)=>(u(),c("div",{key:Y},[a("span",{class:se([r.count!=0?"actions-h":"actions-r","btns1"])},[C(" \u2116"+s(Y+1)+"| "+s(r.subject)+" ",1),r.count?(u(),c("span",Me,"- ["+s(r.count)+"]",1)):(u(),c("span",Je,"- [0]"))],2)]))),128))])])}),128))])]),n.last_page>1?(u(),G(q,oe({key:0,class:"mt-2"},{...n},{"current-page":n.current_page,"onUpdate:currentPage":m[1]||(m[1]=l=>n.current_page=l),loading:F.value}),null,16,["current-page","loading"])):j("",!0)])):(u(),c("div",Ze,[a("h5",Ke,s(i.$t("No_data")),1),a("p",Qe,s(i.$t("No_information_found")),1)]))])]),n.data.length?(u(),c("span",We,[n.last_page>1?(u(),c("span",Xe,s(h.value.sequenceNumber)+" / ",1)):j("",!0),C(s(h.value.theNumber),1)])):j("",!0)])}}});export{ca as default};
