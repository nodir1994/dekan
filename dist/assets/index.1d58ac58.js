import{d as A,bO as X,B as w,a as R,Z as M,bn as ee,y as ae,w as Y,i as v,o as i,e as _,f as a,t as d,j as h,k as I,g as $,l as C,F as z,s as B,z as L,v as Z,bS as E,p as se,m as te,bq as T,b6 as oe,bs as de,r as V,aR as le}from"./index.3390162f.js";import{c as ie,e as ne,a as ce,b as re,s as _e,d as ue,f as me,u as pe,g as ge,h as he,i as fe}from"./list.485ff60c.js";import"./sweetalert2.all.fdef424e.js";import"./moment.2cad4b18.js";import{_ as ve}from"./_plugin-vue_export-helper.cdc0426e.js";import{_ as ye}from"./Pagination.f4a9fc5d.js";import{h as q}from"./helper.569bc08f.js";const U=N=>(se("data-v-ff195953"),N=N(),te(),N),be={id:"coordinatorNameModal",class:"modal fade selectionSubject",tabindex:"-1","aria-labelledby":"myModalLabel","aria-hidden":"true"},$e={class:"modal-dialog"},Ce={class:"modal-content"},we={class:"modal-header bg-card-header"},ke={class:"modal-title",id:"myModalLabel"},Ie=U(()=>a("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal"},[a("i",{class:"mdi mdi-close"})],-1)),Le={class:"modal-body"},Ne={class:"row"},Se={class:"mb-3"},Oe={key:0,class:"text-danger small"},Be={class:"mb-3 height-auto"},Me={key:0,class:"text-danger small"},xe={key:0,class:"text-danger small"},Pe={class:"mb-3"},Ue={key:2,class:"text-danger small"},je={class:"mb-3"},Fe={key:2,class:"text-danger small"},De={class:"d-flex justify-content-between"},Ye=U(()=>a("i",{class:"mdi mdi-close font-size-14 align-middle me-1"},null,-1)),ze=U(()=>a("i",{class:"mdi mdi-delete font-size-14 align-middle me-1"},null,-1)),Ee=["disabled"],Ge=U(()=>a("i",{class:"mdi mdi-content-save font-size-14 align-middle me-1"},null,-1)),Te=["disabled"],Ve=U(()=>a("i",{class:"mdi mdi-content-save font-size-14 align-middle me-1"},null,-1)),qe=A({__name:"CoordinatorNameModal",props:{getId:null,coordinatorName:null,coordinatorId:null},emits:["update:list","close"],setup(N,{emit:y}){const r=N,S=X();w();const o=y,{t:g}=R(),b=w(!1),t=M({edu_plan_id:null,semester_id:null,academic_group_id:null,academic_group_ids:[],employee_id:null}),m=M({edu_plan_id:[],semester_id:[],academic_group_id:[],employee_id:[]});w(null);const n=M({eduPlanList:null,groupList:null,semesterList:null,employeeList:null});ee(async()=>{if(r.getId){const l=await ie(r.getId);Object.assign(t,l.result)}}),ae(async()=>{const l=document.getElementById("coordinatorNameModal");l==null||l.addEventListener("hidden.bs.modal",e=>{j(),D(),o("close")}),n.eduPlanList=await ne().then(e=>{var s;return(s=e.result)==null?void 0:s.data}),n.employeeList=await ce().then(e=>{var s;return(s=e.result)==null?void 0:s.data.map(u=>{var f,c;return{employee_id:(f=u.coordinator)==null?void 0:f.id,fullname:(c=u.coordinator)==null?void 0:c.full_name}})}),n.groupList=await re().then(e=>{var s;return(s=e.result)==null?void 0:s.data})}),Y(()=>t.edu_plan_id,async l=>{t.edu_plan_id&&(n.semesterList=await _e(t.edu_plan_id).then(e=>{var s;return(s=e.result)==null?void 0:s.data.map(u=>({id:u.id,name:u.semester+`-${g("semestr")}`}))}),n.groupList=await ue(t.edu_plan_id).then(e=>{var s;return(s=e.result)==null?void 0:s.data}))});function O(){E.getOrCreateInstance("#coordinatorNameModal").hide()}async function F(l){let e=l;b.value=!0;try{await me(e),S.success(g("Deleted_successfully")),O(),o("update:list")}catch(s){console.log(s)}finally{b.value=!1}}async function k(){var e,s,u,f,c;let l=M({});t.semester_id&&(l.semester_id=t.semester_id),t.employee_id&&(l.employee_id=t.employee_id),r.coordinatorId&&r.coordinatorName&&(l.employee_id=r.coordinatorId),t.academic_group_ids.length>1&&(l.academic_group_ids=t.academic_group_ids),t.academic_group_id&&(l.academic_group_id=t.academic_group_id);try{b.value=!0,j(),r.getId?await pe(r.getId,l):await ge(l),r.getId?S.success(g("Data_stored_successfully")):S.success(g("success_created")),o("update:list"),O()}catch(x){Object.assign(m,(s=(e=x.response)==null?void 0:e.data)==null?void 0:s.errors),((u=x.response)==null?void 0:u.status)===500&&S.error(g("Failed")+": "+((c=(f=x.response)==null?void 0:f.data)==null?void 0:c.message))}finally{b.value=!1}}function j(){Object.assign(m,{edu_plan_id:[],semester_id:[],academic_group_id:[],employee_id:[]})}function D(){Object.assign(t,{edu_plan_id:null,semester_id:null,academic_group_id:null,employee_id:null})}return(l,e)=>{const s=v("a-select"),u=v("a-space"),f=v("a-form");return i(),_("div",be,[a("div",$e,[a("div",Ce,[a("div",we,[a("h5",ke,d(l.$t("Coordinator")),1),Ie]),a("div",Le,[h(f,{autocomplete:"",onSubmit:Z(k,["prevent"])},{default:I(()=>[a("div",Ne,[a("div",Se,[h(s,{value:t.edu_plan_id,"onUpdate:value":e[0]||(e[0]=c=>t.edu_plan_id=c),options:n==null?void 0:n.eduPlanList,"field-names":{value:"id",label:"name"},placeholder:$(g)("Choose_Curriculum")},null,8,["value","options","placeholder"]),m.edu_plan_id?(i(),_("span",Oe,d(m.edu_plan_id[0]),1)):C("",!0)]),a("div",Be,[r.getId?(i(),_(z,{key:0},[h(s,{value:t.academic_group_id,"onUpdate:value":e[1]||(e[1]=c=>t.academic_group_id=c),options:n.groupList,disabled:!n.groupList,"field-names":{value:"id",label:"name"},style:{width:"200px"},placeholder:$(g)("Select_Groups")},null,8,["value","options","disabled","placeholder"]),m.academic_group_id?(i(),_("span",Me,d(m.academic_group_id[0]),1)):C("",!0)],64)):(i(),B(u,{key:1,direction:"vertical"},{default:I(()=>[h(s,{required:"",value:t.academic_group_ids,"onUpdate:value":e[2]||(e[2]=c=>t.academic_group_ids=c),mode:"multiple",disabled:!n.groupList,options:n.groupList,"field-names":{value:"id",label:"name"},style:{width:"200px"},placeholder:$(g)("Select_Groups")},null,8,["value","disabled","options","placeholder"]),m.academic_group_ids?(i(),_("span",xe,d(m.academic_group_ids[0]),1)):C("",!0)]),_:1}))]),a("div",Pe,[r.getId?(i(),B(s,{key:0,value:t.semester_id,"onUpdate:value":e[3]||(e[3]=c=>t.semester_id=c),options:n==null?void 0:n.semesterList,disabled:!t.academic_group_id||!t.edu_plan_id,"field-names":{value:"id",label:"name"},placeholder:$(g)("Choose_Semester")},null,8,["value","options","disabled","placeholder"])):(i(),B(s,{key:1,value:t.semester_id,"onUpdate:value":e[4]||(e[4]=c=>t.semester_id=c),options:n==null?void 0:n.semesterList,disabled:!t.academic_group_ids.length||!t.edu_plan_id,"field-names":{value:"id",label:"name"},placeholder:$(g)("Choose_Semester")},null,8,["value","options","disabled","placeholder"])),m.semester_id?(i(),_("span",Ue,d(m.semester_id[0]),1)):C("",!0)]),a("div",je,[r.getId?(i(),B(s,{key:0,value:t.employee_id,"onUpdate:value":e[5]||(e[5]=c=>t.employee_id=c),options:n==null?void 0:n.employeeList,"field-names":{value:"employee_id",label:"fullname"},placeholder:$(g)("Choose_a_coordinator"),disabled:""},null,8,["value","options","placeholder"])):(i(),B(s,{key:1,value:r.coordinatorName,placeholder:$(g)("Choose_a_coordinator"),disabled:""},null,8,["value","placeholder"])),m.employee_id?(i(),_("span",Fe,d(m.employee_id[0]),1)):C("",!0)])]),a("div",De,[a("button",{onClick:e[6]||(e[6]=c=>O()),type:"button",class:"btns c-cancel me-1"},[Ye,L(d(l.$t("Close")),1)]),a("div",null,[r.getId?(i(),_("button",{key:0,onClick:e[7]||(e[7]=c=>F(r.getId)),type:"button",class:"btns c-delet me-1"},[ze,L(d(l.$t("Delete")),1)])):C("",!0),r.getId?(i(),_("button",{key:1,class:"btns c-save",type:"submit",disabled:!t.academic_group_id||!t.edu_plan_id||!t.employee_id||!t.semester_id},[Ge,L(" "+d(l.$t("Save")),1)],8,Ee)):(i(),_("button",{key:2,class:"btns c-save",type:"submit",disabled:!t.academic_group_ids.length||!t.edu_plan_id||!t.semester_id},[Ve,L(" "+d(l.$t("Save")),1)],8,Te))])])]),_:1})])])])])}}});const Ae=ve(qe,[["__scopeId","data-v-ff195953"]]),Re={pagetitle:"'Tyutor'",class:"academicGroupPage2"},Ze={class:"card panel-header-bg"},He={class:"card-body"},Je={class:"panel-header"},Ke={class:"card-title"},Qe={class:"panel-toggles"},We={class:"filterBlock"},Xe={class:"btns c-filter py-1.5 px-4"},ea=a("i",{class:"mdi mdi-filter me-2"},null,-1),aa={class:"collapse__block"},sa={class:"my-2 col-md-5 form--item"},ta={for:"yu"},oa={class:"my-2 col-md-5 form--item"},da={for:"yu2"},la={class:"my-2 col-md-2"},ia={type:"submit",class:"btn-search search-color"},na=a("i",{class:"mdi mdi-magnifying-glass me-2"},null,-1),ca={class:"card"},ra={class:"card-body"},_a={key:0,class:"table-responsive"},ua={class:"content-table"},ma={class:"table-row-academic-group2"},pa=a("th",null,"#",-1),ga=["onClick"],ha=a("i",{class:"mdi mdi-plus font-size-18"},null,-1),fa={class:"d-flex flex-wrap"},va=["onClick"],ya={key:1},ba={class:"text-center"},$a={class:"text-center"},Ca={key:0,class:"element-count mb-2"},Ma=A({__name:"index",async setup(N){let y,r;const{t:S}=R(),o=M({search:"",data:[],links:[],current_page:1,per_page:q.pagePer,academic_year_id:null}),g=w(!1),b=M({academicYearsOptions:null}),t=w(!0),m=w(null),n=w(),O=w();b.academicYearsOptions=([y,r]=T(()=>he().then(e=>{var s;return(s=e==null?void 0:e.result)==null?void 0:s.data})),y=await y,r(),y),o.academic_year_id=b.academicYearsOptions.find(e=>e.is_current==!0).id,[y,r]=T(()=>k()),await y,r(),Y(()=>o.current_page,async e=>{Number(e)&&(o.page=Number(e),await k(e))}),Y(()=>o.academic_year_id,async()=>{await k()});async function F(){await k()}async function k(e){let s={page:e||1};o.search&&(s.search=o.search),o.academic_year_id&&(s.academic_year_id=o.academic_year_id),g.value=!0;try{if(t.value){t.value=!1;const u=await fe(s);Object.assign(o,u.result),setTimeout(()=>{t.value=!0},q.loaderRefresh)}}catch(u){console.log(u)}finally{g.value=!1}}async function j(e){m.value=e,E.getOrCreateInstance("#coordinatorNameModal").show()}async function D(e,s){n.value=e,O.value=s,E.getOrCreateInstance("#coordinatorNameModal").show()}function l(){m.value=null}return(e,s)=>{const u=v("a-select"),f=v("a-space"),c=v("a-input"),x=v("a-form"),H=v("b-card"),J=v("b-collapse"),K=ye,Q=Ae,W=oe("b-toggle");return i(),_("div",Re,[a("div",Ze,[a("div",He,[a("div",Je,[a("h5",Ke,d(e.$t("coordinator_list")),1),a("div",Qe,[a("div",We,[de((i(),_("button",Xe,[ea,L(d(e.$t("Filter")),1)])),[[W,void 0,void 0,{"collapse-3":!0}]])])])])])]),a("div",aa,[h(J,{visible:"",id:"collapse-3"},{default:I(()=>[h(H,null,{default:I(()=>[h(x,{onSubmit:Z(F,["prevent"]),class:"row"},{default:I(()=>[a("div",sa,[h(f,null,{default:I(()=>[h(u,{"allow-clear":"",value:o.academic_year_id,"onUpdate:value":s[0]||(s[0]=p=>o.academic_year_id=p),"field-names":{value:"id",label:"name"},options:b.academicYearsOptions,placeholder:$(S)("Choose_Education_Year")},null,8,["value","options","placeholder"])]),_:1}),a("label",ta,d(e.$t("Choose_Education_Year")),1)]),a("div",oa,[h(f,null,{default:I(()=>[h(c,{allowClear:"",id:"yu",class:"form-control",value:o.search,"onUpdate:value":s[1]||(s[1]=p=>o.search=p)},null,8,["value"])]),_:1}),a("label",da,d(e.$t("name_group_fish_code")),1)]),a("div",la,[a("button",ia,[na,L(d(e.$t("search")),1)])])]),_:1})]),_:1})]),_:1})]),a("div",ca,[a("div",ra,[o.data.length?(i(),_("div",_a,[a("table",ua,[a("thead",null,[a("tr",ma,[pa,a("th",null,d(e.$t("coordinator_fish")),1),a("th",null,d(e.$t("Fixed_Groups")),1)])]),a("tbody",null,[(i(!0),_(z,null,V(o.data,(p,G)=>(i(),_("tr",{class:"table-row-academic-group2",key:G},[a("td",null,d((o.current_page-1)*o.per_page+G+1),1),a("td",{onClick:P=>D(p==null?void 0:p.fullname,p==null?void 0:p.employee_id),class:"coordinator_name"},[L(d(p==null?void 0:p.fullname)+" ",1),ha],8,ga),a("td",fa,[(i(!0),_(z,null,V(p.coordinator_groups,P=>(i(),_("span",{class:"actions-h me-1 mt-1",onClick:wa=>j(P==null?void 0:P.id)},d(P.name),9,va))),256))])]))),128))])]),o.last_page>1?(i(),B(K,le({key:0,class:"mt-2"},{...o},{"current-page":o.current_page,"onUpdate:currentPage":s[2]||(s[2]=p=>o.current_page=p)}),null,16,["current-page"])):C("",!0)])):(i(),_("div",ya,[a("h5",ba,d(e.$t("No_data")),1),a("p",$a,d(e.$t("No_information_found")),1)]))])]),o.data.length?(i(),_("span",Ca,d(o.current_page)+"-"+d((o==null?void 0:o.data.length)+o.per_page*(o.current_page-1))+"/ "+d(e.$t("Total_Point"))+": "+d(o.total),1)):C("",!0),h(Q,{"get-id":m.value,"coordinator-name":n.value,"coordinator-id":O.value,"onUpdate:list":k,onClose:l},null,8,["get-id","coordinator-name","coordinator-id"])])}}});export{Ma as default};
