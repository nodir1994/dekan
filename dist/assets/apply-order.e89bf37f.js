import{_ as re}from"./NoData.ac42776e.js";import{_ as ce}from"./Pagination.f4a9fc5d.js";import{_ as ue}from"./LoadingOverlay.vue_vue_type_script_setup_true_lang.89ce9ad6.js";/* empty css                                                       */import{bR as _e,d as me,u as pe,B as p,a as he,bO as ve,bq as X,y as fe,Z as k,w as C,c as be,i as L,o as _,e as h,f as e,j as r,k as f,z as u,t as l,s as x,l as $,bs as ee,bH as ae,F as ye,r as ge,aR as we,v as ke,g as b}from"./index.3390162f.js";import{j as Ce,l as $e,m as De}from"./index.30e99442.js";import"./id.5a6e5f30.js";import{h as j}from"./helper.569bc08f.js";/* empty css                                                               */import"./_plugin-vue_export-helper.cdc0426e.js";import"./vue.runtime.esm-bundler.84001772.js";import"./sweetalert2.all.fdef424e.js";import"./moment.2cad4b18.js";const E=_e();async function Fe(y){try{const{data:d}=await E({url:"/api/students",params:y});return d}catch(d){throw d}}async function Pe(y){try{const{data:d}=await E({url:"/api/commands/students",method:"POST",data:y});return d}catch(d){throw d}}async function Le(y){try{const{data:d}=await E({url:"/api/commands/list/enrollment",method:"GET",data:y});return d}catch(d){throw d}}const Ue={pagetitle:"'Buyruqqa biriktirish'",class:"apply-order-page"},Se={class:"card panel-header-bg"},Be={class:"card-body"},Ne={class:"panel-header"},Oe={class:"card-title"},Ye={class:"panel-toggles"},je={class:"btns black-c py-1.5 px-4",type:"submit"},Ee=e("i",{class:"mdi mdi-arrow-left font-size-14 align-middle me-1 me-1"},null,-1),Me={class:"row"},Ae={class:"col-xl-8"},Te={class:"card"},ze={class:"card-body"},Ge={key:1,class:"table-responsive"},Re={class:"content-table"},Ve={class:"table-row w-100 d-grid"},qe={class:"form-check"},Ie=e("th",null,"#",-1),He={class:"form-check"},Ze=["value"],Je=e("br",null,null,-1),Ke={class:"c-gray"},Qe=e("br",null,null,-1),We={key:0},Xe=e("br",null,null,-1),xe={key:0,class:"c-gray"},ea={key:2,class:"table-responsive"},aa={key:0,class:"element-count mb-2"},sa={class:"card"},ta={class:"card-body"},oa={class:"row"},la={class:"mb-3 col-md-10",name:"nameFaculty"},na={class:"col-md-2"},da=["disabled"],ia=e("i",{class:"mdi mdi-magnify font-size-14 align-middle me-1"},null,-1),ra=[ia],ca={class:"mb-3",name:"nameFaculty"},ua={class:"mb-3",name:"nameFaculty"},_a={class:"mb-3",name:"nameFaculty"},ma={class:"mb-3",name:"nameFaculty"},pa={class:"d-flex justify-content-end"},ha=e("i",{class:"mdi mdi-cancel font-size-14 align-middle me-1"},null,-1),va={class:"card"},fa={class:"card-body"},ba={class:"mb-3"},ya={for:"division-name-input",class:"form-label"},ga={class:"mb-3",name:"nameFaculty"},wa={for:"division-name-select",class:"form-label"},ka={class:"mb-3",name:"nameFaculty"},Ca={for:"division-name-input",class:"form-label"},$a={class:"d-flex justify-content-end"},Da=["disabled"],Fa=e("i",{class:"mdi mdi-check font-size-14 align-middle me-1"},null,-1),za=me({__name:"apply-order",async setup(y){let d,D;pe(),p(null);const{t:m}=he(),U=p(!1),M=ve();p([]);const A=p([]),S=p([]),B=p([]),N=p(!0),T=([d,D]=X(()=>Le().then(a=>a.result.data)),d=await d,D(),d);fe(async()=>{Promise.all([Ce()]).then(a=>{A.value=a[0].result})});const i=k({current_page:1,per_page:j.pagePer,data:[],links:[]}),o=k({page:1,edu_plan_id:null,academic_group_id:null,faculty_id:null,semester_id:null,course:null,academic_year_id:null,per_page:j.pagePer,search:""}),n=k({command_id:null,students:[]}),z=k({semester_id:[],specialty_id:[]}),F=p([]);[d,D]=X(()=>v()),await d,D(),C(()=>i.current_page,async a=>{Number(a)&&(o.page=Number(a),await v(a))}),C(()=>o.edu_plan_id,async function(a){var s;if(await v(),a){const c=await $e(a);S.value=(s=c.result)==null?void 0:s.data.map(g=>({id:g.id,name:g.semester+"-"+m("semester_number")}))}}),C(()=>o.semester_id,async function(a){if(a){const s=await De(a);B.value=s.result,await v()}});const O=p();C(()=>o.search,async(a,s)=>{o.search==""&&O.value==1&&(await v(),O.value=0)});async function se(){await v(),O.value=1}async function v(a){U.value=!0;let s=k({page:a||1,per_page:o.per_page});o.edu_plan_id&&(s.edu_plan_id=o.edu_plan_id),o.academic_group_id&&(s.academic_group_id=o.academic_group_id),o.faculty_id&&(s.faculty_id=o.faculty_id),o.semester_id&&(s.semester_id=o.semester_id),o.course&&(s.course=o.course),o.academic_year_id&&(s.academic_year_id=o.academic_year_id),o.search!=""&&(s.search=o.search);try{if(N.value){N.value=!1;const c=await Fe(s);Object.assign(i,c.result),F.value=i.data.map(g=>g.id),setTimeout(()=>{N.value=!0},j.loaderRefresh)}}catch(c){console.log(c)}finally{U.value=!1}}const G=be({get(){return n.students.length===F.value.length},set(a){a?n.students=F.value:n.students=[]}});C(()=>n.command_id,()=>{n.command_id?n.dateCommand=T.find(a=>a.id==n.command_id).date:n.dateCommand=null});async function te(){var a,s;try{const c=await Pe(n);M.success(m("Decree_name_applied_to_count_students")),F.value=[],n.students=[],n.command_id=null,oe(),await v()}catch(c){Object.assign(z,(s=(a=c.response)==null?void 0:a.data)==null?void 0:s.errors),M.error(m("Failed")+": "+c.message)}}function oe(){Object.assign(z,{specialty_id:[],semester_id:[],academic_group_id:[]})}function le(){o.edu_plan_id=null,o.academic_group_id=null,o.semester_id=null,o.course=null,o.academic_year_id=null,o.search=""}return(a,s)=>{var R,V,q,I;const c=L("router-link"),g=ue,ne=ce,de=re,Y=L("a-input"),w=L("a-select"),P=L("a-select-option");return _(),h("div",Ue,[e("div",Se,[e("div",Be,[e("div",Ne,[e("h5",Oe,[r(c,{to:"/status-student/order-list"},{default:f(()=>[u(l(a.$t("Decree"))+" / ",1)]),_:1}),u(" "+l(a.$t("Decree_Apply")),1)]),e("div",Ye,[r(c,{to:"/status-student/order-list"},{default:f(()=>[e("button",je,[Ee,u(l(a.$t("Back")),1)])]),_:1})])])])]),e("div",Me,[e("div",Ae,[e("div",Te,[e("div",ze,[U.value?(_(),x(g,{key:0})):$("",!0),i.data.length?(_(),h("div",Ge,[e("table",Re,[e("thead",null,[e("tr",Ve,[e("th",null,[e("div",qe,[ee(e("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":s[0]||(s[0]=t=>G.value=t)},null,512),[[ae,G.value]])])]),Ie,e("th",null,l(a.$t("Student")),1),e("th",null,l(a.$t("Education_Type")),1),e("th",null,l(a.$t("by_Level")),1),e("th",null,l(a.$t("Group")),1)])]),e("tbody",null,[(_(!0),h(ye,null,ge(i.data,(t,H)=>{var Z,J,K,Q,W;return _(),h("tr",{class:"table-row w-100 d-grid",key:H},[e("td",null,[e("div",He,[ee(e("input",{type:"checkbox",class:"form-check-input","onUpdate:modelValue":s[1]||(s[1]=ie=>n.students=ie),value:t.id},null,8,Ze),[[ae,n.students]])])]),e("td",null,l((i.current_page-1)*i.per_page+H+1),1),e("td",null,[e("div",null,[u(l(t.surname)+" "+l(t.name)+" "+l(t.last_name),1),Je,e("span",Ke,l(t.id),1)])]),e("td",null,[e("div",null,[u(l((J=(Z=t==null?void 0:t.specialty)==null?void 0:Z.edu_type)==null?void 0:J.name)+" ",1),Qe])]),e("td",null,[(K=t==null?void 0:t.semester)!=null&&K.course?(_(),h("div",We,[u(l((Q=t==null?void 0:t.semester)==null?void 0:Q.course)+" - "+l(a.$t("Course")),1),Xe,t.semester.semester?(_(),h("span",xe,l(t.semester.semester)+"- "+l(a.$t("semester")),1)):$("",!0)])):$("",!0)]),e("td",null,l((W=t==null?void 0:t.academic_group)==null?void 0:W.name),1)])}),128))])]),i.last_page>1?(_(),x(ne,we({key:0,class:"mt-2"},{...i},{"current-page":i.current_page,"onUpdate:currentPage":s[2]||(s[2]=t=>i.current_page=t)}),null,16,["current-page"])):$("",!0)])):(_(),h("div",ea,[r(de)]))])]),i.data.length?(_(),h("span",aa,l(i.current_page)+"-"+l(i.data.length+i.per_page*(i.current_page-1))+"/ "+l(a.$t("Total_Point"))+": "+l(i.total),1)):$("",!0)]),e("form",{onSubmit:ke(te,["prevent"]),class:"col-xl-4"},[e("div",sa,[e("div",ta,[e("div",oa,[e("div",la,[r(Y,{value:o.search,"onUpdate:value":s[3]||(s[3]=t=>o.search=t),"allow-clear":"",style:{width:"100%","border-radius":"10px !important"},placeholder:b(m)("choose__fish__student__passport__code")},null,8,["value","placeholder"])]),e("div",na,[e("button",{onClick:se,"allow-clear":"",type:"button",class:"btn-search search-color",disabled:o.search==""||o.search==null},ra,8,da)]),e("div",ca,[r(w,{value:o.edu_plan_id,"onUpdate:value":s[4]||(s[4]=t=>o.edu_plan_id=t),"field-names":{value:"id",label:"name"},options:(R=A.value)==null?void 0:R.data,placeholder:b(m)("Choose_a_curriculum"),"allow-clear":""},null,8,["value","options","placeholder"])]),e("div",ua,[r(w,{value:o.course,"onUpdate:value":s[5]||(s[5]=t=>o.course=t),placeholder:b(m)("Choose_Level"),onChange:s[6]||(s[6]=t=>a.clearError("course"))},{default:f(()=>[r(P,{value:1,label:"1-course"},{default:f(()=>[u("1-"+l(a.$t("course_number")),1)]),_:1}),r(P,{value:2,label:"2-course"},{default:f(()=>[u("2-"+l(a.$t("course_number")),1)]),_:1}),r(P,{value:3,label:"3-course"},{default:f(()=>[u("3-"+l(a.$t("course_number")),1)]),_:1}),r(P,{value:4,label:"4-course"},{default:f(()=>[u("4-"+l(a.$t("course_number")),1)]),_:1})]),_:1},8,["value","placeholder"])]),e("div",_a,[r(w,{value:o.semester_id,"onUpdate:value":s[7]||(s[7]=t=>o.semester_id=t),"field-names":{value:"id",label:"name"},options:S.value,disabled:!S.value,placeholder:b(m)("Choose_Semester")},null,8,["value","options","disabled","placeholder"])]),e("div",ma,[r(w,{value:o.faculty_id,"onUpdate:value":s[8]||(s[8]=t=>o.faculty_id=t),"field-names":{value:"id",label:"name"},options:(V=B.value)==null?void 0:V.data,disabled:!B.value.data,placeholder:b(m)("Choose_Group")},null,8,["value","options","disabled","placeholder"])]),e("div",pa,[e("button",{type:"button",class:"btns c-delet me-1",onClick:s[9]||(s[9]=t=>le())},[ha,u(" "+l(a.$t("Clear")),1)])])])])]),e("div",va,[e("div",fa,[e("div",ba,[e("label",ya,l(a.$t("Count_of_Contract_Student")),1),r(Y,{value:(q=n.students)==null?void 0:q.length,disabled:""},null,8,["value"])]),e("div",ga,[e("label",wa,l(a.$t("Decree")),1),r(w,{value:n.command_id,"onUpdate:value":s[10]||(s[10]=t=>n.command_id=t),options:b(T),"field-names":{value:"id",label:"name"},placeholder:b(m)("Select_the_command")},null,8,["value","options","placeholder"])]),e("div",ka,[e("label",Ca,l(a.$t("Circulation_Doc_Date")),1),r(Y,{value:n.dateCommand,"onUpdate:value":s[11]||(s[11]=t=>n.dateCommand=t),placeholder:"YYYY-MM-DD",disabled:"","value-format":"YYYY-MM-DD"},null,8,["value"])]),e("div",$a,[e("button",{class:"btns c-save",type:"submit",disabled:!(((I=n.students)==null?void 0:I.length)>0)||!n.command_id},[Fa,u(l(a.$t("apply_Decree")),1)],8,Da)])])])],32)])])}}});export{za as default};
