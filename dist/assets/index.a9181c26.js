import{_ as W}from"./LoadingOverlay.vue_vue_type_script_setup_true_lang.89ce9ad6.js";/* empty css                                                       */import{bR as oa,d as j,a as A,B as v,Z as P,y as ia,w as I,o as e,e as s,f as a,s as O,l as x,t as n,F as c,r as m,z as C,h as ra,c as E,aU as da,bn as ua,i as q,b6 as ca,bs as pa,j as h,k as T,v as _a,g as M,aR as ma,q as va,bS as ha}from"./index.3390162f.js";import{_ as ya}from"./NoData.ac42776e.js";import{_ as fa}from"./Pagination.f4a9fc5d.js";import{f as ba,a0 as R}from"./index.30e99442.js";import{h as ga}from"./moment.2cad4b18.js";import{h as $}from"./helper.569bc08f.js";import"./vue.runtime.esm-bundler.84001772.js";/* empty css                                                               */import"./_plugin-vue_export-helper.cdc0426e.js";import"./sweetalert2.all.fdef424e.js";const G=oa();async function wa(L){try{const{data:p}=await G({url:"/api/report/teachers",params:L});return p}catch(p){throw p}}async function ka(L){try{const{data:p}=await G({url:"/api/report/teachers/topic",params:L});return p}catch(p){throw p}}const $a={class:"modal-dialog"},Na={class:"modal-content"},Ma={class:"modal-header bg-card-header"},Da={class:"modal-title",id:"myModalLabel"},La=a("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal"},[a("i",{class:"mdi mdi-close font-size-18"})],-1),Ba={class:"modal-body"},Sa={class:"table-responsive"},xa={class:"table-vertical"},Ca={class:"table-modal w-100 d-grid"},Ta=a("br",null,null,-1),Pa=j({__name:"ByStatisticalTeacherMapModal",props:{data:{}},emits:["update:list","close"],setup(L,{emit:p}){const F=L,y=p;A();const u=v(!1),f=v([]);P({name:[],code:[],department_id:[]}),v();const b=v(null);ia(()=>{var d;(d=b.value)==null||d.addEventListener("hidden.bs.modal",function(Y){y("close")})}),I(()=>F.data,async d=>{d&&await g()},{deep:!0});async function g(){try{u.value=!0;const d=await ka(F.data);f.value=d.result}catch(d){console.log(d)}finally{u.value=!1}}return(d,Y)=>{var k;const w=W;return e(),s("div",null,[a("div",{id:"ByStatisticalTeacherMapModal",ref_key:"ByStatisticalTeacherMapModal",ref:b,class:"modal fade",tabindex:"-1","aria-labelledby":"myModalLabel","aria-hidden":"true"},[a("div",$a,[a("div",Na,[u.value?(e(),O(w,{key:0})):x("",!0),a("div",Ma,[a("h5",Da,n((k=f.value[0])==null?void 0:k.employee),1),La]),a("div",Ba,[a("div",Sa,[a("table",xa,[a("thead",null,[a("tr",Ca,[a("th",null,[a("strong",null,n(d.$t("student_Sciences")),1)]),a("th",null,[a("strong",null,n(d.$t("employee")),1)]),a("th",null,[a("strong",null,n(d.$t("Group")),1)]),a("th",null,[a("strong",null,n(d.$t("Couple")),1)])])]),a("tbody",null,[(e(!0),s(c,null,m(f.value,(o,r)=>(e(),s("tr",{class:"table-modal w-100 d-grid",key:r},[a("td",null,[C(n(o==null?void 0:o.subject)+" ",1),Ta,C(" "+n(o==null?void 0:o.type),1)]),a("td",null,n(o==null?void 0:o.employee),1),a("td",null,n(o==null?void 0:o.academic_group),1),a("td",null,n(o==null?void 0:o.pair),1)]))),128))])])])])])])],512)])}}}),Fa={pagetitle:"`O'zlashtirish statistikasi`",class:"byRooms"},Ya={class:"card panel-header-bg"},Va={class:"card-body"},Ua={class:"panel-header"},qa={class:"card-title"},Ia={class:"panel-toggles"},Oa={class:"filterBlock"},Wa={class:"btns c-filter py-1.5 px-4"},za=a("i",{class:"mdi mdi-filter me-2"},null,-1),Ea={class:"collapse__block"},Ra={class:"col-md-4 d-flex"},ja={class:"row w-100"},Aa={class:"col-2 my-2"},Ga=["disabled"],Za=a("i",{class:"fas fa-chevron-left"},null,-1),Ha=[Za],Ja={class:"col-8"},Ka={class:"col-2 my-2"},Qa=["disabled"],Xa=a("i",{class:"fas fa-chevron-right"},null,-1),ae=[Xa],ee={class:"card"},te={class:"card-body"},se={key:1,class:"table-responsive table-statistical"},le={class:"position-sticky t-0"},ne=a("th",{rowspan:"2",style:{"min-width":"55px"}},"#",-1),oe={rowspan:"2",style:{"min-width":"200px"}},ie=["colspan"],re=a("br",null,null,-1),de=["onClick"],ue={key:2,class:"table-responsive"},ce={key:0},De=j({__name:"index",setup(L){const p=ra(),F=E(()=>{var l,i;return(i=(l=p==null?void 0:p.user)==null?void 0:l.faculty)==null?void 0:i.name}),y=v(!1),u=v(0),f=v(!1),b=v(!1),g=v([]),d=P({date:null,pair_id:null,employee_id:null}),Y=P({optionBuildingList:null,optionfacultyList:null,optiondepartmentList:null}),{t:w}=A(),k=v({sequenceNumber:null,theNumber:null,sorting:null}),o=P({building_id:null,department_id:null,per_page:$.pagePer,page:1}),r=P({pagination:{current_page:1,per_page:o.per_page,loading:!1},result:[]}),D=v(""),V=E(()=>{var i;const l=[{day:w("Monday"),date:""},{day:w("Tuesday"),date:""},{day:w("Wednesday"),date:""},{day:w("Thursday"),date:""},{day:w("Friday"),date:""},{day:w("Saturday"),date:""}];if(D.value){const _=(i=g.value)==null?void 0:i.find(N=>N.date===D.value);return Array(6).fill("").forEach((N,S)=>l[S].date=_&&ga(_.start_date,"YYYY-MM-DD").add(S,"days").format("YYYY-MM-DD")),{..._,weekDays:l}}else return{weekDays:l}});da(async()=>{y.value=!0,u.value==0&&(b.value=!0),Promise.all([ba(),R()]).then(l=>{Y.optiondepartmentList=l[0].result,g.value=l[1],D.value=l[1][u.value].date}),y.value=!1}),I(o,async(l,i)=>{await B()},{deep:!0}),I(()=>r.pagination.current_page,async l=>{Number(l)&&(o.page=Number(l),await B())}),I(u,async(l,i)=>{const _=await R();g.value=_,D.value=_[u.value].date},{deep:!0}),ua(async()=>{D&&await B()});function Z(){u.value+=1,(g.value.length-1<u.value||u.value>0)&&(f.value=!1,b.value=!1),g.value.length-1==u.value&&(f.value=!0,b.value=!1)}function H(){u.value-=1,(g.value.length-1<u.value||u.value>0)&&(f.value=!1,b.value=!1),u.value==0&&(b.value=!0,f.value=!1)}async function J(){await B()}async function B(){try{y.value=!0;const l={...o,start_date:V.value.start_date,end_date:V.value.end_date},i=await wa(l);Object.assign(r,i);let _=`${r.pagination.per_page*(r.pagination.current_page-1)+1}- ${r.result.length+r.pagination.per_page*(r.pagination.current_page-1)}`,N=`${w("Total_Point")} : ${r.pagination.total}`,S=r.pagination.per_page*(r.pagination.current_page-1);k.value.sequenceNumber=_,k.value.theNumber=N,k.value.sorting=S}catch(l){console.log(l)}finally{y.value=!1}}function K(l){d.date=l.date,d.pair_id=l.pair_id,d.employee_id=l.employee_id,ha.getOrCreateInstance("#ByStatisticalTeacherMapModal").show()}return(l,i)=>{const _=q("a-select"),N=q("a-form-item"),S=q("b-card"),Q=q("b-collapse"),X=fa,aa=ya,ea=Pa,ta=ca("b-toggle");return e(),s("div",Fa,[a("div",Ya,[a("div",Va,[a("div",Ua,[a("h5",qa,n(l.$t("Report_Teacher_Map")),1),a("div",Ia,[a("div",Oa,[pa((e(),s("button",Wa,[za,C(n(l.$t("Filtr")),1)])),[[ta,void 0,void 0,{"collapse-3":!0}]])])])])])]),a("div",Ea,[h(Q,{visible:"",id:"collapse-3"},{default:T(()=>[h(S,null,{default:T(()=>[a("form",{class:"row",onSubmit:_a(J,["prevent"])},[a("div",Ra,[a("div",ja,[a("div",Aa,[a("button",{disabled:b.value,onClick:i[0]||(i[0]=t=>H()),class:"b-prev"},Ha,8,Ga)]),a("div",Ja,[h(N,{class:"my-2",name:"nameFaculty",style:{"text-align":"center"}},{default:T(()=>[h(_,{value:D.value,"onUpdate:value":i[1]||(i[1]=t=>D.value=t),options:g.value,"field-names":{value:"date",label:"date"}},null,8,["value","options"])]),_:1})]),a("div",Ka,[a("button",{disabled:f.value,onClick:i[2]||(i[2]=t=>Z()),class:"b-next"},ae,8,Qa)])])]),h(N,{class:"my-2 col-md-4",name:"nameFaculty"},{default:T(()=>[h(_,{value:F.value,"field-names":{value:"id",label:"name"},allowClear:"",disabled:"",placeholder:l.$t("Select_the_faculty")},null,8,["value","placeholder"])]),_:1}),h(N,{class:"my-2 col-md-4",name:"nameFaculty"},{default:T(()=>[h(_,{value:o.department_id,"onUpdate:value":i[3]||(i[3]=t=>o.department_id=t),options:Y.optiondepartmentList,"field-names":{value:"id",label:"name"},allowClear:"",placeholder:l.$t("Select_a_cathedra")},null,8,["value","options","placeholder"])]),_:1})],32)]),_:1})]),_:1})]),a("div",ee,[a("div",te,[y.value?(e(),O(W,{key:0})):x("",!0),r.result.length?(e(),s("div",se,[a("table",null,[a("thead",le,[a("tr",null,[ne,a("th",oe,n(l.$t("Full_name")),1),(e(!0),s(c,null,m(V.value.weekDays,t=>(e(),s("th",{colspan:M($).paraNumber},[C(n(t.day)+" ",1),re,C(" "+n(t.date),1)],8,ie))),256))]),a("tr",null,[(e(!0),s(c,null,m(M($).paraNumber,t=>(e(),s("th",{key:t,style:{"min-width":"25px"}},n(t),1))),128)),(e(!0),s(c,null,m(M($).paraNumber,t=>(e(),s("th",{key:t,style:{"min-width":"25px"}},n(t),1))),128)),(e(!0),s(c,null,m(M($).paraNumber,t=>(e(),s("th",{key:t,style:{"min-width":"25px"}},n(t),1))),128)),(e(!0),s(c,null,m(M($).paraNumber,t=>(e(),s("th",{key:t,style:{"min-width":"25px"}},n(t),1))),128)),(e(!0),s(c,null,m(M($).paraNumber,t=>(e(),s("th",{key:t,style:{"min-width":"25px"}},n(t),1))),128)),(e(!0),s(c,null,m(M($).paraNumber,t=>(e(),s("th",{key:t,style:{"min-width":"25px"}},n(t),1))),128))])]),a("tbody",null,[(e(!0),s(c,null,m(r.result,(t,z)=>(e(),s("tr",{key:z},[a("td",null,n(k.value.sorting+z+1),1),a("td",null,n(t.surname)+" "+n(t.name)+" "+n(t.patronymic),1),(e(!0),s(c,null,m(V.value.weekDays,sa=>(e(),s(c,null,[(e(!0),s(c,null,m(M($).paraNumber,(la,na)=>(e(),s("td",{key:na,style:{padding:"1px"}},[(e(!0),s(c,null,m(t.topics,(U,pe)=>(e(),s(c,null,[Number(U.pair)===la&&U.date===sa.date?(e(),s("button",{key:0,class:"b-rooms",onClick:_e=>K(U)},n(U.count),9,de)):x("",!0)],64))),256))]))),128))],64))),256))]))),128))])]),r.pagination.last_page>1?(e(),O(X,ma({key:0,class:"mt-2"},{...r.pagination},{"current-page":r.pagination.current_page,"onUpdate:currentPage":i[4]||(i[4]=t=>r.pagination.current_page=t),loading:y.value,onOnPageChange:B}),null,16,["current-page","loading"])):x("",!0)])):(e(),s("div",ue,[y.value?(e(),O(W,{key:0})):x("",!0),h(aa)]))])]),h(ea,{data:d,"onUpdate:list":B},null,8,["data"]),a("span",{class:va(["element-count mb-2",r.pagination.total?"":"d-none"])},[r.pagination.last_page?(e(),s("span",ce,n(k.value.sequenceNumber)+" / ",1)):x("",!0),C(n(k.value.theNumber),1)],2)])}}});export{De as default};
