import{_ as de}from"./SubmitButton.vue_vue_type_script_setup_true_lang.fe21b651.js";import{bR as ie,d as G,B as k,a as Z,bO as x,Z as F,y as H,bn as ce,i as Y,o as i,e as _,f as e,t as s,v as J,j as f,l as w,z as B,bS as K,n as ue,u as _e,bq as me,w as q,b6 as pe,k as D,s as X,F as he,r as fe,q as ye,aR as ve,g as be}from"./index.3390162f.js";import{w as ge,l as Q}from"./index.30e99442.js";import{_ as ke}from"./Pagination.f4a9fc5d.js";import{_ as we}from"./LoadingOverlay.vue_vue_type_script_setup_true_lang.89ce9ad6.js";/* empty css                                                       */import"./plan.0a3ba948.js";import{h as $e}from"./helper.569bc08f.js";import"./_plugin-vue_export-helper.cdc0426e.js";import"./vue.runtime.esm-bundler.84001772.js";import"./sweetalert2.all.fdef424e.js";import"./moment.2cad4b18.js";const E=ie();async function Ce(v){try{const{data:r}=await E({url:"/api/weeks",method:"GET",params:v});return r}catch(r){throw r}}async function Me(v,r){try{const{data:y}=await E({url:`/api/weeks/${v}`,method:"PUT",data:r});return y}catch(y){throw y}}async function Se(v){try{const{data:r}=await E({url:`/api/weeks/${v}`,method:"GET"});return r}catch(r){throw r}}async function Ye(v){try{const{data:r}=await E({url:`/api/weeks/${v}/status`,method:"PUT"});return r}catch(r){throw r}}const Ie={id:"weekFormModal",class:"modal fade",tabindex:"-1","aria-labelledby":"myModalLabel","aria-hidden":"true"},Le={class:"modal-dialog"},Be={class:"modal-content"},De={class:"modal-header bg-card-header"},Fe={class:"modal-title",id:"myModalLabel"},Ne=e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal"},[e("i",{class:"mdi mdi-close font-size-18"})],-1),je={class:"modal-body"},Ee={class:"mb-3"},Oe=e("label",{for:"division-name-input",class:"form-label"},"Boshlanish sanasi",-1),Te={key:0,class:"text-danger small"},Ue={class:"mb-3"},We=e("label",{for:"division-name-input",class:"form-label"},"Tugash sanasi",-1),Pe={key:0,class:"text-danger small"},ze={class:"mb-3"},Ae=e("label",{for:"division-name-select",class:"form-label"},"Semestr",-1),Re={key:0,class:"text-danger small"},Ve={class:"mb-3"},qe=e("label",{for:"division-name-select",class:"form-label"},"Xafta turi",-1),Xe={key:0,class:"text-danger small"},Ge={class:"d-flex justify-content-end"},Ze={type:"button",class:"btns c-cancel me-1","data-bs-dismiss":"modal"},xe=e("i",{class:"mdi mdi-close font-size-14 align-middle me-1"},null,-1),He=e("i",{class:"mdi mdi-cancel font-size-14 align-middle me-1"},null,-1),Je=G({__name:"WeekFormModal",props:{weekId:null,curriculumId:null},emits:["update:list","close"],setup(v,{emit:r}){const y=v,I=k([]),N=k([]),b=r,{t:g}=Z(),$=x(),M=k(!1),c=F({date_start:"",date_end:"",type_id:null,semester_id:null}),p=F({date_start:[],date_end:[],type_id:[],semester_id:[]});k(),H(async()=>{var u;const d=document.getElementById("weekFormModal");d==null||d.addEventListener("hidden.bs.modal",m=>{n(),j(),b("close")}),I.value=await ge().then(m=>m.result);let o=await Q(y.curriculumId);N.value=(u=o==null?void 0:o.result)==null?void 0:u.data.map(m=>({id:m.id,name:m.semester+"-"+g("semester")+" / "+m.course+"-"+g("course_number")}))}),ce(async()=>{var d,o,u,m;if(y.weekId){const t=await Se(y.weekId);t.result.type_id=(o=(d=t==null?void 0:t.result)==null?void 0:d.type)==null?void 0:o.id,t.result.semester_id=(m=(u=t==null?void 0:t.result)==null?void 0:u.semester)==null?void 0:m.id,Object.assign(c,t.result)}});async function C(){var d,o;try{M.value=!0,j();const u=await Me(y.weekId,{date_start:c.date_start,date_end:c.date_end,type_id:c.type_id,semester_id:c.semester_id});$.success(g("Item_code_edited_to_Curriculum_Week")),b("update:list"),S()}catch(u){Object.assign(p,(o=(d=u.response)==null?void 0:d.data)==null?void 0:o.errors),u.response.status==422?$.error(g("Dashboard_Error")+": "+g("Fill_in_the_required_fields")):$.error(g("Dashboard_Error")+": "+u.message)}finally{M.value=!1}}function n(){Object.assign(c,{date_start:"",date_end:"",type_id:null,semester_id:null})}function j(){Object.assign(p,{date_start:[],date_end:[],type_id:[],semester_id:[]})}function S(){K.getOrCreateInstance("#weekFormModal").hide()}function L(d){p[d]=""}return(d,o)=>{const u=Y("a-date-picker"),m=Y("a-select"),t=de;return i(),_("div",Ie,[e("div",Le,[e("div",Be,[e("div",De,[e("h5",Fe,s(d.$t("Week_update")),1),Ne]),e("div",je,[e("form",{onSubmit:J(C,["prevent"])},[e("div",Ee,[Oe,f(u,{placeholder:"YYYY-MM-DD",value:c.date_start,"onUpdate:value":o[0]||(o[0]=l=>c.date_start=l),type:"date","value-format":"YYYY-MM-DD",onChange:o[1]||(o[1]=l=>L("date_start"))},null,8,["value"]),p.date_start?(i(),_("span",Te,s(p.date_start[0]),1)):w("",!0)]),e("div",Ue,[We,f(u,{placeholder:"YYYY-MM-DD",value:c.date_end,"onUpdate:value":o[2]||(o[2]=l=>c.date_end=l),type:"date","value-format":"YYYY-MM-DD",onChange:o[3]||(o[3]=l=>L("date_end"))},null,8,["value"]),p.date_end?(i(),_("span",Pe,s(p.date_end[0]),1)):w("",!0)]),e("div",ze,[Ae,f(m,{value:c.semester_id,"onUpdate:value":o[4]||(o[4]=l=>c.semester_id=l),"show-search":"",options:N.value,"field-names":{value:"id",label:"name"},onChange:o[5]||(o[5]=l=>L("semester_id")),placeholder:"Semestrni tanlang"},null,8,["value","options"]),p.semester_id?(i(),_("span",Re,s(p.semester_id[0]),1)):w("",!0)]),e("div",Ve,[qe,f(m,{value:c.type_id,"onUpdate:value":o[6]||(o[6]=l=>c.type_id=l),"show-search":"",options:I.value,"field-names":{value:"id",label:"name"},onChange:o[7]||(o[7]=l=>L("type_id")),placeholder:"Xafta turini tanlang"},null,8,["value","options"]),p.type_id?(i(),_("span",Xe,s(p.type_id[0]),1)):w("",!0)]),e("div",Ge,[e("button",Ze,[xe,B(" "+s(d.$t("Close")),1)]),e("button",{type:"button",class:"btns c-clear me-1",onClick:n},[He,B(" "+s(d.$t("Clear")),1)]),f(t,{loading:M.value},null,8,["loading"])])],32)])])])])}}}),Ke={pagetitle:"'Xaftaliklar'",class:"week-page"},Qe={class:"card panel-header-bg"},et={class:"card-body"},tt={class:"panel-header"},st={class:"card-title"},at={class:"panel-toggles"},ot=e("i",{class:"mdi mdi-arrow-left font-size-14 align-middle me-1 me-1"},null,-1),nt={class:"collapse__block"},lt={class:"my-2 col-md-5 form--item"},rt={for:"yu"},dt={class:"card"},it={class:"card-body"},ct={key:1,class:"table-responsive"},ut={class:"content-table"},_t={class:"table-row d-grid w-100"},mt=e("th",null,"\u2116",-1),pt={key:0},ht={key:1},ft={key:0},yt={key:1},vt={class:"gridjs-td"},bt={class:"list-inline mb-0"},gt={class:"list-inline-item"},kt={class:"edit__project"},wt=["onClick"],$t=e("i",{class:"mdi mdi-pencil font-size-18 text-primary"},null,-1),Ct=[$t],Mt={class:"form-check form-switch my-auto"},St=["checked","disabled","onChange"],Yt={key:2},It={class:"text-center"},Lt={class:"text-center mb-0"},Bt={key:0,class:"element-count mb-2"},Dt={key:0},Vt=G({__name:"week",async setup(v){var u,m;let r,y;const{t:I}=Z(),N=ue();_e();const b=k(!1),g=x(),$=(m=(u=N.params)==null?void 0:u.id)!=null?m:null,M=k(null),c=k(null),p=k([]);k({});const C=F({edu_plan_id:$,semester_id:null,search:null,page:1,per_page:$e.pagePer}),n=F({current_page:1,data:[],links:[]});H(async()=>{var l;let t=await Q($);p.value=(l=t==null?void 0:t.result)==null?void 0:l.data.map(h=>({id:h.id,name:h.semester+"-"+I("semester")+" / "+h.course+"-"+I("course_number")}))}),[r,y]=me(()=>S()),await r,y(),q(()=>C.semester_id,async(t,l)=>{await S()}),q(()=>n.current_page,async t=>{Number(t)&&(C.page=Number(t),await S(t))});async function j(){await S()}async function S(t){delete C.page;let l=F({...C,page:t||1});b.value=!0;try{const h=await Ce(l);Object.assign(n,h.result)}catch(h){console.log(h)}finally{b.value=!1}}function L(t){M.value=t,c.value=$,K.getOrCreateInstance("#weekFormModal").show()}function d(){M.value=null}async function o(t,l){b.value=!0;try{await Ye(t),g.success(`[${l}] - ${I("Status_changed_successfully")}`)}catch(h){g.error(h.message)}finally{b.value=!1}}return(t,l)=>{var O,T;const h=Y("router-link"),ee=Y("a-select"),te=Y("a-space"),se=Y("b-card"),ae=Y("b-collapse"),oe=we,ne=ke,le=Je;return pe("b-toggle"),i(),_("div",Ke,[e("div",Qe,[e("div",et,[e("div",tt,[e("h5",st,[f(h,{to:"/curriculum/curriculum"},{default:D(()=>[B(s(t.$t("Curriculum"))+" / ",1)]),_:1}),B(s((T=(O=n.data[0])==null?void 0:O.edu_plan)==null?void 0:T.name),1)]),e("div",at,[w("",!0),f(h,{class:"btns black-c py-1.5 px-4",to:"/curriculum/curriculum"},{default:D(()=>[ot,B(s(t.$t("Back")),1)]),_:1})])])])]),e("div",nt,[f(ae,{visible:"",id:"collapse-3"},{default:D(()=>[f(se,null,{default:D(()=>[e("form",{onSubmit:J(j,["prevent"]),class:"row"},[e("div",lt,[f(te,null,{default:D(()=>[f(ee,{value:C.semester_id,"onUpdate:value":l[0]||(l[0]=a=>C.semester_id=a),options:p.value,"allow-clear":"","field-names":{value:"id",label:"name"}},null,8,["value","options"])]),_:1}),e("label",rt,s(t.$t("Choose_Semester_And_Course")),1)])],32)]),_:1})]),_:1})]),e("div",dt,[e("div",it,[b.value?(i(),X(oe,{key:0})):w("",!0),n.data.length?(i(),_("div",ct,[e("table",ut,[e("thead",null,[e("tr",_t,[mt,e("th",null,s(t.$t("Week")),1),e("th",null,s(t.$t("by_Level")),1),e("th",null,s(t.$t("Semester_Name")),1),e("th",null,s(t.$t("Week_type")),1),e("th",null,s(t.$t("action")),1),e("th",null,s(t.$t("Active")),1)])]),e("tbody",null,[(i(!0),_(he,null,fe(n.data,(a,U)=>{var W,P,z,A,R,V;return i(),_("tr",{key:U,class:ye(["table-row d-grid w-100",(W=a==null?void 0:a.type)==null?void 0:W.code])},[e("td",null,s(U+1+(n==null?void 0:n.per_page)*((n==null?void 0:n.current_page)-1))+" "+s(),1),e("td",null,s(a==null?void 0:a.date),1),e("td",null,[(P=a==null?void 0:a.semester)!=null&&P.course?(i(),_("span",pt,s((z=a==null?void 0:a.semester)==null?void 0:z.course)+" -"+s(t.$t("course_number")),1)):(i(),_("span",ht,s(t.$t("not_set")),1))]),e("td",null,[(A=a==null?void 0:a.semester)!=null&&A.semester?(i(),_("span",ft,s((R=a==null?void 0:a.semester)==null?void 0:R.semester)+" -"+s(t.$t("semester_number")),1)):(i(),_("span",yt,s(t.$t("not_set")),1))]),e("td",null,s((V=a==null?void 0:a.type)==null?void 0:V.name),1),e("td",vt,[e("ul",bt,[e("li",gt,[e("div",kt,[e("a",{type:"text",onClick:re=>L(a.id)},Ct,8,wt)])])])]),e("td",null,[e("div",Mt,[e("input",{class:"form-check-input",type:"checkbox",id:"flexSwitchCheckChecked",checked:a.status,disabled:b.value,onChange:re=>o(a.id,a.type.name)},null,40,St)])])],2)}),128))])]),n.last_page>1?(i(),X(ne,ve({key:0,class:"mt-2"},{...n},{"current-page":n.current_page,"onUpdate:currentPage":l[1]||(l[1]=a=>n.current_page=a)}),null,16,["current-page"])):w("",!0)])):(i(),_("div",Yt,[e("h5",It,s(t.$t("No_data")),1),e("p",Lt,s(t.$t("No_information_found")),1)]))])]),f(le,{"week-id":M.value,"curriculum-id":be($),"onUpdate:list":S,onClose:d},null,8,["week-id","curriculum-id"]),n.data.length?(i(),_("span",Bt,[n.last_page>1?(i(),_("span",Dt,s(n.current_page)+"-"+s(n.data.length+n.per_page*(n.current_page-1))+" / ",1)):w("",!0),B(" "+s(t.$t("Total_Point"))+": "+s(n.total),1)])):w("",!0)])}}});export{Vt as default};
