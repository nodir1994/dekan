import{_ as H}from"./Pagination.f4a9fc5d.js";import{d as Z,h as J,c as S,B as $,a as K,bO as Q,Z as T,bq as W,y as X,w as y,i as m,b6 as D,o as r,e as h,f as e,t as l,j as d,k as i,z as b,bs as F,v as aa,bH as E,F as ea,r as sa,g as w,s as ta,aR as oa,l as j}from"./index.3390162f.js";import{a as la,e as da,b as na}from"./index.30e99442.js";import{e as ia,b as ca}from"./id.5a6e5f30.js";import{c as ua,s as ra}from"./gpa.cf8a35d6.js";import{h as _a}from"./helper.569bc08f.js";import"./_plugin-vue_export-helper.cdc0426e.js";import"./sweetalert2.all.fdef424e.js";import"./moment.2cad4b18.js";const pa={pagetitle:"'GPA hisoblash'",class:"gpaEddPage"},ma={class:"card panel-header-bg"},ha={class:"card-body"},fa={class:"panel-header"},va={class:"card-title"},ya={class:"filterBlock"},ba=e("i",{class:"mdi mdi-arrow-left font-size-14 align-middle me-1 me-1"},null,-1),ga={class:"btns c-filter py-1.5 px-4"},wa=e("i",{class:"mdi mdi-filter font-size-14 align-middle me-1"},null,-1),ka={class:"collapse__block"},Oa={class:"my-2 col-xl-10 form--item"},Pa={for:"yu"},$a={class:"my-2 col-xl-2"},Fa={class:"btn-search search-color"},Ga=e("i",{class:"mdi mdi-magnify font-size-14 align-middle me-1"},null,-1),Ca={class:"row"},Ua={class:"col-xl-8"},Aa={class:"card"},Ba={class:"card-body"},La={key:0,class:"table-responsive"},Na={class:"content-table"},Sa={class:"table-row d-grid w-100"},Ta={class:"form-check"},Ea=e("th",null,"#",-1),ja={class:"form-check"},za=["value"],Ia=e("br",null,null,-1),Ya={key:1},Ma={class:"text-center"},Va={class:"text-center"},qa={key:0,class:"element-count mb-2"},Ra={class:"col-xl-4"},xa={class:"card"},Ha={class:"card-body"},Za={class:"d-flex justify-content-end"},Ja=["disabled"],Ka=e("i",{class:"mdi mdi-check font-size-14 align-middle me-1"},null,-1),de=Z({__name:"gpa-add",async setup(Qa){let G,C;const k=J(),z=S(()=>{var s,o;return(o=(s=k==null?void 0:k.user)==null?void 0:s.faculty)==null?void 0:o.name}),g=$([]),{t:_}=K(),U=Q(),A=$(!1),B=S({get(){var s,o;return((s=a==null?void 0:a.students)==null?void 0:s.length)===((o=g==null?void 0:g.value)==null?void 0:o.length)},set(s){s?a.students=g.value:a.students=[]}}),a=T({search:"",edu_plan_id:null,edu_type_id:null,academic_group_id:null,academic_year_id:null,edu_form_id:null,data:[],students:[],links:[],subjectData:[],current_page:1,per_page:_a.pagePer}),n=T({eduTypeOptions:null,eduFormOptions:null,eduPlanOptions:null,academicYearOptions:null,academicGroupOptions:null}),O=$(!0);[G,C]=W(()=>c()),await G,C(),X(async()=>{n.academicYearOptions=await la().then(s=>s.result.data),n.eduTypeOptions=await da().then(s=>s.result),n.eduFormOptions=await na().then(s=>s.result)}),y(()=>a.academic_year_id,async()=>{await c()}),y(()=>a.edu_type_id,async()=>{await c()}),y(()=>a.edu_form_id,async s=>{a.edu_plan_id=null,n.eduPlanOptions=null,s&&(n.eduPlanOptions=await ia(s).then(o=>o.result.data)),await c()}),y(()=>a.edu_plan_id,async s=>{var o;if(a.academic_group_id=null,n.academicGroupOptions=null,await c(),s){let u=await ca(s);n.academicGroupOptions=(o=u==null?void 0:u.result)==null?void 0:o.data.map(p=>({id:p.id,name:p.name}))}}),y(()=>a.academic_group_id,async()=>{await c()}),y(()=>a.current_page,async s=>{Number(s)&&await c(s)});async function I(){await c()}async function c(s){var u;let o={page:s||1,per_page:a.per_page};if((u=a==null?void 0:a.search)!=null&&u.length&&(o.search=a.search),a.edu_type_id&&(o.edu_type_id=a.edu_type_id),a.academic_year_id&&(o.academic_year_id=a.academic_year_id),a.edu_form_id&&(o.edu_form_id=a.edu_form_id),a.edu_plan_id&&(o.edu_plan_id=a.edu_plan_id),a.academic_group_id&&(o.academic_group_id=a.academic_group_id),O.value){O.value=!1;const p=await ua(o);Object.assign(a,p.result),console.log(p.result),g.value=a.data.map(P=>P.id),setTimeout(()=>{O.value=!0},100)}}async function Y(){try{let s={students:a.students};A.value=!0,await ra(s),U.success(_("Student_GPA_of_name_recalculated_successfully"))}catch(s){U.error(_("Request_failed1")+": "+s.message)}finally{location.reload(),A.value=!1}}return(s,o)=>{var N;const u=m("router-link"),p=m("a-input"),P=m("b-card"),M=m("b-collapse"),V=H,f=m("a-select"),L=m("a-space"),v=m("a-form-item"),q=D("b-toggle");return r(),h("div",pa,[e("div",ma,[e("div",ha,[e("div",fa,[e("h5",va,l(s.$t("Performance_Gpa_Add")),1),e("div",ya,[d(u,{to:"/performance/gpa",class:"btns black-c py-1.5 px-4 d-inline-block me-2"},{default:i(()=>[ba,b(l(s.$t("Prev")),1)]),_:1}),F((r(),h("button",ga,[wa,b(l(s.$t("Filter")),1)])),[[q,void 0,void 0,{"collapse-3":!0}]])])])])]),e("div",ka,[d(M,{visible:"",id:"collapse-3"},{default:i(()=>[d(P,null,{default:i(()=>[e("form",{onSubmit:aa(I,["prevent"]),class:"row"},[e("div",Oa,[d(p,{id:"yu",class:"form-control",value:a.search,"onUpdate:value":o[0]||(o[0]=t=>a.search=t)},null,8,["value"]),e("label",Pa,l(s.$t("choose__fish__student__passport__code")),1)]),e("div",$a,[e("button",Fa,[Ga,b(l(s.$t("Search")),1)])])],32)]),_:1})]),_:1})]),e("div",Ca,[e("div",Ua,[e("div",Aa,[e("div",Ba,[a.data.length?(r(),h("div",La,[e("table",Na,[e("thead",null,[e("tr",Sa,[e("th",null,[e("div",Ta,[F(e("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":o[1]||(o[1]=t=>B.value=t)},null,512),[[E,B.value]])])]),Ea,e("th",null,l(s.$t("Student")),1),e("th",null,l(s.$t("Group")),1),e("th",null,l(s.$t("Education_Type")),1),e("th",null,l(s.$t("Education_Form")),1),e("th",null,l(s.$t("by_Level")),1),e("th",null,l(s.$t("gpa")),1),e("th",null,l(s.$t("Contract_Indebtedness")),1)])]),e("tbody",null,[(r(!0),h(ea,null,sa(a.data,(t,R)=>(r(),h("tr",{class:"table-row d-grid w-100",key:t.id},[e("td",null,[e("div",ja,[F(e("input",{type:"checkbox",class:"form-check-input","onUpdate:modelValue":o[2]||(o[2]=x=>a.students=x),value:t==null?void 0:t.id},null,8,za),[[E,a.students]])])]),e("td",null,l((a.current_page-1)*a.per_page+R+1),1),e("td",null,[b(l(t==null?void 0:t.fullname)+" ",1),Ia,b(" "+l(t==null?void 0:t.id),1)]),e("td",null,l(t==null?void 0:t.academic_group),1),e("td",null,l(t==null?void 0:t.edu_type),1),e("td",null,l(t==null?void 0:t.edu_form),1),e("td",null,l(t==null?void 0:t.course)+" - "+l(w(_)("course_number")),1),e("td",null,l(t==null?void 0:t.gpa),1),e("td",null,l(t==null?void 0:t.debt),1)]))),128))])]),a.last_page>1?(r(),ta(V,oa({key:0,class:"mt-2"},{...a},{"current-page":a.current_page,"onUpdate:currentPage":o[3]||(o[3]=t=>a.current_page=t)}),null,16,["current-page"])):j("",!0)])):(r(),h("div",Ya,[e("h5",Ma,l(s.$t("No_data")),1),e("p",Va,l(s.$t("No_information_found")),1)]))])]),a.data.length?(r(),h("span",qa,l(a.current_page)+"-"+l((a==null?void 0:a.data.length)+a.per_page*(a.current_page-1))+"/ "+l(s.$t("Total_Point"))+": "+l(a.total),1)):j("",!0)]),e("div",Ra,[e("div",xa,[e("div",Ha,[d(v,{class:"mb-3",name:"nameFaculty"},{default:i(()=>[d(L,null,{default:i(()=>[d(f,{class:"form--item",value:z.value,disabled:""},null,8,["value"])]),_:1})]),_:1}),d(v,{class:"mb-3",name:"nameFaculty"},{default:i(()=>[d(L,null,{default:i(()=>[d(f,{"allow-clear":"",value:a.academic_year_id,"onUpdate:value":o[4]||(o[4]=t=>a.academic_year_id=t),"field-names":{value:"id",label:"name"},options:n.academicYearOptions,placeholder:w(_)("Choose_Education_Year")},null,8,["value","options","placeholder"])]),_:1})]),_:1}),d(v,{class:"mb-3",name:"nameFaculty"},{default:i(()=>[d(f,{"allow-clear":"",value:a.edu_type_id,"onUpdate:value":o[5]||(o[5]=t=>a.edu_type_id=t),"field-names":{value:"id",label:"name"},options:n.eduTypeOptions,placeholder:w(_)("Choose_Education_Type")},null,8,["value","options","placeholder"])]),_:1}),d(v,{class:"mb-3",name:"nameFaculty"},{default:i(()=>[d(f,{"allow-clear":"",value:a.edu_form_id,"onUpdate:value":o[6]||(o[6]=t=>a.edu_form_id=t),"field-names":{value:"id",label:"name"},options:n.eduFormOptions,placeholder:w(_)("Choose_Education_Form")},null,8,["value","options","placeholder"])]),_:1}),d(v,{class:"mb-3",name:"nameFaculty"},{default:i(()=>[d(f,{"allow-clear":"",value:a.edu_plan_id,"onUpdate:value":o[7]||(o[7]=t=>a.edu_plan_id=t),"field-names":{value:"id",label:"name"},disabled:!a.edu_form_id,options:n.eduPlanOptions,placeholder:s.$t("Please_select_curriculum")},null,8,["value","disabled","options","placeholder"])]),_:1}),d(v,{class:"mb-3",name:"nameFaculty"},{default:i(()=>[d(f,{"allow-clear":"",value:a.academic_group_id,"onUpdate:value":o[8]||(o[8]=t=>a.academic_group_id=t),disabled:!a.edu_plan_id,"field-names":{value:"id",label:"name"},options:n.academicGroupOptions,placeholder:w(_)("Choose_Group")},null,8,["value","disabled","options","placeholder"])]),_:1}),e("div",Za,[e("button",{class:"btns c-save",disabled:!((N=a==null?void 0:a.students)!=null&&N.length),type:"button",onClick:Y},[Ka,b(l(s.$t("calculate_GPA")),1)],8,Ja)])])])])])])}}});export{de as default};
