import{_ as Q}from"./Pagination.f4a9fc5d.js";import{_ as W}from"./LoadingOverlay.vue_vue_type_script_setup_true_lang.89ce9ad6.js";/* empty css                                                       */import{bR as X,d as ee,Z as w,bO as te,B,a as ae,bq as V,c as se,y as oe,w as O,i as N,b6 as le,o as c,e as v,f as t,t as l,bs as $,z as C,j as p,k as x,v as ne,g as u,s as j,l as F,bH as z,F as ie,r as re,aR as de}from"./index.3390162f.js";import{k as ce}from"./index.30e99442.js";import{i as ue,b as _e,s as pe}from"./id.5a6e5f30.js";import{S as me}from"./sweetalert2.all.fdef424e.js";import{h as y}from"./helper.569bc08f.js";import"./_plugin-vue_export-helper.cdc0426e.js";import"./vue.runtime.esm-bundler.84001772.js";import"./moment.2cad4b18.js";const T=X();async function fe(_){try{const{data:r}=await T({url:"api/students/return-study",method:"GET",params:_});return r}catch(r){throw r}}async function he(_){try{const{data:r}=await T({url:"api/student-actions/student-status",method:"PUT",data:_});return r}catch(r){throw r}}async function ve(){try{const{data:_}=await T({url:"api/references/student-statuses",method:"GET"});return _}catch(_){throw _}}const ye={pagetitle:"'Akademik tatil'",class:"transfer-return-page"},ge={class:"card panel-header-bg"},be={class:"card-body"},we={class:"panel-header"},Oe={class:"card-title"},ke={class:"filterBlock"},Be={class:"btns c-filter py-1.5 px-4"},Ne=t("i",{class:"mdi mdi-filter font-size-14 align-middle me-1"},null,-1),Ce={class:"collapse__block"},Pe={class:"col-xl-3 form--item"},Se={class:"my-2",name:"nameFaculty"},$e={class:"col-xl-3 form--item"},xe={class:"my-2",name:"nameFaculty"},Fe={class:"col-xl-3 form--item"},Te={class:"my-2",name:"nameFaculty"},Ue={class:"col-xl-3 form--item"},Ge={class:"my-2",name:"nameFaculty"},Ae={class:"row"},Ye={class:"col-xl-8"},Le={class:"card"},Ee={class:"card-body"},Ie={key:1,class:"table-responsive"},Re={class:"content-table"},Ve={class:"table-row d-grid w-100"},je=t("th",null,"#",-1),ze={class:"form-check"},Me=["value"],De=t("br",null,null,-1),qe={key:2},He={class:"text-center"},Ze={class:"text-center"},Je={key:0,class:"element-count mb-2"},Ke={class:"col-xl-4"},Qe={class:"card"},We={class:"card-body"},Xe={class:"mb-3",name:"nameFaculty"},et={for:"division-name-select",class:"form-label"},tt={class:"d-flex justify-content-end"},at=["disabled"],st=t("i",{class:"mdi mdi-check font-size-14 align-middle me-1"},null,-1),ft=ee({__name:"transfer-return",async setup(_){let r,k;w({});const U=te(),g=B(!1),{t:d}=ae(),G=B(null),e=w({search:"",edu_plan_id:null,academic_year_id:null,semester_id:null,academic_group_id:null,reference_id:G,current_page:1,data:[],links:[],page:1,per_page:y.pagePer,students:[]}),i=w({eduPlanOptions:null,academicYearsOptions:null,semesterOptions:null,academicGroupOptions:null,orderOptions:null});i.orderOptions=([r,k]=V(()=>ve().then(a=>a==null?void 0:a.result)),r=await r,k(),r),G.value=i.orderOptions.find(a=>a.code==11).id;const b=B([]),P=B(!0),A=se({get(){var a,s;return((a=e==null?void 0:e.students)==null?void 0:a.length)===((s=b==null?void 0:b.value)==null?void 0:s.length)},set(a){a?e.students=b.value:e.students=[]}});[r,k]=V(()=>m()),await r,k(),oe(async()=>{var s;let a=await ce();i.eduPlanOptions=(s=a==null?void 0:a.result)==null?void 0:s.data}),O(()=>e.edu_plan_id,async()=>{var a,s;if(e.academic_year_id=null,e.semester_id=null,e.academic_group_id=null,i.academicYearsOptions=null,i.academicGroupOptions=null,i.semesterOptions=null,await m(),e.edu_plan_id){let n=await ue();i.academicYearsOptions=(a=n==null?void 0:n.result)==null?void 0:a.data.map(h=>({id:h.id,name:h.name}));let f=await _e(e.edu_plan_id);i.academicGroupOptions=(s=f==null?void 0:f.result)==null?void 0:s.data.map(h=>({id:h.id,name:h.name}))}}),O(()=>e.academic_year_id,async()=>{var a;if(e.semester_id=null,i.semesterOptions=null,await m(),e.edu_plan_id&&e.academic_year_id){let s=await pe(e);i.semesterOptions=(a=s==null?void 0:s.result)==null?void 0:a.data.map(n=>({id:n.id,name:n.course+"-"+d("Course")+" "+n.semester+"-"+d("semester")}))}}),O(()=>e.semester_id,async()=>{await m()}),O(()=>e.academic_group_id,async()=>{await m()}),O(()=>e.current_page,async a=>{Number(a)&&(e.page=Number(a),await m(a))});async function M(){await m()}async function D(){try{g.value=!0,me.fire({title:d("Delete_message.Are_you_sure"),text:d("Delete_message.Action_irreversible"),showCancelButton:!0,confirmButtonColor:"#34c38f",cancelButtonColor:"#f46a6a",cancelButtonText:d("No_Cancel"),confirmButtonText:d("transfer")}).then(async a=>{if(a.value){let s=w({students:e.students,student_status_id:e.reference_id});await he(s),U.success(d("Data_was_successfully_transferred")),location.reload()}})}catch(a){U.error(d("Failed")+": "+a.message)}finally{g.value=!1}}async function m(a){let s=w({page:a||1,per_page:e.per_page});e.edu_plan_id&&(s.edu_plan_id=e.edu_plan_id),e.academic_year_id&&(s.academic_year_id=e.academic_year_id),e.semester_id&&(s.semester_id=e.semester_id),e.academic_group_id&&(s.academic_group_id=e.academic_group_id),g.value=!0;try{if(P.value){P.value=!1;const n=await fe(s);Object.assign(e,n.result),b.value=e.data.map(f=>f.id),setTimeout(()=>{P.value=!0},100)}}catch(n){console.log(n)}finally{g.value=!1}}return(a,s)=>{const n=N("a-select"),f=N("b-card"),h=N("b-collapse"),q=W,H=Q,Z=N("a-form"),J=le("b-toggle");return c(),v("div",ye,[t("div",ge,[t("div",be,[t("div",we,[t("h5",Oe,l(a.$t("Transfer_Return")),1),t("div",ke,[$((c(),v("button",Be,[Ne,C(l(a.$t("Filter")),1)])),[[J,void 0,void 0,{"collapse-3":!0}]])])])])]),t("div",Ce,[p(h,{visible:"",id:"collapse-3"},{default:x(()=>[p(f,null,{default:x(()=>[t("form",{class:"row",onSubmit:ne(M,["prevent"])},[t("div",Pe,[t("div",Se,[p(n,{"filter-option":u(y).filterOptionByName,"show-search":"","allow-clear":"",value:e.edu_plan_id,"onUpdate:value":s[0]||(s[0]=o=>e.edu_plan_id=o),"field-names":{value:"id",label:"name"},options:i.eduPlanOptions,placeholder:a.$t("Please_select_curriculum")},null,8,["filter-option","value","options","placeholder"])])]),t("div",$e,[t("div",xe,[p(n,{"filter-option":u(y).filterOptionByName,"show-search":"","allow-clear":"",value:e.academic_year_id,"onUpdate:value":s[1]||(s[1]=o=>e.academic_year_id=o),disabled:!e.edu_plan_id,"field-names":{value:"id",label:"name"},options:i.academicYearsOptions,placeholder:u(d)("Choose_Education_Year")},null,8,["filter-option","value","disabled","options","placeholder"])])]),t("div",Fe,[t("div",Te,[p(n,{"filter-option":u(y).filterOptionByName,"show-search":"","allow-clear":"",disabled:!e.academic_year_id,value:e.semester_id,"onUpdate:value":s[2]||(s[2]=o=>e.semester_id=o),"field-names":{value:"id",label:"name"},options:i.semesterOptions,placeholder:u(d)("Choose_Semester")},null,8,["filter-option","disabled","value","options","placeholder"])])]),t("div",Ue,[t("div",Ge,[p(n,{"filter-option":u(y).filterOptionByName,"show-search":"","allow-clear":"",disabled:!e.edu_plan_id,value:e.academic_group_id,"onUpdate:value":s[3]||(s[3]=o=>e.academic_group_id=o),"field-names":{value:"id",label:"name"},options:i.academicGroupOptions,placeholder:u(d)("Choose_Group")},null,8,["filter-option","disabled","value","options","placeholder"])])])],32)]),_:1})]),_:1})]),t("div",Ae,[t("div",Ye,[t("div",Le,[t("div",Ee,[g.value?(c(),j(q,{key:0})):F("",!0),e.data.length?(c(),v("div",Ie,[t("table",Re,[t("thead",null,[t("tr",Ve,[je,t("th",null,[$(t("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":s[4]||(s[4]=o=>A.value=o)},null,512),[[z,A.value]])]),t("th",null,l(a.$t("Student")),1),t("th",null,l(a.$t("by_Specialty")),1),t("th",null,l(a.$t("Education_Year_Name")),1),t("th",null,l(a.$t("Payment_Form")),1)])]),t("tbody",null,[(c(!0),v(ie,null,re(e.data,(o,S)=>{var Y,L,E,I,R;return c(),v("tr",{class:"table-row w-100 d-grid",key:o.id},[t("td",null,l((e.current_page-1)*e.per_page+S+1),1),t("td",null,[t("div",ze,[$(t("input",{type:"checkbox",class:"form-check-input","onUpdate:modelValue":s[5]||(s[5]=K=>e.students=K),value:o.id},null,8,Me),[[z,e.students]])])]),t("td",null,l(o.name)+" "+l(o.surname),1),t("td",null,l((Y=o==null?void 0:o.specialty)==null?void 0:Y.id)+" / "+l((L=o==null?void 0:o.specialty)==null?void 0:L.name),1),t("td",null,[t("div",null,[C(l((E=o==null?void 0:o.semester)==null?void 0:E.course)+" - kurs ",1),De,C(" "+l((I=o==null?void 0:o.semester)==null?void 0:I.semester)+" - semestr ",1)])]),t("td",null,l((R=o==null?void 0:o.payment_type)==null?void 0:R.name),1)])}),128))])]),e.last_page>1?(c(),j(H,de({key:0,class:"mt-2"},{...e},{"current-page":e.current_page,"onUpdate:currentPage":s[6]||(s[6]=o=>e.current_page=o)}),null,16,["current-page"])):F("",!0)])):(c(),v("div",qe,[t("h5",He,l(a.$t("No_data")),1),t("p",Ze,l(a.$t("No_information_found")),1)]))])]),e.data.length?(c(),v("span",Je,l(e.current_page)+"-"+l((e==null?void 0:e.data.length)+e.per_page*(e.current_page-1))+"/ "+l(a.$t("Total_Point"))+": "+l(e.total),1)):F("",!0)]),t("div",Ke,[t("div",Qe,[t("div",We,[p(Z,null,{default:x(()=>{var o;return[t("div",Xe,[t("label",et,l(a.$t("Transfer_Status")),1),p(n,{"filter-option":u(y).filterOptionByName,"show-search":"","allow-clear":"",value:e.reference_id,"onUpdate:value":s[7]||(s[7]=S=>e.reference_id=S),"field-names":{value:"id",label:"name"},options:i.orderOptions,placeholder:u(d)("select__status__student"),disabled:""},null,8,["filter-option","value","options","placeholder"])]),t("div",tt,[t("button",{onClick:D,disabled:!((o=e==null?void 0:e.students)!=null&&o.length)||!e.reference_id,class:"btns c-save",type:"button"},[st,C("Ok ")],8,at)])]}),_:1})])])])])])}}});export{ft as default};
