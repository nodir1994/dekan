import{P as R}from"./PaginationForStatistical.bc37bc8c.js";import{j as V,s as I,X as z,l as G,Y as M}from"./index.30e99442.js";import{bR as X,d as Y,h as Z,c as H,B as f,a as J,Z as $,y as K,w as j,bq as Q,i as k,b6 as W,o as d,e as _,f as e,t as l,bs as x,z as h,j as u,k as p,s as q,l as B,F as ee,r as te,aR as se,q as ae}from"./index.3390162f.js";import{_ as le}from"./LoadingOverlay.vue_vue_type_script_setup_true_lang.89ce9ad6.js";/* empty css                                                       */import{_ as ne}from"./NoData.ac42776e.js";import{h as A}from"./helper.569bc08f.js";import"./_plugin-vue_export-helper.cdc0426e.js";import"./vue.runtime.esm-bundler.84001772.js";/* empty css                                                               */import"./sweetalert2.all.fdef424e.js";import"./moment.2cad4b18.js";const oe=X();async function ie(C){try{const{data:m}=await oe({url:"/api/statistic/resources",params:C});return m}catch(m){throw m}}const ue={pagetitle:"'Malaka oshirish'",class:"transferPage"},re={class:"card panel-header-bg"},de={class:"card-body"},ce={class:"panel-header"},_e={class:"card-title"},pe={class:"filterBlock"},me={class:"btns c-filter py-1.5 px-4"},ge=e("i",{class:"mdi mdi-filter me-2"},null,-1),ve={class:"collapse__block"},be={class:"row"},fe={class:"my-2 col-md-4 form--item"},he={for:"yu"},ye={class:"my-2 col-md-4 form--item"},Le={for:"yu"},we={class:"my-2 col-md-4 form--item"},$e={for:"yu"},je={class:"my-2 col-md-4 form--item"},ke={for:"yu"},Ne={class:"my-2 col-md-4 form--item"},Pe={for:"yu"},Se={class:"my-2 col-md-2 form--item"},Be={for:"yu"},Ce={class:"my-2 col-md-2 form--item"},Te={for:"yu"},Ue={class:"card"},Ee={class:"card-body"},qe={key:1,class:"table-responsive"},Ae={class:"content-table"},Fe={class:"table-row-all-students"},De=e("th",null,"#",-1),Oe=e("br",null,null,-1),Re=e("br",null,null,-1),Ve={key:0},Ie={key:1},ze={class:"text-center"},Ge={key:2,class:"table-responsive"},Me={key:0},at=Y({__name:"index",async setup(C){let m,T;const N=Z(),U=H(()=>{var t,a;return(a=(t=N==null?void 0:N.user)==null?void 0:t.faculty)==null?void 0:a.name}),y=f(!1),{t:L}=J(),P=f(),s=$({edu_plan_id:null,semester_id:null,subject_id:null,lesson_activity_id:null,language_id:null,grouping_type:"subject",page:1,per_page:A.pagePer}),n=$({pagination:{current_page:1,per_page:s.per_page,loading:!1},result:[]}),c=$({optionaEduPlanByList:null,optionSemesterList:null,optionSubjectList:null,optionAcademicTrainingList:null,optionEduLangList:null}),b=f({sequenceNumber:null,theNumber:null,sorting:null}),F=f([{id:"subject",name:L("student_Sciences")},{id:"edu_plan",name:L("Curriculum")}]),S=f(!1);K(async()=>{c.optionaEduPlanByList=await V().then(t=>t.result.data),c.optionEduLangList=await I().then(t=>t.result),c.optionAcademicTrainingList=await z().then(t=>t.result)}),j(()=>[s.edu_plan_id,s.semester_id,s.subject_id,s.lesson_activity_id,s.language_id,s.grouping_type],async t=>{await w()}),j(()=>s.edu_plan_id,async t=>{if(s.semester_id=null,P.value=null,Number(t)){let a=await G(s.edu_plan_id).then(o=>o.result.data);P.value=a.map(o=>({id:o.id,name:o.semester+"-"+L("semester")}))}}),j(()=>n.pagination.current_page,async t=>{Number(t)&&await w(t)}),j(()=>s.semester_id,async t=>{s.subject_id=null,c.optionSubjectList=null,t&&(c.optionSubjectList=await M(s).then(a=>{var o;return(o=a.result)==null?void 0:o.map(r=>{var g,v;return{id:(g=r==null?void 0:r.subject)==null?void 0:g.id,name:(v=r==null?void 0:r.subject)==null?void 0:v.name}})}))}),[m,T]=Q(()=>w()),await m,T();async function w(t){delete s.page;let a=$({...s,page:t||1});try{if(y.value=!0,S){S.value=!1;const v=await ie(a);Object.assign(n,v),setTimeout(()=>{S.value=!0},A.loaderRefresh)}let o=`${n.pagination.per_page*(n.pagination.current_page-1)+1}- ${n.result.length+n.pagination.per_page*(n.pagination.current_page-1)}`,r=`${L("Total_Point")} : ${n.pagination.total}`,g=n.pagination.per_page*(n.pagination.current_page-1);b.value.sequenceNumber=o,b.value.theNumber=r,b.value.sorting=g}catch(o){console.log(o)}finally{y.value=!1}}return(t,a)=>{const o=k("a-select"),r=k("a-space"),g=k("b-card"),v=k("b-collapse"),D=R,O=W("b-toggle");return d(),_("div",ue,[e("div",re,[e("div",de,[e("div",ce,[e("h5",_e,l(t.$t("Resource_statistics")),1),e("div",pe,[x((d(),_("button",me,[ge,h(l(t.$t("Filtr")),1)])),[[O,void 0,void 0,{"collapse-3":!0}]])])])])]),e("div",ve,[u(v,{visible:"",id:"collapse-3"},{default:p(()=>[u(g,null,{default:p(()=>[e("div",be,[e("div",fe,[u(r,null,{default:p(()=>[u(o,{class:"form--item",value:U.value,disabled:""},null,8,["value"])]),_:1}),e("label",he,l(t.$t("Faculty")),1)]),e("div",ye,[u(r,null,{default:p(()=>[u(o,{value:s.edu_plan_id,"onUpdate:value":a[0]||(a[0]=i=>s.edu_plan_id=i),options:c.optionaEduPlanByList,"field-names":{value:"id",label:"name"},"allow-clear":"",class:"form--item"},null,8,["value","options"])]),_:1}),e("label",Le,l(t.$t("study_plan")),1)]),e("div",we,[u(r,null,{default:p(()=>[u(o,{value:s.semester_id,"onUpdate:value":a[1]||(a[1]=i=>s.semester_id=i),options:P.value,"field-names":{value:"id",label:"name"},disabled:!s.edu_plan_id,"allow-clear":"",class:"form--item"},null,8,["value","options","disabled"])]),_:1}),e("label",$e,l(t.$t("semester")),1)]),e("div",je,[u(r,null,{default:p(()=>[u(o,{value:s.subject_id,"onUpdate:value":a[2]||(a[2]=i=>s.subject_id=i),options:c.optionSubjectList,disabled:!s.semester_id,"field-names":{value:"id",label:"name"},"allow-clear":"",class:"form--item"},null,8,["value","options","disabled"])]),_:1}),e("label",ke,l(t.$t("student_Sciences")),1)]),e("div",Ne,[u(r,null,{default:p(()=>[u(o,{value:s.lesson_activity_id,"onUpdate:value":a[3]||(a[3]=i=>s.lesson_activity_id=i),options:c.optionAcademicTrainingList,"field-names":{value:"id",label:"name"},"allow-clear":"",class:"form--item"},null,8,["value","options"])]),_:1}),e("label",Pe,l(t.$t("student_Training")),1)]),e("div",Se,[u(r,null,{default:p(()=>[u(o,{value:s.language_id,"onUpdate:value":a[4]||(a[4]=i=>s.language_id=i),options:c.optionEduLangList,"field-names":{value:"id",label:"name"},"allow-clear":"",class:"form--item"},null,8,["value","options"])]),_:1}),e("label",Be,l(t.$t("Language")),1)]),e("div",Ce,[u(r,null,{default:p(()=>[u(o,{value:s.grouping_type,"onUpdate:value":a[5]||(a[5]=i=>s.grouping_type=i),options:F.value,"field-names":{value:"id",label:"name"},"allow-clear":"",class:"form--item"},null,8,["value","options"])]),_:1}),e("label",Te,l(t.$t("Grouping")),1)])])]),_:1})]),_:1})]),e("div",Ue,[e("div",Ee,[y.value?(d(),q(le,{key:0})):B("",!0),n.result.length?(d(),_("div",qe,[e("table",Ae,[e("thead",null,[e("tr",Fe,[De,e("th",null,l(t.$t("study_plan")),1),e("th",null,l(t.$t("student_Sciences")),1),e("th",null,l(t.$t("semester")),1),e("th",null,l(t.$t("Numbe_resources")),1)])]),e("tbody",null,[(d(!0),_(ee,null,te(n.result,(i,E)=>(d(),_("tr",{class:"table-row-all-students",key:E},[e("td",null,l(n.pagination.per_page*(n.pagination.current_page-1)+E+1),1),e("td",null,[h(l(i.edu_plan)+" ",1),Oe,h(" "+l(U.value),1)]),e("td",null,[h(l(i.subject)+" ",1),Re]),i.semester?(d(),_("td",Ve,l(i.semester)+"-"+l(t.$t("semester")),1)):(d(),_("td",Ie)),e("td",ze,l(i.count),1)]))),128))])]),n.pagination.last_page>1?(d(),q(D,se({key:0,class:"mt-2"},{...n.pagination},{"current-page":n.pagination.current_page,"onUpdate:currentPage":a[6]||(a[6]=i=>n.pagination.current_page=i),loading:y.value,onOnPageChange:w}),null,16,["current-page","loading"])):B("",!0)])):(d(),_("div",Ge,[u(ne)]))])]),e("span",{class:ae(["element-count mb-2",n.pagination.total?"":"d-none"])},[n.pagination.last_page?(d(),_("span",Me,l(b.value.sequenceNumber)+" / ",1)):B("",!0),h(l(b.value.theNumber),1)],2)])}}});export{at as default};
