import{bR as V,d as j,h as E,c as I,a as M,B as $,Z as b,y as z,bq as Z,w as U,i as y,b6 as K,o as p,e as f,f as e,t as o,z as d,bs as W,j as i,k as _,v as H,s as x,l as P,g as J,F as Q,r as X,aR as Y,q as ee}from"./index.3390162f.js";import{Z as te,R as ae,K as oe,v as le}from"./index.30e99442.js";import{_ as se}from"./LoadingOverlay.vue_vue_type_script_setup_true_lang.89ce9ad6.js";/* empty css                                                       */import{_ as ne}from"./NoData.ac42776e.js";import{P as ie}from"./PaginationForStatistical.bc37bc8c.js";import{h as re}from"./helper.569bc08f.js";import"./vue.runtime.esm-bundler.84001772.js";/* empty css                                                               */import"./_plugin-vue_export-helper.cdc0426e.js";import"./sweetalert2.all.fdef424e.js";import"./moment.2cad4b18.js";const q=V();async function ue(w){try{const{data:u}=await q({url:"/api/report/active-students",params:w});return u}catch(u){throw u}}async function de(w){try{const{data:u}=await q({url:"/api/report/student-export",params:w,responseType:"blob"});return u}catch(u){throw u}}const ce={pagetitle:"`Talaba faolligi`",class:"reportByStudentPage"},pe={class:"card panel-header-bg"},_e={class:"card-body"},me={class:"panel-header"},fe={class:"card-title"},ge={class:"panel-toggles"},ve=e("i",{class:"mdi mdi-download me-2"},null,-1),he={class:"filterBlock"},be={class:"btns c-filter py-1.5 px-4"},ye=e("i",{class:"mdi mdi-filter me-2"},null,-1),we={class:"collapse__block"},$e={class:"my-2 col-xl-4 form--item"},Le={for:"yu"},ke={class:"my-2 col-xl-4 form--item"},Ce={for:"yu"},Ne={class:"my-2 col-xl-4 form--item"},Se={for:"yu"},Pe={class:"my-2 col-xl-2 form--item"},Fe={for:"yu"},Be={class:"my-2 col-xl-2 form--item"},Te={for:"yu"},Ue={class:"my-2 col-xl-6 form--item"},xe={for:"yu"},qe={class:"my-2 col-xl-2"},De={type:"submit",class:"btn-search search-color"},Ae=e("i",{class:"mdi mdi-magnify me-1"},null,-1),Oe={class:"row table-division"},Re={class:"col-md-12"},Ge={class:"card"},Ve={class:"card-body"},je={key:1,class:"table-responsive"},Ee={class:"content-table"},Ie={class:"table-row d-grid w-100"},Me=e("th",null,[e("b",null,"#")],-1),ze=e("br",null,null,-1),Ze=e("br",null,null,-1),Ke=e("br",null,null,-1),We={key:2,class:"table-responsive"},He={key:0},rt=j({__name:"index",async setup(w){let u,F;const L=E(),D=I(()=>{var a,t;return(t=(a=L==null?void 0:L.user)==null?void 0:a.faculty)==null?void 0:t.name}),{t:k}=M(),g=$(!1),B=$(),C=$(!0),s=b({faculty_id:null,edu_type_id:null,edu_form_id:null,academic_group_id:null,course:null,text:null,per_page:re.pagePer,page:1}),n=b({pagination:{current_page:1,per_page:s.per_page,loading:!1},result:[]}),v=$({sequenceNumber:null,theNumber:null,sorting:null}),m=b({facultyOption:null,optioneduTypeList:null,optionGroupList:null,optioneduFormList:null});z(async()=>{let a=await te().then(t=>t.result);B.value=a.map(t=>({id:t.id,name:t.name+"-"+k("Course")})),m.optioneduTypeList=await ae().then(t=>t.result),m.optionGroupList=await oe().then(t=>t.result.data),m.optioneduFormList=await le().then(t=>t.result)}),[u,F]=Z(()=>h()),await u,F(),U(()=>[s.edu_type_id,s.edu_form_id,s.academic_group_id,s.course],async(a,t)=>{await h()}),U(()=>n.pagination.current_page,async a=>{Number(a)&&(s.page=Number(a),await h(a))});async function A(){await h()}async function h(a){delete s.page;let t=b({...s,page:a||1});if(g.value=!0,C){C.value=!1;const c=await ue(t);Object.assign(n,c),setTimeout(()=>{C.value=!0},50);let r=`${n.pagination.per_page*(n.pagination.current_page-1)+1}- ${n.result.length+n.pagination.per_page*(n.pagination.current_page-1)}`,N=`${k("Total_Point")} : ${n.pagination.total}`,S=n.pagination.per_page*(n.pagination.current_page-1);g.value=!1,v.value.sequenceNumber=r,v.value.theNumber=N,v.value.sorting=S}}async function O(){delete s.page,delete s.per_page;let a=b({...s});try{g.value=!0;const t=await de(a),c=URL.createObjectURL(new Blob([t],{type:"application/vnd.ms-excel"})),r=document.createElement("a");r.href=c,r.setAttribute("download",`Worksheet_${Date.now()}.xlsx`),document.body.appendChild(r),r.click()}catch(t){console.log({error:t})}finally{g.value=!1}}return(a,t)=>{const c=y("a-select"),r=y("a-space"),N=y("a-input"),S=y("b-card"),R=y("b-collapse"),G=K("b-toggle");return p(),f("div",ce,[e("div",pe,[e("div",_e,[e("div",me,[e("h5",fe,o(a.$t("Student_activity")),1),e("div",ge,[e("button",{onClick:O,class:"btns c-save py-1.5 px-4 me-3",type:"submit"},[ve,d(o(a.$t("Export")),1)]),e("div",he,[W((p(),f("button",be,[ye,d(o(a.$t("Filtr")),1)])),[[G,void 0,void 0,{"collapse-3":!0}]])])])])])]),e("div",we,[i(R,{visible:"",id:"collapse-3"},{default:_(()=>[i(S,null,{default:_(()=>[e("form",{class:"row",onSubmit:H(A,["prevent"])},[e("div",$e,[i(r,null,{default:_(()=>[i(c,{class:"form--item",value:D.value,options:m.facultyOption,"field-names":{value:"id",label:"name"},disabled:"",allowClear:""},null,8,["value","options"])]),_:1}),e("label",Le,o(a.$t("Select_the_faculty")),1)]),e("div",ke,[i(r,null,{default:_(()=>[i(c,{class:"form--item",value:s.edu_type_id,"onUpdate:value":t[0]||(t[0]=l=>s.edu_type_id=l),options:m.optioneduTypeList,"field-names":{value:"id",label:"name"},allowClear:""},null,8,["value","options"])]),_:1}),e("label",Ce,o(a.$t("Select_the_type_of_education")),1)]),e("div",Ne,[i(r,null,{default:_(()=>[i(c,{class:"form--item",value:s.edu_form_id,"onUpdate:value":t[1]||(t[1]=l=>s.edu_form_id=l),options:m.optioneduFormList,"field-names":{value:"id",label:"name"},allowClear:""},null,8,["value","options"])]),_:1}),e("label",Se,o(a.$t("Choose_a_form_of_education")),1)]),e("div",Pe,[i(r,null,{default:_(()=>[i(c,{class:"form--item",value:s.academic_group_id,"onUpdate:value":t[2]||(t[2]=l=>s.academic_group_id=l),options:m.optionGroupList,"field-names":{value:"id",label:"name"},allowClear:""},null,8,["value","options"])]),_:1}),e("label",Fe,o(a.$t("Select_a_group")),1)]),e("div",Be,[i(r,null,{default:_(()=>[i(c,{class:"form--item",value:s.course,"onUpdate:value":t[3]||(t[3]=l=>s.course=l),options:B.value,"field-names":{value:"id",label:"name"},allowClear:""},null,8,["value","options"])]),_:1}),e("label",Te,o(a.$t("Select_the_course")),1)]),e("div",Ue,[i(r,null,{default:_(()=>[i(N,{allowClear:"",id:"yu",class:"form-control",value:s.text,"onUpdate:value":t[4]||(t[4]=l=>s.text=l)},null,8,["value"])]),_:1}),e("label",xe,o(a.$t("Full_name"))+" / "+o(a.$t("Passport"))+" / "+o(a.$t("By_code"))+" "+o(a.$t("search")),1)]),e("div",qe,[e("button",De,[Ae,d(o(a.$t("search")),1)])])],32)]),_:1})]),_:1})]),e("div",Oe,[e("div",Re,[e("div",Ge,[e("div",Ve,[g.value?(p(),x(se,{key:0})):P("",!0),n.result.length?(p(),f("div",je,[e("table",Ee,[e("thead",null,[e("tr",Ie,[Me,e("th",null,[e("b",null,o(a.$t("Student")),1)]),e("th",null,[e("b",null,o(a.$t("Specialist")),1)]),e("th",null,[e("b",null,o(J(k)("Type_of_education")),1)]),e("th",null,[e("b",null,o(a.$t("IP_address")),1)]),e("th",null,[e("b",null,o(a.$t("Message")),1)]),e("th",null,[e("b",null,o(a.$t("Date_of_entry")),1)])])]),e("tbody",null,[(p(!0),f(Q,null,X(n.result,(l,T)=>(p(),f("tr",{class:"table-row d-grid w-100",key:l.id},[e("td",null,o(v.value.sorting+T+1),1),e("td",null,[d(o(l.full_name)+" ",1),ze,d(" "+o(l.academic_group),1)]),e("td",null,[d(o(l.specialty),1),Ze,d(" "+o(l.specialty_code),1)]),e("td",null,[d(o(l.edu_type)+" ",1),Ke,d(" "+o(l.edu_form),1)]),e("td",null,o(l.ip)+" / "+o(T),1),e("td",null,o(l.message),1),e("td",null,o(l.date),1)]))),128))])]),n.pagination.last_page>1?(p(),x(ie,Y({key:0,class:"mt-2"},{...n.pagination},{"current-page":n.pagination.current_page,"onUpdate:currentPage":t[5]||(t[5]=l=>n.pagination.current_page=l),loading:g.value,onOnPageChange:h}),null,16,["current-page","loading"])):P("",!0)])):(p(),f("div",We,[i(ne)]))])])])]),e("span",{class:ee(["element-count mb-2",n.pagination.total?"":"d-none"])},[n.pagination.last_page?(p(),f("span",He,o(v.value.sequenceNumber)+" / ",1)):P("",!0),d(o(v.value.theNumber),1)],2)])}}});export{rt as default};
