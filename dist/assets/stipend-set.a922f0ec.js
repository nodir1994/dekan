import{_ as H}from"./Pagination.f4a9fc5d.js";import{_ as Z}from"./LoadingOverlay.vue_vue_type_script_setup_true_lang.89ce9ad6.js";/* empty css                                                       */import{d as J,a as K,bO as Q,B,Z as $,c as W,bq as X,y as x,w as S,i as k,b6 as tt,o as r,e as _,f as a,j as u,k as m,z as v,t as o,bs as P,s as E,l as O,v as at,bH as F,F as C,r as st,aR as et}from"./index.3390162f.js";import{b as ot,m as lt}from"./id.5a6e5f30.js";import{e as nt,k as it,p as dt}from"./index.30e99442.js";import{o as ut,a as ct,b as rt,t as pt}from"./stipend.bb551a1d.js";import{h as _t}from"./helper.569bc08f.js";import{S as mt}from"./sweetalert2.all.fdef424e.js";import"./_plugin-vue_export-helper.cdc0426e.js";import"./vue.runtime.esm-bundler.84001772.js";import"./moment.2cad4b18.js";const ht={pagetitle:"`Guruhdagi talabalar`",class:"studentListPage11"},ft={class:"card panel-header-bg"},vt={class:"card-body"},yt={class:"panel-header"},bt={class:"card-title"},gt={class:"panel-toggles"},wt={class:"filterBlock"},kt={class:"btns c-filter py-1.5 px-4 me-3"},$t=a("i",{class:"mdi mdi-filter font-size-14 align-middle me-1"},null,-1),Ot=a("i",{class:"mdi mdi-arrow-left font-size-14 align-middle me-1 me-1"},null,-1),Ct={class:"collapse__block"},Tt={class:"row"},St={class:"my-2 col-md-4 form--item"},Ut={for:"yu"},Bt={class:"my-2 col-md-4 form--item"},Pt={for:"yu"},jt={class:"my-2 col-md-4 form--item"},Lt={class:"my-2 col-md-4 form--item"},Dt={class:"my-2 col-md-4 form--item"},Nt={class:"my-2 col-md-4 form--item"},Yt={for:"yu"},Gt={class:"row table-division"},Et={class:"col-md-12"},Ft={class:"card"},Mt={class:"card-body"},At={class:"table-responsive"},zt={class:"content-table"},It={class:"table-row-stipend-set"},Rt=a("th",null,"#",-1),Vt={style:{"justify-content":"center"}},qt={class:"form-check"},Ht=["value"],Zt={class:"justify-content-center"},Jt={class:"justify-content-center"},Kt={class:"justify-content-center"},Qt={class:"justify-content-center"},Wt={class:"d-flex gap-2"},Xt={class:"mb-3"},xt={for:"division-name-input",class:"form-label"},ta={key:0,class:"text-danger small"},aa={class:"mb-3"},sa={for:"division-name-input",class:"form-label"},ea={key:0,class:"text-danger small"},oa={class:"d-flex justify-content-end mt-3"},la={class:"btns c-save",type:"submit"},na=a("i",{class:"mdi mdi-check font-size-14 align-middle me-1"},null,-1),ia={key:0,class:"element-count mb-2"},wa=J({__name:"stipend-set",async setup(da){let j,L;const{t:y}=K(),D=Q(),b=B(!1),U=B(!0),n=$({links:[],current_page:1}),c=$({eduTypeOptions:null,eduPlanOptions:null,academicGroupOptions:null,semesterOptions:null,paymentTypeOptions:null,orderTypeOptions:null,stipendTypeOptions:null}),g=B([]),l=$({edu_plan_id:null,edu_type_id:null,academic_group_id:null,semester_id:null,payment_type_id:null,command_id:null,per_page:_t.pagePer}),N=W({get(){var t,s;return g.value.length>0&&((t=n.data)==null?void 0:t.length)===((s=g.value)==null?void 0:s.length)},set(t){var s;t?g.value=(s=n.data)==null?void 0:s.map(i=>i):g.value=[]}});[j,L]=X(()=>w()),await j,L(),x(async()=>{c.eduTypeOptions=await nt().then(t=>t==null?void 0:t.result),c.eduPlanOptions=await it().then(t=>{var s;return(s=t==null?void 0:t.result)==null?void 0:s.data}),c.paymentTypeOptions=await dt().then(t=>t==null?void 0:t.result),c.orderTypeOptions=await ut().then(t=>{var s;return(s=t==null?void 0:t.result)==null?void 0:s.data}),c.stipendTypeOptions=await ct().then(t=>t==null?void 0:t.result)}),S(()=>l.edu_plan_id,async t=>{l.academic_group_id=null,l.semester_id=null,t?(c.academicGroupOptions=await ot(t).then(s=>{var i;return(i=s==null?void 0:s.result)==null?void 0:i.data}),c.semesterOptions=await lt(t).then(s=>{var i;return(i=s==null?void 0:s.result)==null?void 0:i.data.map(d=>({id:d.id,name:d.semester+"-semestr"}))})):(c.academicGroupOptions=null,c.semesterOptions=null),await w()}),S(()=>[l.edu_type_id,l.payment_type_id],async()=>{await w()}),S(()=>[l.academic_group_id,l.semester_id],async()=>{l.edu_plan_id&&await w()}),S(()=>n.current_page,async t=>{Number(t)&&(n.page=Number(t),await w(t))});async function w(t){var i;delete l.command_id;let s={...l,page:t||1,per_page:l.per_page};try{if(b.value=!0,U.value){U.value=!1;const d=await rt(s);Object.assign(n,d.result),n.data=(i=n.data)==null?void 0:i.map(p=>{const h={...p};return h.scholarship||(h.scholarship={student_id:h.id,scholarship_type_id:null,end_date:"",start_date:""}),h}),setTimeout(()=>{U.value=!0},100)}}catch(d){console.log(d)}finally{b.value=!1}}async function M(){try{b.value=!0;let t=$({datas:[],command_id:l.command_id});n.page>1&&(t.datas.page=n==null?void 0:n.page),n==null||n.data.forEach(s=>{var i,d,p,h;((i=s==null?void 0:s.scholarship)==null?void 0:i.start_date)&&((d=s==null?void 0:s.scholarship)==null?void 0:d.end_date)&&((p=s==null?void 0:s.scholarship)==null?void 0:p.scholarship_type_id)&&((h=s==null?void 0:s.scholarship)==null?void 0:h.student_id)&&t.datas.push(s==null?void 0:s.scholarship)}),mt.fire({title:y("Delete_message.Are_you_sure"),text:y("Delete_message.Action_irreversible"),showCancelButton:!0,confirmButtonColor:"#34c38f",cancelButtonColor:"#f46a6a",cancelButtonText:y("No_Cancel"),confirmButtonText:y("transfer")}).then(async s=>{if(s.value){const i=await pt(t);D.success(y("Data_was_successfully_transferred")),setTimeout(async()=>{await w(),A()},100)}}).catch(s=>{var i,d;D.error(y("Failed")+": "+((d=(i=s.response)==null?void 0:i.data)==null?void 0:d.message))}).finally(()=>{b.value=!1})}catch{}finally{b.value=!1}}function A(){l.edu_plan_id=null,l.edu_type_id=null,l.academic_group_id=null,l.semester_id=null,l.payment_type_id=null,l.command_id=null,n.students=[]}const T=$({command_id:[],reference_id:[],students:[]});return(t,s)=>{const i=k("router-link"),d=k("a-select"),p=k("a-space"),h=k("b-card"),z=k("b-collapse"),I=Z,Y=k("a-date-picker"),R=H,V=tt("b-toggle");return r(),_("div",ht,[a("div",ft,[a("div",vt,[a("div",yt,[a("h5",bt,[u(i,{to:"/finance/stipend"},{default:m(()=>[v(o(t.$t("Finance_Scholarship")),1)]),_:1}),v(" / "+o(t.$t("Students_in_Group")),1)]),a("div",gt,[a("div",wt,[P((r(),_("button",kt,[$t,v(o(t.$t("Filter")),1)])),[[V,void 0,void 0,{"collapse-3":!0}]]),u(i,{to:"/finance/stipend",class:"btns black-c py-1.5 px-4 d-inline-block"},{default:m(()=>[Ot,v(o(t.$t("Prev")),1)]),_:1})])])])])]),a("div",Ct,[u(z,{visible:"",id:"collapse-3"},{default:m(()=>[u(h,null,{default:m(()=>[a("div",Tt,[a("div",St,[u(p,null,{default:m(()=>[u(d,{value:l.edu_type_id,"onUpdate:value":s[0]||(s[0]=e=>l.edu_type_id=e),options:c.eduTypeOptions,"field-names":{value:"id",label:"name"},"allow-clear":""},null,8,["value","options"])]),_:1}),a("label",Ut,o(t.$t("Choose_Education_Type")),1)]),a("div",Bt,[u(p,null,{default:m(()=>[u(d,{class:"form--item",value:l.edu_plan_id,"onUpdate:value":s[1]||(s[1]=e=>l.edu_plan_id=e),allowClear:"","field-names":{value:"id",label:"name"},options:c.eduPlanOptions},null,8,["value","options"])]),_:1}),a("label",Pt,o(t.$t("Choose_Curriculum")),1)]),a("div",jt,[u(p,null,{default:m(()=>[u(d,{class:"form--item",value:l.academic_group_id,"onUpdate:value":s[2]||(s[2]=e=>l.academic_group_id=e),allowClear:"","field-names":{value:"id",label:"name"},options:c.academicGroupOptions},null,8,["value","options"])]),_:1}),a("label",null,o(t.$t("Choose_Group")),1)]),a("div",Lt,[u(p,null,{default:m(()=>[u(d,{class:"form--item",value:l.semester_id,"onUpdate:value":s[3]||(s[3]=e=>l.semester_id=e),allowClear:"","field-names":{value:"id",label:"name"},options:c.semesterOptions},null,8,["value","options"])]),_:1}),a("label",null,o(t.$t("Choose_Semester")),1)]),a("div",Dt,[u(p,null,{default:m(()=>[u(d,{class:"form--item",value:l.payment_type_id,"onUpdate:value":s[4]||(s[4]=e=>l.payment_type_id=e),allowClear:"","field-names":{value:"id",label:"name"},options:c.paymentTypeOptions},null,8,["value","options"])]),_:1}),a("label",null,o(t.$t("Select_payment_form")),1)]),a("div",Nt,[u(p,null,{default:m(()=>[u(d,{class:"form--item",value:l.command_id,"onUpdate:value":s[5]||(s[5]=e=>l.command_id=e),allowClear:"","field-names":{value:"id",label:"name"},options:c.orderTypeOptions},null,8,["value","options"])]),_:1}),a("label",Yt,o(t.$t("Select_the_command")),1)])])]),_:1})]),_:1})]),a("div",Gt,[a("div",Et,[a("div",Ft,[a("div",Mt,[b.value?(r(),E(I,{key:0})):O("",!0),a("form",{onSubmit:at(M,["prevent"])},[a("div",At,[a("table",zt,[a("thead",null,[a("tr",It,[a("th",null,[P(a("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":s[6]||(s[6]=e=>N.value=e)},null,512),[[F,N.value]])]),Rt,a("th",null,o(t.$t("Student")),1),a("th",null,o(t.$t("Group")),1),a("th",null,o(t.$t("Finance_Scholarship_Amount")),1),a("th",null,o(t.$t("Debtor_List")),1),a("th",null,o(t.$t("Contract_Debt")),1),a("th",null,o(t.$t("gradeSome")),1),a("th",null,"30% - "+o(t.$t("Subject")),1),a("th",Vt,o(t.$t("Deadline")),1)])]),a("tbody",null,[(r(!0),_(C,null,st(n.data,(e,q)=>{var G;return r(),_("tr",{class:"table-row-stipend-set",key:e==null?void 0:e.id},[a("td",null,[a("div",qt,[P(a("input",{type:"checkbox",class:"form-check-input","onUpdate:modelValue":s[7]||(s[7]=f=>g.value=f),value:e},null,8,Ht),[[F,g.value]])])]),a("td",null,o((n.current_page-1)*n.per_page+q+1),1),a("td",null,o(e==null?void 0:e.fullname),1),a("td",null,o((G=e==null?void 0:e.academic_group)==null?void 0:G.name),1),a("td",null,[u(p,null,{default:m(()=>[u(d,{class:"form--item",value:e.scholarship.scholarship_type_id,"onUpdate:value":f=>e.scholarship.scholarship_type_id=f,allowClear:"","field-names":{value:"id",label:"name"},options:c.stipendTypeOptions},null,8,["value","onUpdate:value","options"])]),_:2},1024)]),a("td",Zt,o(e==null?void 0:e.academic_debt),1),a("td",Jt,[e!=null&&e.contract_debt?(r(),_(C,{key:0},[v(o(t.$t("Yes")),1)],64)):(r(),_(C,{key:1},[v(o(t.$t("No")),1)],64))]),a("td",Kt,o(e==null?void 0:e.rating),1),a("td",Qt,[e!=null&&e.subject_30_percent?(r(),_(C,{key:0},[v(o(t.$t("Yes")),1)],64)):(r(),_(C,{key:1},[v(o(t.$t("No")),1)],64))]),a("td",Wt,[a("div",Xt,[a("label",xt,o(t.$t("Choice_Start_Date")),1),u(Y,{value:e.scholarship.start_date,"onUpdate:value":f=>e.scholarship.start_date=f,"value-format":"YYYY-MM-DD",onChange:f=>"date_start",placeholder:t.$t("Enter_date")},null,8,["value","onUpdate:value","placeholder"]),T.start_date?(r(),_("span",ta,o(T.start_date[0]),1)):O("",!0)]),a("div",aa,[a("label",sa,o(t.$t("End_date")),1),u(Y,{value:e.scholarship.end_date,"onUpdate:value":f=>e.scholarship.end_date=f,"value-format":"YYYY-MM-DD",onChange:f=>"date_end",placeholder:t.$t("Enter_date")},null,8,["value","onUpdate:value","placeholder"]),T.end_date?(r(),_("span",ea,o(T.end_date[0]),1)):O("",!0)])])])}),128))])])]),a("div",oa,[a("button",la,[na,v(o(t.$t("assign")),1)])])],32),n.last_page>1?(r(),E(R,et({key:1,class:"mt-2"},{...n},{"current-page":n.current_page,"onUpdate:currentPage":s[8]||(s[8]=e=>n.current_page=e)}),null,16,["current-page"])):O("",!0)])]),n.data.length?(r(),_("span",ia,o(n.current_page)+"-"+o(n.data.length+n.per_page*(n.current_page-1))+"/ "+o(t.$t("Total_Point"))+": "+o(n.total),1)):O("",!0)])])])}}});export{wa as default};
