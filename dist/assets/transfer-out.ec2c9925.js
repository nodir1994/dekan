import{_ as K}from"./Pagination.f4a9fc5d.js";import{_ as Q}from"./LoadingOverlay.vue_vue_type_script_setup_true_lang.89ce9ad6.js";/* empty css                                                       */import{bR as W,d as X,a as ee,bO as te,B as $,Z as k,c as se,bq as ae,y as oe,w as y,i as D,o as h,e as b,f as t,t as n,s as z,l as F,bs as I,bH as R,F as ne,r as le,z as w,aR as ie,v as de,j as _,g as c}from"./index.3390162f.js";import{e as re,b as ce}from"./index.30e99442.js";import{e as ue,b as _e,f as pe}from"./id.5a6e5f30.js";import{S as me}from"./sweetalert2.all.fdef424e.js";import{h as f}from"./helper.569bc08f.js";import"./_plugin-vue_export-helper.cdc0426e.js";import"./vue.runtime.esm-bundler.84001772.js";import"./moment.2cad4b18.js";const N=W();async function he(g){try{const{data:l}=await N({url:"api/students/alienation",method:"GET",params:g});return l}catch(l){throw l}}async function fe(g){try{const{data:l}=await N({url:"api/references/student-alienation-reasons",method:"GET"});return l}catch(l){throw l}}async function ve(g){try{const{data:l}=await N({url:"api/commands/list/alienation",method:"GET"});return l}catch(l){throw l}}async function ye(g){try{const{data:l}=await N({url:"/api/student-actions/alienation",method:"POST",data:g});return l}catch(l){throw l}}const be={pagetitle:"'Chetlashtirish'",class:"transfer-out-page"},ge={class:"card panel-header-bg"},we={class:"card-body"},Oe={class:"panel-header"},Ce={style:{padding:"7px 0"},class:"card-title"},ke={class:"row"},Be={class:"col-xl-8"},Fe={class:"card"},Ne={class:"card-body"},Te={key:1,class:"table-responsive"},$e={class:"content-table"},Se={class:"table-row d-grid w-100"},Le=t("th",null,"#",-1),Pe={class:"form-check"},Ue={class:"form-check"},Ge=["value"],Me=t("br",null,null,-1),Ee={class:"c-gray"},Ye=t("br",null,null,-1),je={class:"c-gray"},Ae=t("br",null,null,-1),xe={class:"c-gray"},De=t("br",null,null,-1),ze={class:"c-gray"},Ie={key:2},Re={class:"text-center"},Ve={class:"text-center"},qe={key:0,class:"element-count mb-2"},He={class:"col-xl-4"},Ze={class:"card"},Je={class:"card-body"},Ke={class:"mb-3 col-md-10"},Qe=t("div",{class:"col-md-2"},[t("button",{type:"submit",class:"btn-search search-color"},[t("i",{class:"mdi mdi-magnify font-size-14 align-middle"})])],-1),We={class:"row"},Xe={class:"mb-3",name:"nameFaculty"},et={class:"mb-3",name:"nameFaculty"},tt={class:"mb-3",name:"nameFaculty"},st={class:"mb-3",name:"nameFaculty"},at={class:"mb-3",name:"nameFaculty"},ot={class:"d-flex justify-content-end"},nt=t("i",{class:"mdi mdi-close font-size-14 align-middle me-1"},null,-1),lt={class:"card"},it={class:"card-body"},dt={class:"mb-3",name:"nameFaculty"},rt={for:"division-name-select",class:"form-label"},ct={class:"mb-3",name:"nameFaculty"},ut={for:"division-name-select",class:"form-label"},_t={key:0,class:"text-danger small"},pt={class:"mb-3",name:"nameFaculty"},mt={for:"division-name-input",class:"form-label"},ht={class:"mb-3"},ft={for:"division-name-select",class:"form-label"},vt={class:"d-flex justify-content-end"},yt=["disabled"],bt=t("i",{class:"mdi mdi-check font-size-14 align-middle me-1"},null,-1),Lt=X({__name:"transfer-out",async setup(g){let l,S;const{t:r}=ee(),L=te(),O=$(!1);k({});const e=k({search:"",edu_plan_id:null,edu_type_id:null,semester_id:null,academic_group_id:null,edu_form_id:null,data:[],links:[],students:[],current_page:1,per_page:f.pagePer,command_id:null,reference_id:null,dateCommand:null}),d=k({eduTypeOptions:null,eduFormOptions:null,eduPlanOptions:null,semesterOptions:null,academicGroupOptions:null,orderListOptions:null,typeMobileOptions:null}),C=$([]),T=$(!0),P=se({get(){var o,s;return((o=e==null?void 0:e.students)==null?void 0:o.length)===((s=C==null?void 0:C.value)==null?void 0:s.length)},set(o){o?e.students=C.value:e.students=[]}});[l,S]=ae(()=>p()),await l,S(),oe(async()=>{d.typeMobileOptions=await fe().then(o=>o.result),d.orderListOptions=await ve().then(o=>{var s;return(s=o.result)==null?void 0:s.data.map(i=>({id:i.id,name:i.name,date:i.date}))}),d.eduTypeOptions=await re().then(o=>o.result),d.eduFormOptions=await ce().then(o=>o.result)}),y(()=>e.edu_type_id,async()=>{await p()}),y(()=>e.edu_form_id,async()=>{e.edu_plan_id=null,await p(),e.edu_form_id&&(d.eduPlanOptions=await ue(e.edu_form_id).then(o=>{var s;return(s=o.result)==null?void 0:s.data}))}),y(()=>e.edu_plan_id,async()=>{var o,s;if(e.semester_id=null,e.academic_group_id=null,d.semesterOptions=null,d.academicGroupOptions=null,await p(),e.edu_plan_id){let i=await _e(e.edu_plan_id);d.academicGroupOptions=(o=i==null?void 0:i.result)==null?void 0:o.data.map(u=>({id:u.id,name:u.name}));let m=await pe(e.edu_plan_id);d.semesterOptions=(s=m==null?void 0:m.result)==null?void 0:s.data.map(u=>({id:u.id,name:u.course+"-"+r("course")+" "+u.semester+"-"+r("semester")}))}}),y(()=>e.semester_id,async()=>{await p()}),y(()=>e.academic_group_id,async()=>{await p()}),y(()=>e.command_id,()=>{e.command_id?e.dateCommand=d.orderListOptions.find(o=>o.id==e.command_id).date:e.dateCommand=null}),y(()=>e.current_page,async o=>{Number(o)&&(e.page=Number(o),await p(o))});async function V(){await p()}function U(){e.search="",e.edu_form_id=null,e.edu_type_id=null,e.edu_plan_id=null,e.semester_id=null,e.academic_group_id=null,e.reference_id=null,e.command_id=null,e.students=[]}async function q(){var o,s;try{O.value=!0,H();let i={students:e.students,command_id:e.command_id,reference_id:e.reference_id};me.fire({title:r("Delete_message.Are_you_sure"),text:r("Delete_message.Action_irreversible"),showCancelButton:!0,confirmButtonColor:"#34c38f",cancelButtonColor:"#f46a6a",cancelButtonText:r("No_Cancel"),confirmButtonText:r("transfer")}).then(async m=>{m.value&&(await ye(i),L.success(r("Data_was_successfully_transferred")),setTimeout(()=>{p(),U()},100))})}catch(i){Object.assign(B,(s=(o=i.response)==null?void 0:o.data)==null?void 0:s.errors),L.error(r("Failed")+": "+i.message)}finally{O.value=!1}}function H(){Object.assign(B,{command_id:[],reference_id:[],students:[]})}const B=k({command_id:[],reference_id:[],students:[]});async function p(o){let s=k({page:o||1,per_page:e.per_page});e.edu_type_id&&(s.edu_type_id=e.edu_type_id),e.edu_form_id&&(s.edu_form_id=e.edu_form_id),e.edu_plan_id&&(s.edu_plan_id=e.edu_plan_id),e.semester_id&&(s.semester_id=e.semester_id),e.academic_group_id&&(s.academic_group_id=e.academic_group_id),e.search&&(s.search=e.search),O.value=!0;try{if(T.value){T.value=!1;const i=await he(s);Object.assign(e,i.result),C.value=e.data.map(m=>m.id),setTimeout(()=>{T.value=!0},100)}}catch(i){console.log(i)}finally{O.value=!1}}return(o,s)=>{var G,M;const i=Q,m=K,u=D("a-input"),v=D("a-select");return h(),b("div",be,[t("div",ge,[t("div",we,[t("div",Oe,[t("h5",Ce,n(o.$t("Transfer_Student_Expel")),1)])])]),t("div",ke,[t("div",Be,[t("div",Fe,[t("div",Ne,[O.value?(h(),z(i,{key:0})):F("",!0),e.data.length?(h(),b("div",Te,[t("table",$e,[t("thead",null,[t("tr",Se,[Le,t("th",null,[t("div",Pe,[I(t("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":s[0]||(s[0]=a=>P.value=a)},null,512),[[R,P.value]])])]),t("th",null,n(o.$t("Student")),1),t("th",null,n(o.$t("Education_Type")),1),t("th",null,n(o.$t("by_Level")),1),t("th",null,n(o.$t("Group")),1)])]),t("tbody",null,[(h(!0),b(ne,null,le(e.data,(a,Z)=>{var E,Y,j,A,x;return h(),b("tr",{class:"table-row w-100 d-grid",key:a.id},[t("td",null,n((e.current_page-1)*e.per_page+Z+1),1),t("td",null,[t("div",Ue,[I(t("input",{type:"checkbox",class:"form-check-input","onUpdate:modelValue":s[1]||(s[1]=J=>e.students=J),value:a.id},null,8,Ge),[[R,e.students]])])]),t("td",null,[t("div",null,[w(n(a==null?void 0:a.surname)+" "+n(a==null?void 0:a.name)+" ",1),Me,t("span",Ee,n(a.id),1)])]),t("td",null,[t("div",null,[w(n((Y=(E=a==null?void 0:a.specialty)==null?void 0:E.edu_type)==null?void 0:Y.name)+" ",1),Ye,t("span",je,n(a.edu_form),1)])]),t("td",null,[t("div",null,[w(n((j=a==null?void 0:a.semester)==null?void 0:j.course)+" - kurs ",1),Ae,t("span",xe,n((A=a==null?void 0:a.semester)==null?void 0:A.semester)+" - semestr ",1)])]),t("td",null,[t("div",null,[w(n((x=a==null?void 0:a.academic_group)==null?void 0:x.name)+" ",1),De,t("span",ze,n(a.academicYear),1)])])])}),128))])]),e.last_page>1?(h(),z(m,ie({key:0,class:"mt-2"},{...e},{"current-page":e.current_page,"onUpdate:currentPage":s[2]||(s[2]=a=>e.current_page=a)}),null,16,["current-page"])):F("",!0)])):(h(),b("div",Ie,[t("h5",Re,n(o.$t("No_data")),1),t("p",Ve,n(o.$t("No_information_found")),1)]))])]),e.data.length?(h(),b("span",qe,n(e.current_page)+"-"+n((e==null?void 0:e.data.length)+e.per_page*(e.current_page-1))+"/ "+n(o.$t("Total_Point"))+": "+n(e.total),1)):F("",!0)]),t("div",He,[t("div",Ze,[t("div",Je,[t("form",{class:"row",onSubmit:de(V,["prevent"])},[t("div",Ke,[_(u,{id:"yu",value:e.search,"onUpdate:value":s[3]||(s[3]=a=>e.search=a),class:"form-control",placeholder:c(r)("choose__fish__student__passport__code")},null,8,["value","placeholder"])]),Qe],32),t("div",We,[t("div",Xe,[_(v,{"filter-option":c(f).filterOptionByName,"show-search":"","allow-clear":"",value:e.edu_type_id,"onUpdate:value":s[4]||(s[4]=a=>e.edu_type_id=a),"field-names":{value:"id",label:"name"},options:d.eduTypeOptions,placeholder:c(r)("Choose_Education_Type")},null,8,["filter-option","value","options","placeholder"])]),t("div",et,[_(v,{"filter-option":c(f).filterOptionByName,"show-search":"","allow-clear":"",value:e.edu_form_id,"onUpdate:value":s[5]||(s[5]=a=>e.edu_form_id=a),"field-names":{value:"id",label:"name"},options:d.eduFormOptions,placeholder:c(r)("Choose_Education_Form")},null,8,["filter-option","value","options","placeholder"])]),t("div",tt,[_(v,{"filter-option":c(f).filterOptionByName,"show-search":"","allow-clear":"",value:e.edu_plan_id,"onUpdate:value":s[6]||(s[6]=a=>e.edu_plan_id=a),"field-names":{value:"id",label:"name"},options:d.eduPlanOptions,placeholder:o.$t("Please_select_curriculum")},null,8,["filter-option","value","options","placeholder"])]),t("div",st,[_(v,{"filter-option":c(f).filterOptionByName,"show-search":"","allow-clear":"",value:e.semester_id,"onUpdate:value":s[7]||(s[7]=a=>e.semester_id=a),"field-names":{value:"id",label:"name"},options:d.semesterOptions,placeholder:c(r)("Choose_Semester")},null,8,["filter-option","value","options","placeholder"])]),t("div",at,[_(v,{"filter-option":c(f).filterOptionByName,"show-search":"","allow-clear":"",value:e.academic_group_id,"onUpdate:value":s[8]||(s[8]=a=>e.academic_group_id=a),"field-names":{value:"id",label:"name"},options:d.academicGroupOptions,placeholder:c(r)("Choose_Group")},null,8,["filter-option","value","options","placeholder"])]),t("div",ot,[t("button",{class:"btns c-delet",type:"button",onClick:U},[nt,w(n(o.$t("Clear")),1)])])])])]),t("div",lt,[t("div",it,[t("div",dt,[t("label",rt,n(o.$t("Status_Change_Reason")),1),_(v,{"filter-option":c(f).filterOptionByName,"show-search":"","allow-clear":"",value:e.reference_id,"onUpdate:value":s[9]||(s[9]=a=>e.reference_id=a),"field-names":{value:"id",label:"name"},options:d.typeMobileOptions,placeholder:c(r)("Choose")},null,8,["filter-option","value","options","placeholder"])]),t("div",ct,[t("label",ut,n(o.$t("Decree")),1),_(v,{"filter-option":c(f).filterOptionByName,"show-search":"","allow-clear":"",value:e.command_id,"onUpdate:value":s[10]||(s[10]=a=>e.command_id=a),"field-names":{value:"id",label:"name"},options:d.orderListOptions,placeholder:c(r)("Select_the_command")},null,8,["filter-option","value","options","placeholder"]),B.command_id?(h(),b("span",_t,n(B.command_id[0]),1)):F("",!0)]),t("div",pt,[t("label",mt,n(o.$t("Circulation_Doc_Date")),1),_(u,{value:e.dateCommand,"onUpdate:value":s[11]||(s[11]=a=>e.dateCommand=a),placeholder:"YYYY-MM-DD",disabled:"","value-format":"YYYY-MM-DD"},null,8,["value"])]),t("div",ht,[t("label",ft,n(o.$t("Count_of_Contract_Student")),1),_(u,{disabled:"",value:(G=e==null?void 0:e.students)==null?void 0:G.length},null,8,["value"])]),t("div",vt,[t("button",{class:"btns c-save",type:"submit",disabled:!((M=e==null?void 0:e.students)!=null&&M.length)||!e.reference_id,onClick:q},[bt,w(n(o.$t("Send_Grades")),1)],8,yt)])])])])])])}}});export{Lt as default};
