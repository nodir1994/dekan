import{_ as Q}from"./Pagination.f4a9fc5d.js";import{_ as W}from"./LoadingOverlay.vue_vue_type_script_setup_true_lang.89ce9ad6.js";/* empty css                                                       */import{bR as X,d as ee,a as se,bO as ae,B as P,Z as N,c as te,bq as oe,y as le,w,i as z,o as m,e as g,f as s,t as l,s as D,l as Y,bs as V,bH as R,F as ne,r as ie,z as O,aR as re,v as de,j as h,g as _,bV as q}from"./index.3390162f.js";import{j as ce}from"./index.30e99442.js";import{a as ue,b as _e,s as pe,h as me}from"./id.5a6e5f30.js";import{S as he}from"./sweetalert2.all.fdef424e.js";import{h as b}from"./helper.569bc08f.js";import"./_plugin-vue_export-helper.cdc0426e.js";import"./vue.runtime.esm-bundler.84001772.js";import"./moment.2cad4b18.js";const T=X();async function fe(f){try{const{data:p}=await T({url:"api/students/transfer-course",method:"GET",params:f});return p}catch(p){throw p}}async function ve(f){try{const{data:p}=await T({url:"/api/student-actions/transfer-course",method:"POST",data:f});return p}catch(p){throw p}}async function be(){try{const{data:f}=await T({url:"/api/commands/list/transfer-course",method:"GET"});return f}catch(f){throw f}}const ge={pagetitle:"'Kursga o\u2019tkazish'",class:"transfer-course-page"},ye={class:"card panel-header-bg"},we={class:"card-body"},Oe={class:"panel-header"},Ce={style:{padding:"7px 0"},class:"card-title"},ke={class:"row"},Be={class:"col-xl-8"},$e={class:"card"},Ne={class:"card-body"},Ye={key:1,class:"table-responsive"},Se={class:"content-table"},Pe={class:"table-row w-100 d-grid"},Te=s("th",null,"#",-1),Ue={class:"form-check"},je={class:"form-check"},Ge=["value"],Le=s("br",null,null,-1),Ee={class:"c-gray"},Fe=s("br",null,null,-1),Ae={class:"c-gray"},Me=s("br",null,null,-1),Ie={class:"c-gray"},ze=s("br",null,null,-1),De={class:"c-gray"},Ve={key:2},Re={class:"text-center"},qe={class:"text-center"},xe={key:0,class:"element-count mb-2"},He={class:"col-xl-4"},Ke={class:"card"},Ze={class:"card-body"},Je={class:"mb-3 col-md-10"},Qe=s("div",{class:"col-md-2"},[s("button",{type:"submit",class:"btn-search search-color"},[s("i",{class:"mdi mdi-magnify font-size-14 align-middle"})])],-1),We={class:"row"},Xe={class:"mb-3"},es={class:"mb-3"},ss={class:"mb-3"},as={class:"mb-3"},ts={class:"d-flex justify-content-end"},os=s("i",{class:"mdi mdi-close font-size-14 align-middle me-1"},null,-1),ls={class:"card"},ns={class:"card-body"},is={class:"mb-3"},rs={for:"division-name-select",class:"form-label"},ds={class:"mb-3",name:"nameFaculty"},cs={for:"division-name-select",class:"form-label"},us={key:0,class:"text-danger small"},_s={class:"mb-3",name:"nameFaculty"},ps={for:"division-name-input",class:"form-label"},ms={class:"mb-3"},hs={for:"division-name-select",class:"form-label"},fs={class:"d-flex justify-content-end"},vs=["disabled"],bs=s("i",{class:"mdi mdi-check font-size-14 align-middle me-1"},null,-1),Ps=ee({__name:"transfer-course",async setup(f){let p,U;const{t:i}=se(),C=ae(),k=P(!1),e=N({search:"",edu_plan_id:null,academic_year_id:null,course:null,semester_id:null,academic_group_id:null,course_id:null,command_id:null,dateCommand:null,course_bottom_id:null,current_page:1,students:[],data:[],per_page:b.pagePer,links:[]}),r=N({eduPlanOptions:null,academicYearsOptions:null,courseOptions:null,semesterOptions:null,academicGroupOptions:null,courseBottomOptions:null,orderOptions:null}),B=P([]),S=P(!0),j=te({get(){var o,a;return((o=e==null?void 0:e.students)==null?void 0:o.length)===((a=B==null?void 0:B.value)==null?void 0:a.length)},set(o){o?e.students=B.value:e.students=[]}});[p,U]=oe(()=>v()),await p,U(),le(async()=>{r.eduPlanOptions=await ce().then(o=>{var a;return(a=o==null?void 0:o.result)==null?void 0:a.data}),r.orderOptions=await be().then(o=>o==null?void 0:o.result.data.map(a=>({id:a.id,name:a.name,date:a.date})))}),w(()=>e.edu_plan_id,async()=>{var o,a;if(e.course_bottom_id=null,e.academic_year_id=null,e.semester_id=null,e.course_id=null,e.academic_group_id=null,r.academicYearsOptions=null,r.academicGroupOptions=null,r.courseOptions=null,r.semesterOptions=null,r.courseBottomOptions=null,await v(),e.edu_plan_id){let c=await ue(e.edu_plan_id);r.academicYearsOptions=(o=c==null?void 0:c.result)==null?void 0:o.data.map(n=>({id:n.id,name:n.name}));let d=await _e(e.edu_plan_id);r.academicGroupOptions=(a=d==null?void 0:d.result)==null?void 0:a.data.map(n=>({id:n.id,name:n.name}))}}),w(()=>e.academic_year_id,async()=>{var o;if(e.semester_id=null,e.semester=null,r.semesterOptions=null,e.course_id=null,r.courseOptions=null,await v(),e.edu_plan_id&&e.academic_year_id){let a=await pe(e),c=(o=a==null?void 0:a.result)==null?void 0:o.data.map(d=>({id:d.id,semester:d.semester,name:d.course+"-"+i("Course")+" "+d.semester+"-"+i("semester")}));r.semesterOptions=c.filter(d=>!(d.semester%2))}}),w(()=>e.semester,async()=>{await v(),e.semester&&(r.courseBottomOptions=await me(e).then(o=>o==null?void 0:o.result.map(a=>({id:a.semester_id,name:a.course+"-"+i("course")+" "+a.semester+"-"+i("semester")}))))}),w(()=>e.command_id,()=>{e.command_id?e.dateCommand=r.orderOptions.find(o=>o.id==e.command_id).date:e.dateCommand=null}),w(()=>e.academic_group_id,async()=>{await v()}),w(()=>e.current_page,async o=>{Number(o)&&(e.page=Number(o),await v(o))});async function x(){await v()}function G(){e.edu_plan_id=null,e.search=null,e.course_bottom_id=null,e.academic_year_id=null,e.semester_id=null,e.semester=null,e.course_id=null,e.academic_group_id=null,e.command_id=null,e.students=[]}async function H(){var o,a;try{k.value=!0,K();let c={};e.page>1&&(c.page=e==null?void 0:e.page),Object.assign(c,{students:e.students,semester_id:e.course_bottom_id,command_id:e.command_id}),he.fire({title:i("Delete_message.Are_you_sure"),text:i("Delete_message.Action_irreversible"),showCancelButton:!0,confirmButtonColor:"#34c38f",cancelButtonColor:"#f46a6a",cancelButtonText:i("No_Cancel"),confirmButtonText:i("transfer")}).then(async d=>{if(d.value){const n=await ve(c);C.success(i("Data_was_successfully_transferred")),G(),await v()}}).catch(d=>{var n,u,$;Object.assign(y,(n=d.response)==null?void 0:n.data),C.error(i("Failed")+": "+(($=(u=d.response)==null?void 0:u.data)==null?void 0:$.message))})}catch(c){Object.assign(y,(a=(o=c.response)==null?void 0:o.data)==null?void 0:a.errors),C.error(i("Failed")+": "+c.message)}finally{k.value=!1}}function K(){Object.assign(y,{specialty_id:[],semester_id:[],academic_group_id:[]})}const y=N({semester_id:[],command_id:[]});async function v(o){var c,d;let a=N({});e.edu_plan_id&&(a.edu_plan_id=e.edu_plan_id),e.academic_year_id&&(a.academic_year_id=e.academic_year_id),e.semester_id&&(a.semester_id=e.semester_id),e.search&&(a.search=e.search),e.academic_group_id&&(a.academic_group_id=e.academic_group_id),a.per_page=e.per_page,a.page=o||1,k.value=!0;try{if(S.value){S.value=!1;const n=await fe(a);Object.assign(e,n.result),B.value=e.data.map(u=>u.id),setTimeout(()=>{S.value=!0},b.loaderRefresh)}}catch(n){if(Object.assign(y,(d=(c=n.response)==null?void 0:c.data)==null?void 0:d.errors),n.response.status==500){const u="/page/500";q.push({path:u})}if(n.response.status==422&&C.error(i("Dashboard_Error")+": "+i("Fill_in_the_required_fields")),n.response.status==404){const u="/page/404";q.push({path:u})}else C.error(i("Dashboard_Error")+": "+n.message)}finally{k.value=!1}}return(o,a)=>{var $,L;const c=W,d=Q,n=z("a-input"),u=z("a-select");return m(),g("div",ge,[s("div",ye,[s("div",we,[s("div",Oe,[s("h5",Ce,l(o.$t("transfer__course")),1)])])]),s("div",ke,[s("div",Be,[s("div",$e,[s("div",Ne,[k.value?(m(),D(c,{key:0})):Y("",!0),e.data.length?(m(),g("div",Ye,[s("table",Se,[s("thead",null,[s("tr",Pe,[Te,s("th",null,[s("div",Ue,[V(s("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":a[0]||(a[0]=t=>j.value=t)},null,512),[[R,j.value]])])]),s("th",null,l(o.$t("Student")),1),s("th",null,l(o.$t("Education_Type")),1),s("th",null,l(o.$t("by_Level")),1),s("th",null,l(o.$t("Group")),1),s("th",null,l(o.$t("gpa")),1),s("th",null,l(o.$t("Contract_Indebtedness")),1)])]),s("tbody",null,[(m(!0),g(ne,null,ie(e.data,(t,Z)=>{var E,F,A,M,I;return m(),g("tr",{class:"table-row w-100 d-grid",key:t==null?void 0:t.id},[s("td",null,l((e.current_page-1)*e.per_page+Z+1),1),s("td",null,[s("div",je,[V(s("input",{type:"checkbox",class:"form-check-input","onUpdate:modelValue":a[1]||(a[1]=J=>e.students=J),value:t==null?void 0:t.id},null,8,Ge),[[R,e.students]])])]),s("td",null,[s("div",null,[O(l(t==null?void 0:t.surname)+" "+l(t==null?void 0:t.name)+" ",1),Le,s("span",Ee,l(t.id_number),1)])]),s("td",null,[s("div",null,[O(l((F=(E=t==null?void 0:t.specialty)==null?void 0:E.edu_type)==null?void 0:F.name)+" ",1),Fe,s("span",Ae,l(t.edu_form),1)])]),s("td",null,[s("div",null,[O(l((A=t==null?void 0:t.semester)==null?void 0:A.course)+"-"+l(o.$t("Course"))+" ",1),Me,s("span",Ie,l((M=t==null?void 0:t.semester)==null?void 0:M.semester)+"-"+l(o.$t("semester")),1)])]),s("td",null,[s("div",null,[O(l((I=t==null?void 0:t.academic_group)==null?void 0:I.name)+" ",1),ze,s("span",De,l(t==null?void 0:t.academicYear),1)])]),s("td",null,l(t==null?void 0:t.gpa),1),s("td",null,l(t==null?void 0:t.gpa),1)])}),128))])]),e.last_page>1?(m(),D(d,re({key:0,class:"mt-2"},{...e},{"current-page":e.current_page,"onUpdate:currentPage":a[2]||(a[2]=t=>e.current_page=t)}),null,16,["current-page"])):Y("",!0)])):(m(),g("div",Ve,[s("h5",Re,l(o.$t("No_data")),1),s("p",qe,l(o.$t("No_information_found")),1)]))])]),e.data.length?(m(),g("span",xe,l(e.current_page)+"-"+l((e==null?void 0:e.data.length)+e.per_page*(e.current_page-1))+"/ "+l(o.$t("Total_Point"))+": "+l(e.total),1)):Y("",!0)]),s("div",He,[s("div",Ke,[s("div",Ze,[s("form",{class:"row",onSubmit:de(x,["prevent"])},[s("div",Je,[h(n,{id:"yu",value:e.search,"onUpdate:value":a[3]||(a[3]=t=>e.search=t),class:"form-control",placeholder:_(i)("choose__fish__student__passport__code")},null,8,["value","placeholder"])]),Qe],32),s("div",We,[s("div",Xe,[h(u,{"allow-clear":"","filter-option":_(b).filterOptionByName,"show-search":"",value:e.edu_plan_id,"onUpdate:value":a[4]||(a[4]=t=>e.edu_plan_id=t),"field-names":{value:"id",label:"name"},options:r.eduPlanOptions,placeholder:o.$t("Please_select_curriculum")},null,8,["filter-option","value","options","placeholder"])]),s("div",es,[h(u,{"allow-clear":"","filter-option":_(b).filterOptionByName,"show-search":"",value:e.academic_year_id,"onUpdate:value":a[5]||(a[5]=t=>e.academic_year_id=t),"field-names":{value:"id",label:"name"},options:r.academicYearsOptions,placeholder:_(i)("Choose_Education_Year")},null,8,["filter-option","value","options","placeholder"])]),s("div",ss,[h(u,{"allow-clear":"","filter-option":_(b).filterOptionByName,"show-search":"",value:e.semester,"onUpdate:value":a[6]||(a[6]=t=>e.semester=t),"field-names":{value:"semester",label:"name"},options:r.semesterOptions,placeholder:_(i)("Choose_Semester")},null,8,["filter-option","value","options","placeholder"])]),s("div",as,[h(u,{"allow-clear":"","filter-option":_(b).filterOptionByName,"show-search":"",value:e.academic_group_id,"onUpdate:value":a[7]||(a[7]=t=>e.academic_group_id=t),"field-names":{value:"id",label:"name"},options:r.academicGroupOptions,placeholder:_(i)("Choose_Group")},null,8,["filter-option","value","options","placeholder"])]),s("div",ts,[s("button",{class:"btns c-delet",type:"button",onClick:G},[os,O(l(o.$t("Clear")),1)])])])])]),s("div",ls,[s("div",ns,[s("div",is,[s("label",rs,l(o.$t("Next_Level")),1),h(u,{"allow-clear":"","filter-option":_(b).filterOptionByName,"show-search":"",value:e.course_bottom_id,"onUpdate:value":a[8]||(a[8]=t=>e.course_bottom_id=t),"field-names":{value:"id",label:"name"},options:r.courseBottomOptions,placeholder:_(i)("next__level__course"),disabled:!e.semester},null,8,["filter-option","value","options","placeholder","disabled"])]),s("div",ds,[s("label",cs,l(o.$t("Decree")),1),h(u,{"allow-clear":"","filter-option":_(b).filterOptionByName,"show-search":"",value:e.command_id,"onUpdate:value":a[9]||(a[9]=t=>e.command_id=t),"field-names":{value:"id",label:"name"},options:r.orderOptions,placeholder:_(i)("Select_the_command")},null,8,["filter-option","value","options","placeholder"]),y.command_id?(m(),g("span",us,l(y.command_id[0]),1)):Y("",!0)]),s("div",_s,[s("label",ps,l(o.$t("Circulation_Doc_Date")),1),h(n,{value:e.dateCommand,"onUpdate:value":a[10]||(a[10]=t=>e.dateCommand=t),placeholder:"YYYY-MM-DD",disabled:"","value-format":"YYYY-MM-DD"},null,8,["value"])]),s("div",ms,[s("label",hs,l(o.$t("Count_of_Contract_Student")),1),h(n,{disabled:"",value:($=e==null?void 0:e.students)==null?void 0:$.length},null,8,["value"])]),s("div",fs,[s("button",{class:"btns c-save",disabled:!((L=e==null?void 0:e.students)!=null&&L.length)||!e.course_bottom_id,type:"button",onClick:H},[bs,O(l(o.$t("Send_Grades")),1)],8,vs)])])])])])])}}});export{Ps as default};
