import{_ as A}from"./Pagination.f4a9fc5d.js";import{_ as q}from"./LoadingOverlay.vue_vue_type_script_setup_true_lang.89ce9ad6.js";/* empty css                                                       */import{bR as I,d as M,a as V,B as $,Z as N,bq as L,y as H,w as v,i as h,b6 as W,o as i,e as d,f as t,t as s,z as b,bs as Z,j as _,k as y,v as G,g as P,s as x,l as w,F as J,r as K,aR as Q}from"./index.3390162f.js";import{f as X}from"./index.30e99442.js";import{h as k}from"./helper.569bc08f.js";import"./_plugin-vue_export-helper.cdc0426e.js";import"./vue.runtime.esm-bundler.84001772.js";import"./sweetalert2.all.fdef424e.js";import"./moment.2cad4b18.js";const C=I();async function B(m){try{const{data:l}=await C({url:"/api/teachers",params:m});return l}catch(l){throw l}}async function Y(m){try{const{data:l}=await C({url:"https://api-dekan.eduni.uz/api/teachers/export",params:m,responseType:"blob"});return l}catch(l){throw l}}const tt={pagetitle:"`O'qituvchilar ro'yxati`",class:"teacherListPage"},et={class:"card panel-header-bg"},at={class:"card-body"},st={class:"panel-header"},ot={class:"card-title"},nt={class:"panel-toggles"},lt=t("i",{class:"mdi mdi-download font-size-14 align-middle me-1"},null,-1),it={class:"filterBlock"},rt={class:"btns c-filter py-1.5 px-4"},ct=t("i",{class:"mdi mdi-filter font-size-14 align-middle me-1"},null,-1),dt={class:"collapse__block"},_t={class:"my-2 col-xl-5 form--item"},pt={class:"my-2 col-xl-5 form--item"},ut={class:"my-2 col-xl-2"},ht={type:"submit",class:"btn-search search-color"},mt=t("i",{class:"mdi mdi-magnify font-size-14 align-middle me-1"},null,-1),ft={class:"row table-division"},yt={class:"col-xl-12"},gt={class:"card"},vt={class:"card-body"},bt={key:1,class:"table-responsive"},wt={class:"content-table"},kt={class:"table-row-teacher-list"},$t=t("th",null,"#",-1),Nt={key:2},Lt={class:"text-center"},Pt={class:"text-center"},xt={key:0,class:"element-count mb-2"},Ut=M({__name:"index",async setup(m){let l,f;V();const p=$(!1),g=$(!0),e=N({search:"",page:1,department_id:null,current_page:1,data:[],links:[],per_page:k.pagePer}),S=([l,f]=L(()=>X().then(a=>a.result)),l=await l,f(),l);[l,f]=L(()=>u()),await l,f(),H(async()=>{await B()}),v(()=>e.department_id,async()=>{await u()}),v(()=>e.search,async()=>{e.search.length==0&&await u()}),v(()=>e.current_page,async a=>{Number(a)&&(e.page=Number(a),await u(a))}),N({semester_id:[],teacherty_id:[]});async function D(){await u()}async function E(){let a={};e.search&&(a.search=e.search),e.department_id&&(a.department_id=e.department_id);try{p.value=!0;const n=await Y(a),r=URL.createObjectURL(new Blob([n],{type:"application/vnd.ms-excel"})),c=document.createElement("a");c.href=r,c.setAttribute("download",`Worksheet_${Date.now()}.xlsx`),document.body.appendChild(c),c.click()}catch(n){console.log({error:n})}finally{p.value=!1}}async function u(a){let n={page:a||e.page};e.department_id&&(n.department_id=e.department_id),e.search&&(n.search=e.search),e.per_page&&(n.per_page=e.per_page);try{if(p.value=!0,g.value){g.value=!1;const r=await B(n);Object.assign(e,r.result),setTimeout(()=>{g.value=!0},k.loaderRefresh)}}catch(r){console.log(r)}finally{p.value=!1}}return(a,n)=>{const r=h("a-select"),c=h("a-space"),O=h("a-input"),z=h("b-card"),F=h("b-collapse"),R=q,T=A,U=W("b-toggle");return i(),d("div",tt,[t("div",et,[t("div",at,[t("div",st,[t("h5",ot,s(a.$t("Employee_Teacher")),1),t("div",nt,[t("button",{onClick:E,class:"btns c-save py-1.5 px-4 me-3",type:"submit"},[lt,b(s(a.$t("Download")),1)]),t("div",it,[Z((i(),d("button",rt,[ct,b(s(a.$t("Filter")),1)])),[[U,void 0,void 0,{"collapse-3":!0}]])])])])])]),t("div",dt,[_(F,{visible:"",id:"collapse-3"},{default:y(()=>[_(z,null,{default:y(()=>[t("form",{onSubmit:G(D,["prevent"]),class:"row"},[t("div",_t,[_(c,null,{default:y(()=>[_(r,{class:"form--item","field-names":{value:"id",label:"name"},value:e.department_id,"onUpdate:value":n[0]||(n[0]=o=>e.department_id=o),"filter-option":P(k).filterOptionByName,showSearch:"",options:P(S),"allow-clear":""},null,8,["value","filter-option","options"])]),_:1}),t("label",null,s(a.$t("Choose_Department")),1)]),t("div",pt,[_(c,null,{default:y(()=>[_(O,{id:"yu",value:e.search,"onUpdate:value":n[1]||(n[1]=o=>e.search=o),class:"form-control","allow-clear":""},null,8,["value"])]),_:1}),t("label",null,s(a.$t("Search_by_Name_Passport_Employee_ID")),1)]),t("div",ut,[t("button",ht,[mt,b(s(a.$t("Search")),1)])])],32)]),_:1})]),_:1})]),t("div",ft,[t("div",yt,[t("div",gt,[t("div",vt,[p.value?(i(),x(R,{key:0})):w("",!0),e.data.length?(i(),d("div",bt,[t("table",wt,[t("thead",null,[t("tr",kt,[$t,t("th",null,s(a.$t("Employee")),1),t("th",null,s(a.$t("Hei_department")),1),t("th",null,s(a.$t("by_Post")),1),t("th",null,s(a.$t("Employment_Staff")),1),t("th",null,s(a.$t("Status")),1)])]),t("tbody",null,[(i(!0),d(J,null,K(e.data,(o,j)=>(i(),d("tr",{class:"table-row-teacher-list",key:o.id},[t("td",null,s((e.current_page-1)*e.per_page+j+1),1),t("td",null,[t("div",null,s(o==null?void 0:o.fullname),1)]),t("td",null,s(o==null?void 0:o.department),1),t("td",null,s(o==null?void 0:o.position),1),t("td",null,s(o==null?void 0:o.work_rate),1),t("td",null,s(o==null?void 0:o.position),1)]))),128))])]),e.last_page>1?(i(),x(T,Q({key:0,class:"mt-2"},{...e},{"current-page":e.current_page,"onUpdate:currentPage":n[2]||(n[2]=o=>e.current_page=o)}),null,16,["current-page"])):w("",!0)])):(i(),d("div",Nt,[t("h5",Lt,s(a.$t("No_data")),1),t("p",Pt,s(a.$t("No_information_found")),1)]))])]),e.data.length?(i(),d("span",xt,s(e.current_page)+"-"+s((e==null?void 0:e.data.length)+e.per_page*(e.current_page-1))+"/ "+s(a.$t("Total_Point"))+": "+s(e.total),1)):w("",!0)])])])}}});export{Ut as default};
