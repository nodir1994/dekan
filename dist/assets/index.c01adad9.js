import{_ as Q}from"./LoadingOverlay.vue_vue_type_script_setup_true_lang.89ce9ad6.js";/* empty css                                                       */import{bR as W,d as X,a as x,bO as ss,B as as,h as ts,c as es,Z as A,bq as U,y as os,w as V,i as g,b6 as ls,o as _,e as p,f as s,t,bs as ds,z as w,j as c,k as b,g as B,s as is,l as O,F,r as G,v as ns,bS as cs}from"./index.3390162f.js";import{k as rs,a as _s}from"./index.30e99442.js";import{c as us,d as ps}from"./id.5a6e5f30.js";import{h as ms}from"./helper.569bc08f.js";import"./vue.runtime.esm-bundler.84001772.js";import"./sweetalert2.all.fdef424e.js";import"./moment.2cad4b18.js";const P=W();async function hs(v){try{const{data:i}=await P({url:"api/group-session-times",method:"Get",params:v});return i}catch(i){throw i}}async function bs(v){try{const{data:i}=await P({url:"/api/group-session-times",method:"Post",data:v});return i}catch(i){throw i}}async function fs(v){try{const{data:i}=await P({url:`api/group-session-subjects/${v}`,method:"delete"});return i}catch(i){throw i}}const vs={pagetitle:"'Kordinator'",class:"all-group"},ys={class:"card panel-header-bg"},gs={class:"card-body"},ws={class:"panel-header"},js={class:"card-title"},$s={class:"panel-toggles"},Os={class:"filterBlock"},ks={class:"btns c-filter py-1.5 px-4"},Cs=s("i",{class:"mdi mdi-filter me-2"},null,-1),Ss={class:"collapse__block"},Ys={class:"row"},As={class:"my-2 col-md-3 form--item"},Es={for:"yu"},Ms={class:"my-2 col-md-3 form--item"},Bs={for:"yu"},Ps={class:"my-2 col-md-3 form--item"},Ds={for:"yu"},Is={class:"my-2 col-md-3 form--item"},Ls={for:"yu"},Ns={class:"card"},Us={class:"card-body"},Vs={key:1,class:"table-responsive"},Fs={class:"content-table"},Gs={class:"table-row-schedule"},zs=s("th",null,[s("strong",null,"#")],-1),Ts={class:"d-flex flex-wrap"},qs=s("br",null,null,-1),Ks=["onClick"],Rs={class:"btns c-save"},Zs=s("i",{class:"mdi mdi-plus me-1"},null,-1),Hs={key:2},Js={class:"text-center"},Qs={class:"text-center"},Ws={key:0,class:"element-count mb-2"},Xs={id:"AllGroupCoordinator",class:"modal fade selectionSubject",tabindex:"-1","aria-labelledby":"myModalLabel","aria-hidden":"true"},xs={class:"modal-dialog"},sa={class:"modal-content"},aa={class:"modal-header bg-card-header"},ta={class:"modal-title",id:"myModalLabel"},ea=s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal"},[s("i",{class:"mdi mdi-close"})],-1),oa={class:"modal-body"},la={class:"row"},da={class:"col-md-6"},ia={for:"division-name-select",class:"form-label"},na={key:0,class:"text-danger small"},ca={class:"col-md-6"},ra={for:"division-name-select",class:"form-label"},_a={key:0,class:"text-danger small"},ua={class:"mt-3"},pa={for:"division-name-select",class:"form-label"},ma={key:0,class:"text-danger small"},ha={class:"d-flex justify-content-between"},ba={class:"btns c-cancel me-1"},fa=s("i",{class:"mdi mdi-close font-size-14 align-middle me-1"},null,-1),va={class:"btns c-save",type:"submit"},ya=s("i",{class:"mdi mdi-content-save font-size-14 align-middle me-1"},null,-1),Aa=X({__name:"index",async setup(v){let i,k;const{t:y}=x(),D=ss(),j=as(!1),E=ts(),z=es(()=>{var a,o;return(o=(a=E==null?void 0:E.user)==null?void 0:a.faculty)==null?void 0:o.name}),e=A({edu_plan_id:null,academic_year_id:null,semester_id:null,data:[],links:[],students:[],per_page:ms.pagePer,current_page:1,page:1}),n=A({academic_group_id:null,semester_id:null,subjects:[],date_list:null,date_start:null,date_end:null}),h=A({eduPlanOptions:null,academicYearsOptions:null,semesterOptions:null,subjectOptions:null});h.academicYearsOptions=([i,k]=U(()=>_s().then(a=>{var o;return(o=a==null?void 0:a.result)==null?void 0:o.data})),i=await i,k(),i),e.academic_year_id=h.academicYearsOptions.find(a=>a.is_current==!0).id,os(async()=>{h.eduPlanOptions=await rs().then(a=>{var o;return(o=a==null?void 0:a.result)==null?void 0:o.data})}),V(()=>[e.edu_plan_id,e.academic_year_id],async(a,o)=>{e.semester_id=null,h.semesterOptions=null,await C(),e.edu_plan_id&&e.academic_year_id&&(h.semesterOptions=await us(e.edu_plan_id,e.academic_year_id).then(d=>{var r;return(r=d==null?void 0:d.result)==null?void 0:r.data.map(u=>({id:u.id,name:u.semester+"-"+y("semester_number")}))}))}),V(()=>e.semester_id,async()=>{await C()}),[i,k]=U(()=>C()),await i,k();function T(){cs.getOrCreateInstance("#AllGroupCoordinator").hide()}async function q(){var a,o;try{j.value=!0,K(),await bs(n),T(),D.success(y("updated_successfully")),C()}catch(d){Object.assign(f,(o=(a=d.response)==null?void 0:a.data)==null?void 0:o.errors),D.error(y("Failed")+": "+d.message)}finally{j.value=!1}}function K(){Object.assign(f,{date_start:[],date_end:[],subjects:[]})}const f=A({date_start:[],date_end:[],subjects:[]});async function R(a){var o,d,r;n.current=[],n.current=a==null?void 0:a.group_session_time.subjects,n.subjects=[],(o=a==null?void 0:a.group_session_time)==null||o.subjects.forEach(u=>{n.subjects.push(u==null?void 0:u.subject_id)}),n.date_start=((d=a==null?void 0:a.group_session_time)==null?void 0:d.date_start)||null,n.date_end=((r=a==null?void 0:a.group_session_time)==null?void 0:r.date_end)||null,n.academic_group_id=a==null?void 0:a.id,n.semester_id=a==null?void 0:a.semester_id,h.subjectOptions=await ps(n.academic_group_id,n.semester_id).then(u=>{var S;return(S=u==null?void 0:u.result)==null?void 0:S.map(m=>{var $,Y;return{id:($=m==null?void 0:m.subject)==null?void 0:$.id,subject_id:m==null?void 0:m.id,name:(Y=m==null?void 0:m.subject)==null?void 0:Y.name}})})}async function C(){let a={};e.edu_plan_id&&(a.edu_plan_id=e.edu_plan_id),e.academic_year_id&&(a.academic_year_id=e.academic_year_id),e.semester_id&&(a.semester_id=e.semester_id),j.value=!0;try{if(e.academic_year_id){const o=await hs(a);Object.assign(e,o.result)}}catch(o){console.log(o)}finally{j.value=!1}}async function Z(a){console.log(a);let o=n.current.find(d=>d.subject_id==a).id;try{await fs(o)}catch(d){console.log(d)}}return(a,o)=>{const d=g("a-select"),r=g("a-space"),u=g("b-card"),S=g("b-collapse"),m=Q,$=g("a-date-picker"),Y=g("a-form"),H=ls("b-toggle");return _(),p("div",vs,[s("div",ys,[s("div",gs,[s("div",ws,[s("h5",js,t(a.$t("all_groups")),1),s("div",$s,[s("div",Os,[ds((_(),p("button",ks,[Cs,w(t(a.$t("Filtr")),1)])),[[H,void 0,void 0,{"collapse-3":!0}]])])])])])]),s("div",Ss,[c(S,{visible:"",id:"collapse-3"},{default:b(()=>[c(u,null,{default:b(()=>[s("div",Ys,[s("div",As,[c(r,null,{default:b(()=>[c(d,{class:"form--item",value:z.value,disabled:""},null,8,["value"])]),_:1}),s("label",Es,t(a.$t("Choose_faculty")),1)]),s("div",Ms,[c(r,null,{default:b(()=>[c(d,{"allow-clear":"",value:e.edu_plan_id,"onUpdate:value":o[0]||(o[0]=l=>e.edu_plan_id=l),"field-names":{value:"id",label:"name"},options:h.eduPlanOptions,placeholder:a.$t("Please_select_curriculum")},null,8,["value","options","placeholder"])]),_:1}),s("label",Bs,t(B(y)("Please_select_curriculum")),1)]),s("div",Ps,[c(r,null,{default:b(()=>[c(d,{"allow-clear":"",value:e.academic_year_id,"onUpdate:value":o[1]||(o[1]=l=>e.academic_year_id=l),"field-names":{value:"id",label:"name"},options:h.academicYearsOptions,placeholder:B(y)("Choose_Education_Year")},null,8,["value","options","placeholder"])]),_:1}),s("label",Ds,t(a.$t("Choose_Education_Year")),1)]),s("div",Is,[c(r,null,{default:b(()=>[c(d,{"allow-clear":"",value:e.semester_id,"onUpdate:value":o[2]||(o[2]=l=>e.semester_id=l),disabled:!e.edu_plan_id||!e.academic_year_id,"field-names":{value:"id",label:"name"},options:h.semesterOptions,placeholder:B(y)("Choose_Semester")},null,8,["value","disabled","options","placeholder"])]),_:1}),s("label",Ls,t(a.$t("Choose_Semester")),1)])])]),_:1})]),_:1})]),s("div",Ns,[s("div",Us,[j.value?(_(),is(m,{key:0})):O("",!0),e.data.length?(_(),p("div",Vs,[s("table",Fs,[s("thead",null,[s("tr",Gs,[zs,s("th",null,[s("strong",null,t(a.$t("Group")),1)]),s("th",null,[s("strong",null,t(a.$t("study_plan")),1)]),s("th",null,[s("strong",null,t(a.$t("Academic_year")),1)]),s("th",null,[s("strong",null,t(a.$t("Semester_Name")),1)]),s("th",null,[s("strong",null,t(a.$t("Subjects")),1)]),s("th",null,[s("strong",null,t(a.$t("Time")),1)]),s("th",null,[s("strong",null,t(a.$t("Actions")),1)])])]),s("tbody",null,[(_(!0),p(F,null,G(e.data,(l,J)=>{var I,L,N;return _(),p("tr",{class:"table-row-schedule",key:l==null?void 0:l.id},[s("td",null,t((e.current_page-1)*e.per_page+J+1),1),s("td",null,t(l.name),1),s("td",null,t(l.edu_plan),1),s("td",null,t(l.academic_year),1),s("td",null,t(l.semester)+" - "+t(a.$t("semester")),1),s("td",Ts,[(_(!0),p(F,null,G((I=l==null?void 0:l.group_session_time)==null?void 0:I.subjects,M=>(_(),p("span",{key:M.id,class:"actions-h me-1"},t(M.name),1))),128))]),s("td",null,[w(t((L=l==null?void 0:l.group_session_time)==null?void 0:L.date_start)+" ",1),qs,w(" "+t((N=l==null?void 0:l.group_session_time)==null?void 0:N.date_end),1)]),s("td",{"data-bs-toggle":"modal",onClick:M=>R(l),"data-bs-target":"#AllGroupCoordinator"},[s("button",Rs,[Zs,w(" "+t(a.$t("add")),1)])],8,Ks)])}),128))])])])):(_(),p("div",Hs,[s("h5",Js,t(a.$t("No_data")),1),s("p",Qs,t(a.$t("No_information_found")),1)]))])]),e.data.length?(_(),p("span",Ws,t(e.current_page)+"-"+t((e==null?void 0:e.data.length)+e.per_page*(e.current_page-1))+"/ "+t(a.$t("Total_Point"))+": "+t(e.total),1)):O("",!0),s("div",Xs,[s("div",xs,[s("div",sa,[s("div",aa,[s("h5",ta,t(a.$t("Education_Subject_Choose")),1),ea]),s("div",oa,[c(Y,{autocomplete:"",onSubmit:ns(q,["prevent"])},{default:b(()=>[s("div",la,[s("div",da,[c(r,{direction:"vertical",class:"mb-3 height-auto",name:"employee"},{default:b(()=>[s("label",ia,t(a.$t("Exam_Start_At")),1),c($,{"value-format":"YYYY-MM-DD",value:n.date_start,"onUpdate:value":o[3]||(o[3]=l=>n.date_start=l),placeholder:a.$t("Enter_name")},null,8,["value","placeholder"]),f.date_start?(_(),p("span",na,t(f.date_start[0]),1)):O("",!0)]),_:1})]),s("div",ca,[c(r,{direction:"vertical",class:"mb-3 height-auto",name:"employee"},{default:b(()=>[s("label",ra,t(a.$t("End_date")),1),c($,{"value-format":"YYYY-MM-DD",value:n.date_end,"onUpdate:value":o[4]||(o[4]=l=>n.date_end=l),placeholder:a.$t("Enter_name")},null,8,["value","placeholder"]),f.date_end?(_(),p("span",_a,t(f.date_end[0]),1)):O("",!0)]),_:1})]),s("div",ua,[c(r,{direction:"vertical",class:"mb-3 height-auto",name:"employee"},{default:b(()=>[s("label",pa,t(a.$t("Subjects")),1),c(d,{required:"",value:n.subjects,"onUpdate:value":o[5]||(o[5]=l=>n.subjects=l),mode:"multiple",options:h.subjectOptions,"field-names":{value:"id",label:"name"},style:{width:"200px"},onDeselect:Z},null,8,["value","options"]),f.subjects?(_(),p("span",ma,t(f.subjects[0]),1)):O("",!0)]),_:1})])]),s("div",ha,[s("button",ba,[fa,w(t(a.$t("Close")),1)]),s("button",va,[ya,w(" "+t(a.$t("Save")),1)])])]),_:1})])])])])])}}});export{Aa as default};
