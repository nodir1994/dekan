import{_ as W}from"./Pagination.f4a9fc5d.js";import{_ as X}from"./LoadingOverlay.vue_vue_type_script_setup_true_lang.89ce9ad6.js";/* empty css                                                       */import{bR as ee,d as ae,Z as k,bO as te,B as F,a as se,c as oe,bq as le,y as ne,w as v,i as C,b6 as ie,o as m,e as h,f as a,t as n,bs as P,z as B,j as p,k as S,v as de,g as f,s as j,l as N,bH as I,F as re,r as ce,aR as ue}from"./index.3390162f.js";import{k as _e}from"./index.30e99442.js";import{a as me,b as pe,s as fe}from"./id.5a6e5f30.js";import{S as he}from"./sweetalert2.all.fdef424e.js";import{h as y}from"./helper.569bc08f.js";import"./_plugin-vue_export-helper.cdc0426e.js";import"./vue.runtime.esm-bundler.84001772.js";import"./moment.2cad4b18.js";const D=ee();async function ve(g){try{const{data:d}=await D({url:"api/students",method:"GET",params:g});return d}catch(d){throw d}}async function ye(g){try{const{data:d}=await D({url:"api/commands/list/graduation",method:"GET"});return d}catch(d){throw d}}async function ge(g){try{const{data:d}=await D({url:"/api/student-actions/graduation",method:"POST",data:g});return d}catch(d){throw d}}const be={pagetitle:"'Akademik tatil'",class:"transfer-finish-page"},we={class:"card panel-header-bg"},Oe={class:"card-body"},ke={class:"panel-header"},Ce={class:"card-title"},Be={class:"filterBlock"},Ne={class:"btns c-filter py-1.5 px-4"},Ye=a("i",{class:"mdi mdi-filter font-size-14 align-middle me-1"},null,-1),$e={class:"collapse__block"},Fe={class:"col-xl-3 form--item"},Pe={class:"my-2",name:"nameFaculty"},Se={class:"col-xl-3 form--item"},De={class:"my-2",name:"nameFaculty"},xe={class:"col-xl-3 form--item"},Ge={class:"my-2",name:"nameFaculty"},Te={class:"col-xl-3 form--item"},Ue={class:"my-2",name:"nameFaculty"},Le={class:"row"},Me={class:"col-xl-8"},Ae={class:"card"},Ee={class:"card-body"},je={key:1,class:"table-responsive"},Ie={class:"content-table"},Ve={class:"table-row d-grid w-100"},ze=a("th",null,"#",-1),Re={class:"form-check"},qe=["value"],He=a("br",null,null,-1),Ze=a("br",null,null,-1),Je={key:2},Ke={class:"text-center"},Qe={class:"text-center"},We={key:0,class:"element-count mb-2"},Xe={class:"col-xl-4"},ea={class:"card"},aa={class:"card-body"},ta={class:"mb-3",name:"nameFaculty"},sa={for:"division-name-select",class:"form-label"},oa={key:0,class:"text-danger small"},la={class:"mb-3",name:"nameFaculty"},na={for:"division-name-input",class:"form-label"},ia={class:"d-flex justify-content-end"},da=["disabled"],ra=a("i",{class:"mdi mdi-check font-size-14 align-middle me-1"},null,-1),wa=ae({__name:"transfer-finish",async setup(g){let d,x;k({});const G=te(),b=F(!1),{t:u}=se(),e=k({search:"",edu_plan_id:null,academic_year_id:null,semester_id:null,academic_group_id:null,reference_id:null,command_id:null,current_page:1,data:[],links:[],page:1,per_page:y.pagePer,students:[],dateCommand:null}),i=k({eduPlanOptions:null,academicYearsOptions:null,semesterOptions:null,academicGroupOptions:null,orderOptions:null}),w=F([]),Y=F(!0),T=oe({get(){var t,s;return((t=e==null?void 0:e.students)==null?void 0:t.length)===((s=w==null?void 0:w.value)==null?void 0:s.length)},set(t){t?e.students=w.value:e.students=[]}});[d,x]=le(()=>_()),await d,x(),ne(async()=>{var s;let t=await _e();i.eduPlanOptions=(s=t==null?void 0:t.result)==null?void 0:s.data,i.orderOptions=await ye().then(l=>{var r;return(r=l==null?void 0:l.result)==null?void 0:r.data.map(c=>({id:c.id,name:c.name,date:c.date}))})}),v(()=>e.edu_plan_id,async()=>{var t,s;if(e.academic_year_id=null,e.semester_id=null,e.academic_group_id=null,i.academicYearsOptions=null,i.academicGroupOptions=null,i.semesterOptions=null,await _(),e.edu_plan_id){let l=await me(e.edu_plan_id);i.academicYearsOptions=(t=l==null?void 0:l.result)==null?void 0:t.data.map(c=>({id:c.id,name:c.name}));let r=await pe(e.edu_plan_id);i.academicGroupOptions=(s=r==null?void 0:r.result)==null?void 0:s.data.map(c=>({id:c.id,name:c.name}))}}),v(()=>e.academic_year_id,async()=>{var t;if(e.semester_id=null,i.semesterOptions=null,await _(),e.edu_plan_id&&e.academic_year_id){let s=await fe(e);i.semesterOptions=(t=s==null?void 0:s.result)==null?void 0:t.data.map(l=>({id:l.id,name:l.semester+"-semestr"}))}}),v(()=>e.semester_id,async()=>{!e.semester_id&&e.academic_year_id&&await _(),e.semester_id&&await _()}),v(()=>e.academic_group_id,async()=>{e.academic_group_id?await _():await _()}),v(()=>e.command_id,()=>{e.command_id?e.dateCommand=i.orderOptions.find(t=>t.id==e.command_id).date:e.dateCommand=null}),v(()=>e.current_page,async t=>{Number(t)&&(e.page=Number(t),await _(t))});async function V(){await _()}async function z(){var t,s;try{b.value=!0;let l={students:e.students,command_id:e.command_id};he.fire({title:u("Delete_message.Are_you_sure"),text:u("Delete_message.Action_irreversible"),showCancelButton:!0,confirmButtonColor:"#34c38f",cancelButtonColor:"#f46a6a",cancelButtonText:u("No_Cancel"),confirmButtonText:u("transfer")}).then(async r=>{r.value&&(await ge(l),G.success(u("Data_was_successfully_transferred")),R(),_())})}catch(l){Object.assign($,(s=(t=l.response)==null?void 0:t.data)==null?void 0:s.errors),G.error(u("Failed")+": "+l.message)}finally{b.value=!1}}function R(){e.edu_plan_id=null,e.command_id=null,e.students=[]}const $=k({command_id:[],students:[]});async function _(t){let s=k({page:t||1,per_page:e.per_page});e.edu_plan_id&&(s.edu_plan_id=e.edu_plan_id),e.academic_year_id&&(s.academic_year_id=e.academic_year_id),e.semester_id&&(s.semester_id=e.semester_id),e.academic_group_id&&(s.academic_group_id=e.academic_group_id),b.value=!0;try{if(Y.value){Y.value=!1;const l=await ve(s);Object.assign(e,l.result),w.value=e.data.map(r=>r.id),setTimeout(()=>{Y.value=!0},100)}}catch(l){console.log(l)}finally{b.value=!1}}return(t,s)=>{const l=C("a-select"),r=C("b-card"),c=C("b-collapse"),q=X,H=W,Z=C("a-input"),J=C("a-form"),K=ie("b-toggle");return m(),h("div",be,[a("div",we,[a("div",Oe,[a("div",ke,[a("h5",Ce,n(t.$t("Transfer_Graduate")),1),a("div",Be,[P((m(),h("button",Ne,[Ye,B(n(t.$t("Filter")),1)])),[[K,void 0,void 0,{"collapse-3":!0}]])])])])]),a("div",$e,[p(c,{visible:"",id:"collapse-3"},{default:S(()=>[p(r,null,{default:S(()=>[a("form",{class:"row",onSubmit:de(V,["prevent"])},[a("div",Fe,[a("div",Pe,[p(l,{"filter-option":f(y).filterOptionByName,"show-search":"","allow-clear":"",value:e.edu_plan_id,"onUpdate:value":s[0]||(s[0]=o=>e.edu_plan_id=o),"field-names":{value:"id",label:"name"},options:i.eduPlanOptions,placeholder:t.$t("Please_select_curriculum")},null,8,["filter-option","value","options","placeholder"])])]),a("div",Se,[a("div",De,[p(l,{"filter-option":f(y).filterOptionByName,"show-search":"","allow-clear":"",disabled:!e.edu_plan_id,value:e.academic_year_id,"onUpdate:value":s[1]||(s[1]=o=>e.academic_year_id=o),"field-names":{value:"id",label:"name"},options:i.academicYearsOptions,placeholder:f(u)("Choose_Education_Year")},null,8,["filter-option","disabled","value","options","placeholder"])])]),a("div",xe,[a("div",Ge,[p(l,{"filter-option":f(y).filterOptionByName,"show-search":"","allow-clear":"",disabled:!e.academic_year_id,value:e.semester_id,"onUpdate:value":s[2]||(s[2]=o=>e.semester_id=o),"field-names":{value:"id",label:"name"},options:i.semesterOptions,placeholder:f(u)("Choose_Semester")},null,8,["filter-option","disabled","value","options","placeholder"])])]),a("div",Te,[a("div",Ue,[p(l,{"filter-option":f(y).filterOptionByName,"show-search":"","allow-clear":"",value:e.academic_group_id,"onUpdate:value":s[3]||(s[3]=o=>e.academic_group_id=o),disabled:!e.edu_plan_id,"field-names":{value:"id",label:"name"},options:i.academicGroupOptions,placeholder:f(u)("Choose_Group")},null,8,["filter-option","value","disabled","options","placeholder"])])])],32)]),_:1})]),_:1})]),a("div",Le,[a("div",Me,[a("div",Ae,[a("div",Ee,[b.value?(m(),j(q,{key:0})):N("",!0),e.data.length?(m(),h("div",je,[a("table",Ie,[a("thead",null,[a("tr",Ve,[ze,a("th",null,[P(a("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":s[4]||(s[4]=o=>T.value=o)},null,512),[[I,T.value]])]),a("th",null,n(t.$t("Student")),1),a("th",null,n(t.$t("by_Specialty")),1),a("th",null,n(t.$t("Education_Year_Name")),1),a("th",null,n(t.$t("Payment_Form")),1)])]),a("tbody",null,[(m(!0),h(re,null,ce(e.data,(o,O)=>{var U,L,M,A,E;return m(),h("tr",{class:"table-row w-100 d-grid",key:o.id},[a("td",null,n((e.current_page-1)*e.per_page+O+1),1),a("td",null,[a("div",Re,[P(a("input",{type:"checkbox",class:"form-check-input","onUpdate:modelValue":s[5]||(s[5]=Q=>e.students=Q),value:o.id},null,8,qe),[[I,e.students]])])]),a("td",null,n(o.name)+" "+n(o.surname),1),a("td",null,[a("div",null,[a("span",null,n((U=o==null?void 0:o.specialty)==null?void 0:U.code),1),He,B(" "+n((L=o==null?void 0:o.specialty)==null?void 0:L.name),1)])]),a("td",null,[a("div",null,[B(n((M=o==null?void 0:o.semester)==null?void 0:M.course)+" - "+n(t.$t("course"))+" ",1),Ze,B(" "+n((A=o==null?void 0:o.semester)==null?void 0:A.semester)+" - "+n(t.$t("semester")),1)])]),a("td",null,n((E=o==null?void 0:o.payment_type)==null?void 0:E.name),1)])}),128))])]),e.last_page>1?(m(),j(H,ue({key:0,class:"mt-2"},{...e},{"current-page":e.current_page,"onUpdate:currentPage":s[6]||(s[6]=o=>e.current_page=o)}),null,16,["current-page"])):N("",!0)])):(m(),h("div",Je,[a("h5",Ke,n(t.$t("No_data")),1),a("p",Qe,n(t.$t("No_information_found")),1)]))])]),e.data.length?(m(),h("span",We,n(e.current_page)+"-"+n((e==null?void 0:e.data.length)+e.per_page*(e.current_page-1))+"/ "+n(t.$t("Total_Point"))+": "+n(e.total),1)):N("",!0)]),a("div",Xe,[a("div",ea,[a("div",aa,[p(J,null,{default:S(()=>{var o;return[a("div",ta,[a("label",sa,n(t.$t("Decree")),1),p(l,{"filter-option":f(y).filterOptionByName,"show-search":"","allow-clear":"",value:e.command_id,"onUpdate:value":s[7]||(s[7]=O=>e.command_id=O),"field-names":{value:"id",label:"name"},options:i.orderOptions,placeholder:f(u)("Select_the_command")},null,8,["filter-option","value","options","placeholder"]),$.command_id?(m(),h("span",oa,n($.command_id[0]),1)):N("",!0)]),a("div",la,[a("label",na,n(t.$t("Circulation_Doc_Date")),1),p(Z,{value:e.dateCommand,"onUpdate:value":s[8]||(s[8]=O=>e.dateCommand=O),placeholder:"YYYY-MM-DD",disabled:"","value-format":"YYYY-MM-DD"},null,8,["value"])]),a("div",ia,[a("button",{onClick:z,disabled:!((o=e==null?void 0:e.students)!=null&&o.length)||!e.command_id,class:"btns c-save",type:"button"},[ra,B("Ok ")],8,da)])]}),_:1})])])])])])}}});export{wa as default};
