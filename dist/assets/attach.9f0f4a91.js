import{_ as J}from"./Pagination.f4a9fc5d.js";import{_ as K}from"./LoadingOverlay.vue_vue_type_script_setup_true_lang.89ce9ad6.js";/* empty css                                                       */import{bR as Q,d as W,a as X,bO as aa,B as P,Z as $,c as ea,bq as ta,y as sa,h as la,w as B,i as T,o as u,e as p,f as e,t as o,s as V,l as w,v as j,j as m,k as oa,z as E,bs as R,bH as z,F as ia,r as na,aR as da,g as O}from"./index.3390162f.js";import{a1 as ra,ap as ca}from"./index.30e99442.js";import{q as ua,b as _a}from"./id.5a6e5f30.js";import{S as pa}from"./sweetalert2.all.fdef424e.js";import{h as f}from"./helper.569bc08f.js";import"./_plugin-vue_export-helper.cdc0426e.js";import"./vue.runtime.esm-bundler.84001772.js";import"./moment.2cad4b18.js";const M=Q();async function ma(k){try{const{data:r}=await M({url:"api/students/free",params:k});return r}catch(r){throw r}}async function ha(k){try{const{data:r}=await M({url:"api/students/attachment",method:"PUT",params:k});return r}catch(r){throw r}}const fa={pagetitle:"`Talabalar kontengenti`",class:"attach-page"},ya={class:"card panel-header-bg"},va={class:"card-body"},ga={class:"panel-header"},ba={class:"card-title",style:{padding:"7px 0"}},wa=e("div",{class:"panel-toggles"},null,-1),Oa={class:"row table-division"},ka={class:"col-lg-8"},$a={class:"card"},Ba={class:"card-body"},Na={class:"my-2 col-md-10 form--item"},Sa={for:"yu"},Pa={class:"my-2 col-md-2"},Ta={type:"submit",class:"btn-search search-color"},Ca=e("i",{class:"mdi mdi-magnify font-size-14 align-middle me-1"},null,-1),Ua={key:1,class:"table-responsive"},Aa={class:"content-table"},Da={class:"table-row w-100 d-grid"},Ga=e("th",null,"#",-1),La={class:"form-check"},Fa={class:"form-check"},Ia=["value"],Va={key:2},ja={class:"text-center"},Ea={class:"text-center"},Ra={key:0,class:"element-count mb-2"},za={class:"col-lg-4"},Ma={class:"card-body"},qa={class:"mb-3 form-item",name:"nameFaculty"},xa={for:"division-name-select",class:"form-label"},Ha={class:"mb-3 form-item",name:"nameSpecial"},Ya={for:"division-name-select",class:"form-label"},Za={class:"mb-3 form-item",name:"plan"},Ja={for:"division-name-select",class:"form-label"},Ka={class:"mb-3 form-item",name:"optionsGroup"},Qa={for:"division-name-select",class:"form-label"},Wa={key:0,class:"text-danger small"},Xa={class:"mb-3 form-item",name:"semester"},ae={for:"division-name-select",class:"form-label"},ee={key:0,class:"text-danger small"},te={class:"d-flex justify-content-end"},se=["disabled"],le=e("i",{class:"mdi mdi-account-check font-size-14 align-middle me-1"},null,-1),fe=W({__name:"attach",async setup(k){let r,C;const{t:_}=X(),U=aa(),y=P(!1);$({});const a=$({current_page:1,data:[],links:[],search:"",edu_plan_id:null,academic_year_id:null,edu_type_id:null,semester_id:null,academic_group_id:null,edu_form_id:null,page:1,per_page:f.pagePer,students:[],faculty_id:null,specialty_id:null}),N=P(),c=$({specialOptions:null,eduPlanOptions:null,academicGroupOptions:null,semesterOptions:null}),S=P([]),A=ea({get(){return a.students.length===S.value.length},set(t){t?a.students=S.value:a.students=[]}});[r,C]=ta(()=>v()),await r,C(),sa(async()=>{var i,n,d;const t=la();a.faculty_id=(n=(i=t==null?void 0:t.user)==null?void 0:i.faculty)==null?void 0:n.name;let l=await ra();c.specialOptions=(d=l==null?void 0:l.result)==null?void 0:d.data.map(g=>({id:g.id,name:g.code+" - "+g.name}))}),B(()=>a.specialty_id,async()=>{var l;let t=await ca(a.specialty_id);a.edu_plan_id=null,c.eduPlanOptions=(l=t==null?void 0:t.result)==null?void 0:l.data}),B(()=>a.edu_plan_id,async()=>{var t,l;if(a.semester_id=null,a.academic_group_id=null,c.semesterOptions=null,c.academicGroupOptions=null,a.edu_plan_id){let i=await ua(a);c.semesterOptions=(t=i==null?void 0:i.result)==null?void 0:t.data.map(d=>({id:d.id,name:d.semester+`-${_("semestr")} / `+d.course+`-${_("course_number")}`}));let n=await _a(a.edu_plan_id);c.academicGroupOptions=(l=n==null?void 0:n.result)==null?void 0:l.data.map(d=>({id:d.id,name:d.name}))}}),B(()=>a.search,async(t,l)=>{a.search==""&&N.value==1&&(await v(),N.value=0)}),B(()=>a.current_page,async t=>{Number(t)&&(a.page=Number(t),await v(t))});const h=$({semester_id:[],specialty_id:[]});async function q(){await v(),N.value=1}async function x(){var t,l;try{y.value=!0,H();let i={students:a.students,semester_id:a.semester_id,academic_group_id:a.academic_group_id};pa.fire({title:_("Delete_message.Are_you_sure"),text:_("Delete_message.Action_irreversible"),showCancelButton:!0,confirmButtonColor:"#34c38f",cancelButtonColor:"#f46a6a",cancelButtonText:_("No_Cancel"),confirmButtonText:_("transfer")}).then(async n=>{n.value&&(await ha(i),U.success(_("Data_was_successfully_transferred")),location.reload())})}catch(i){Object.assign(h,(l=(t=i.response)==null?void 0:t.data)==null?void 0:l.errors),U.error(_("Failed")+": "+i.message)}finally{y.value=!1,await v()}}function H(){Object.assign(h,{specialty_id:[],semester_id:[],academic_group_id:[]})}async function v(t){y.value=!0;let l={page:t||1,per_page:a.per_page};a.specialty_id&&(l.specialty_id=a.specialty_id),a.search&&(l.search=a.search);try{const i=await ma(l);Object.assign(a,i.result),S.value=a.data.map(n=>n.id)}catch(i){console.log(i)}finally{y.value=!1}}return(t,l)=>{var D;const i=K,n=T("a-input"),d=T("a-space"),g=J,b=T("a-select");return u(),p("div",fa,[e("div",ya,[e("div",va,[e("div",ga,[e("h5",ba,o(t.$t("Retraining_Student_Register")),1),wa])])]),e("div",Oa,[e("div",ka,[e("div",$a,[e("div",Ba,[y.value?(u(),V(i,{key:0})):w("",!0),e("form",{class:"row py-2",onSubmit:j(q,["prevent"])},[e("div",Na,[m(d,null,{default:oa(()=>[m(n,{id:"yu",value:a.search,"onUpdate:value":l[0]||(l[0]=s=>a.search=s),class:"form-control","allow-clear":""},null,8,["value"])]),_:1}),e("label",Sa,o(t.$t("Search_by_Name_Student_ID_Passport_PIN")),1)]),e("div",Pa,[e("button",Ta,[Ca,E(o(t.$t("Search")),1)])])],32),a.data.length?(u(),p("div",Ua,[e("table",Aa,[e("thead",null,[e("tr",Da,[Ga,e("th",null,[e("div",La,[R(e("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":l[1]||(l[1]=s=>A.value=s)},null,512),[[z,A.value]])])]),e("th",null,o(t.$t("Student")),1),e("th",null,o(t.$t("by_Specialty")),1),e("th",null,o(t.$t("Year_Of_Enter")),1),e("th",null,o(t.$t("Education_Type")),1),e("th",null,o(t.$t("Payment_Form")),1)])]),e("tbody",null,[(u(!0),p(ia,null,na(a.data,(s,Y)=>{var G,L,F,I;return u(),p("tr",{class:"table-row w-100 d-grid",key:s.id},[e("td",null,o((a.current_page-1)*a.per_page+Y+1),1),e("td",null,[e("div",Fa,[R(e("input",{type:"checkbox",class:"form-check-input","onUpdate:modelValue":l[2]||(l[2]=Z=>a.students=Z),value:s.id},null,8,Ia),[[z,a.students]])])]),e("td",null,o(s==null?void 0:s.surname)+" "+o(s==null?void 0:s.name)+" "+o(s==null?void 0:s.last_name),1),e("td",null,o((G=s==null?void 0:s.specialty)==null?void 0:G.code),1),e("td",null,o(s==null?void 0:s.date_start),1),e("td",null,o((F=(L=s==null?void 0:s.specialty)==null?void 0:L.edu_type)==null?void 0:F.name),1),e("td",null,o((I=s==null?void 0:s.payment_type)==null?void 0:I.name),1)])}),128))])]),a.last_page>1?(u(),V(g,da({key:0,class:"mt-2"},{...a},{"current-page":a.current_page,"onUpdate:currentPage":l[3]||(l[3]=s=>a.current_page=s)}),null,16,["current-page"])):w("",!0)])):(u(),p("div",Va,[e("h5",ja,o(t.$t("No_data")),1),e("p",Ea,o(t.$t("No_information_found")),1)]))])]),a.data.length?(u(),p("span",Ra,o(a.current_page)+"-"+o(a.data.length+a.per_page*(a.current_page-1))+"/ "+o(t.$t("Total_Point"))+": "+o(a.total),1)):w("",!0)]),e("div",za,[e("form",{onSubmit:j(x,["prevent"]),class:"card"},[e("div",Ma,[e("div",qa,[e("label",xa,o(t.$t("Structure_Faculty")),1),m(b,{"allow-clear":"",disabled:"","filter-option":O(f).filterOptionByName,"show-search":"","field-names":{value:"id",label:"name"},value:a.faculty_id,"onUpdate:value":l[4]||(l[4]=s=>a.faculty_id=s),placeholder:"Tanlang"},null,8,["filter-option","value"])]),e("div",Ha,[e("label",Ya,o(t.$t("by_Specialty")),1),m(b,{"allow-clear":"",value:a.specialty_id,"onUpdate:value":l[5]||(l[5]=s=>a.specialty_id=s),"filter-option":O(f).filterOptionByName,"show-search":"","field-names":{value:"id",label:"name"},options:c.specialOptions,disabled:!a.faculty_id,placeholder:"Tanlang"},null,8,["value","filter-option","options","disabled"])]),e("div",Za,[e("label",Ja,o(t.$t("Curriculum")),1),m(b,{"allow-clear":"",value:a.edu_plan_id,"onUpdate:value":l[6]||(l[6]=s=>a.edu_plan_id=s),"filter-option":O(f).filterOptionByName,"show-search":"","field-names":{value:"id",label:"name"},options:c.eduPlanOptions,disabled:!a.specialty_id,placeholder:"Tanlang"},null,8,["value","filter-option","options","disabled"])]),e("div",Ka,[e("label",Qa,o(t.$t("Group")),1),m(b,{"allow-clear":"",value:a.academic_group_id,"onUpdate:value":l[7]||(l[7]=s=>a.academic_group_id=s),disabled:!a.edu_plan_id,"filter-option":O(f).filterOptionByName,"show-search":"","field-names":{value:"id",label:"name"},options:c.academicGroupOptions,placeholder:"Tanlang"},null,8,["value","disabled","filter-option","options"]),h.academic_group_id?(u(),p("span",Wa,o(h.academic_group_id[0]),1)):w("",!0)]),e("div",Xa,[e("label",ae,o(t.$t("Semester_Name")),1),m(b,{"allow-clear":"",value:a.semester_id,"onUpdate:value":l[8]||(l[8]=s=>a.semester_id=s),disabled:!a.academic_group_id,"filter-option":O(f).filterOptionByName,"show-search":"","field-names":{value:"id",label:"name"},options:c.semesterOptions,placeholder:"Tanlang"},null,8,["value","disabled","filter-option","options"]),h.semester_id?(u(),p("span",ee,o(h.semester_id[0]),1)):w("",!0)]),e("div",te,[e("button",{class:"btns c-save py-1.5 px-4",type:"submit",disabled:!(((D=a.students)==null?void 0:D.length)>0)||!a.semester_id},[le,E(o(t.$t("Send_Grades")),1)],8,se)])])],32)])])])}}});export{fe as default};
