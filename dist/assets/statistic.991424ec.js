import{_ as j}from"./Pagination.f4a9fc5d.js";import{_ as z}from"./LoadingOverlay.vue_vue_type_script_setup_true_lang.89ce9ad6.js";/* empty css                                                       */import{e as A,a as I,b as q}from"./index.30e99442.js";import{bR as G,d as M,a as Z,B as F,h as H,c as J,Z as B,y as K,w as L,bq as Q,i as y,b6 as W,o as n,e as _,f as t,t as o,bs as X,z as v,j as i,k as r,g as d,s as T,l as C,F as D,r as x,aR as tt}from"./index.3390162f.js";import{h as u}from"./helper.569bc08f.js";import"./_plugin-vue_export-helper.cdc0426e.js";import"./vue.runtime.esm-bundler.84001772.js";import"./sweetalert2.all.fdef424e.js";import"./moment.2cad4b18.js";const et=G();async function st(k){try{const{data:p}=await et({url:"/api/attendances/statistic",params:k});return p}catch(p){throw p}}const at={pagetitle:"'Statistik davomat'",class:"attStatisticPage"},ot={class:"card panel-header-bg"},lt={class:"card-body"},it={class:"panel-header"},rt={class:"card-title"},nt={class:"filterBlock"},dt={class:"btns c-filter py-1.5 px-4"},ct=t("i",{class:"mdi mdi-filter font-size-14 align-middle me-1"},null,-1),_t={class:"collapse__block"},ut={class:"row"},pt={class:"my-2 col-xl-3 form--item"},ft={for:"yu"},ht={class:"my-2 col-xl-2 form--item"},mt={for:"yu"},yt={class:"my-2 col-xl-2 form--item"},vt={for:"yu"},gt={class:"my-2 col-md-3 form--item"},bt={for:"yu"},wt={class:"my-2 col-xl-2 form--item"},$t={for:"yu"},Ct={class:"card"},kt={class:"card-body"},Nt={key:1,class:"table-responsive"},Ot={class:"content-table"},Ft={class:"table-row-all-statistic-attendance"},Bt=t("th",null,"#",-1),Lt={key:2},Tt={class:"text-center"},St={class:"text-center"},Et={key:0,class:"element-count mb-2"},Gt=M({__name:"statistic",async setup(k){let p,N;const{t:h}=Z(),g=F(!1),b=H(),S=J(()=>{var s,l;return(l=(s=b==null?void 0:b.user)==null?void 0:s.faculty)==null?void 0:l.name}),e=B({edu_type_id:null,edu_form_id:null,academic_year:null,semester_type:null,data:[],links:[],current_page:1,per_page:u.pagePer}),m=B({eduTypeOptions:null,eduFormList:null}),w=F(!0);K(async()=>{m.eduTypeOptions=await A().then(s=>s.result),e.academic_year=await I().then(s=>s.result.data.find(l=>(l==null?void 0:l.is_current)==!0)),m.eduFormList=await q().then(s=>s.result)}),L(()=>[e.edu_type_id,e.semester_type,e.edu_form_id],async()=>{await $()}),[p,N]=Q(()=>$()),await p,N(),L(()=>e.current_page,async s=>{Number(s)&&(e.page=Number(s),await $())});async function $(){let s={};e.page>1&&(s.page=e==null?void 0:e.page),e.edu_type_id&&(s.edu_type_id=e.edu_type_id),e.semester_type&&(s.semester_type=e.semester_type),e.edu_form_id&&(s.edu_form_id=e.edu_form_id),g.value=!0;try{if(w.value){w.value=!1;const l=await st(s);Object.assign(e,l.result),setTimeout(()=>{w.value=!0},u.loaderRefresh)}}catch(l){console.log(l)}finally{g.value=!1}}return(s,l)=>{const c=y("a-select"),f=y("a-space"),E=y("b-card"),P=y("b-collapse"),U=z,R=j,V=W("b-toggle");return n(),_("div",at,[t("div",ot,[t("div",lt,[t("div",it,[t("h5",rt,o(s.$t("attendance_Overall")),1),t("div",nt,[X((n(),_("button",dt,[ct,v(o(s.$t("Filter")),1)])),[[V,void 0,void 0,{"collapse-3":!0}]])])])])]),t("div",_t,[i(P,{visible:"",id:"collapse-3"},{default:r(()=>[i(E,null,{default:r(()=>[t("div",ut,[t("div",pt,[i(f,null,{default:r(()=>[i(c,{"filter-option":d(u).filterOptionByName,"show-search":"",class:"form--item",value:S.value,disabled:""},null,8,["filter-option","value"])]),_:1}),t("label",ft,o(s.$t("Choose_faculty")),1)]),t("div",ht,[i(f,null,{default:r(()=>{var a;return[i(c,{"filter-option":d(u).filterOptionByName,"show-search":"","allow-clear":"",disabled:"",value:((a=e==null?void 0:e.academic_year)==null?void 0:a.name)||null,placeholder:d(h)("Choose_Education_Year")},null,8,["filter-option","value","placeholder"])]}),_:1}),t("label",mt,o(s.$t("Choose_Education_Year")),1)]),t("div",yt,[i(f,null,{default:r(()=>[i(c,{"filter-option":d(u).filterOptionByName,"show-search":"","allow-clear":"",value:e.edu_type_id,"onUpdate:value":l[0]||(l[0]=a=>e.edu_type_id=a),"field-names":{value:"id",label:"name"},options:m.eduTypeOptions,placeholder:d(h)("Choose_Education_Type")},null,8,["filter-option","value","options","placeholder"])]),_:1}),t("label",vt,o(s.$t("Choose_Education_Type")),1)]),t("div",gt,[i(f,null,{default:r(()=>[i(c,{"filter-option":d(u).filterOptionByName,"show-search":"","allow-clear":"",value:e.edu_form_id,"onUpdate:value":l[1]||(l[1]=a=>e.edu_form_id=a),"field-names":{value:"id",label:"name"},options:m.eduFormList,placeholder:d(h)("Choose_Education_Form")},null,8,["filter-option","value","options","placeholder"])]),_:1}),t("label",bt,o(s.$t("Choose_Education_Form")),1)]),t("div",wt,[i(f,null,{default:r(()=>[i(c,{"filter-option":d(u).filterOptionByName,"show-search":"",class:"form--item",placeholder:d(h)("Choose_Semestr_Type"),allowClear:"",value:e.semester_type,"onUpdate:value":l[2]||(l[2]=a=>e.semester_type=a)},{default:r(()=>[v(" > "),i(c,{value:"0"},{default:r(()=>[v(o(s.$t("Spring_semester")),1)]),_:1}),i(c,{value:"1"},{default:r(()=>[v(o(s.$t("Fall_semester")),1)]),_:1})]),_:1},8,["filter-option","placeholder","value"])]),_:1}),t("label",$t,o(s.$t("Choose_Semestr_Type")),1)])])]),_:1})]),_:1})]),t("div",Ct,[t("div",kt,[g.value?(n(),T(U,{key:0})):C("",!0),e.data.length?(n(),_("div",Nt,[t("table",Ot,[t("thead",null,[t("tr",Ft,[Bt,t("th",null,o(s.$t("Student")),1),t("th",null,o(s.$t("by_Specialty")),1),t("th",null,o(s.$t("Education_Form")),1),t("th",null,o(s.$t("Group")),1),t("th",null,o(s.$t("Semester_Name")),1),t("th",null,o(s.$t("Total_Point")),1),t("th",null,o(s.$t("absent_On")),1),t("th",null,o(s.$t("absent_Off")),1)])]),t("tbody",null,[(n(!0),_(D,null,x(e.data,(a,Y)=>{var O;return n(),_("tr",{class:"table-row-all-statistic-attendance",key:a.id},[t("td",null,o((e.current_page-1)*e.per_page+Y+1),1),t("td",null,o(a==null?void 0:a.fullname),1),t("td",null,o((O=a==null?void 0:a.specialty)==null?void 0:O.code),1),t("td",null,o(a==null?void 0:a.edu_form),1),t("td",null,o(a==null?void 0:a.academic_group),1),t("td",null,o(a==null?void 0:a.semester)+"-"+o(s.$t("semestr")),1),t("td",null,o(a==null?void 0:a.total),1),t("td",null,o(a==null?void 0:a.caused),1),t("td",null,o(a==null?void 0:a.uncaused),1)])}),128))])]),e.last_page>1?(n(),T(R,tt({key:0,class:"mt-2"},{...e},{"current-page":e.current_page,"onUpdate:currentPage":l[3]||(l[3]=a=>e.current_page=a)}),null,16,["current-page"])):C("",!0)])):(n(),_("div",Lt,[t("h5",Tt,o(s.$t("No_data")),1),t("p",St,o(s.$t("No_information_found")),1)]))])]),e.data.length?(n(),_("span",Et,o(e.current_page)+"-"+o((e==null?void 0:e.data.length)+e.per_page*(e.current_page-1))+"/ "+o(s.$t("Total_Point"))+": "+o(e.total),1)):C("",!0)])}}});export{Gt as default};
