import{_ as W}from"./Pagination.f4a9fc5d.js";import{_ as X}from"./LoadingOverlay.vue_vue_type_script_setup_true_lang.89ce9ad6.js";/* empty css                                                       */import{bR as ee,d as ae,a as te,B as F,Z as C,bO as se,c as oe,bq as ne,y as le,w as b,i as B,b6 as ie,o as u,e as f,f as a,t as l,bs as P,z as M,j as p,k as S,v as de,g as _,s as V,l as N,bH as j,F as re,r as ce,aR as ue}from"./index.3390162f.js";import{k as _e}from"./index.30e99442.js";import{a as me,b as pe,s as fe}from"./id.5a6e5f30.js";import{S as he}from"./sweetalert2.all.fdef424e.js";import{h as y}from"./helper.569bc08f.js";import"./_plugin-vue_export-helper.cdc0426e.js";import"./vue.runtime.esm-bundler.84001772.js";import"./moment.2cad4b18.js";const Y=ee();async function ve(g){try{const{data:i}=await Y({url:"api/students/academic-leave",method:"GET",params:g});return i}catch(i){throw i}}async function ye(g){try{const{data:i}=await Y({url:"api/references/academic-break-reasons",method:"GET"});return i}catch(i){throw i}}async function ge(g){try{const{data:i}=await Y({url:"api/commands/list/academic-leave",method:"GET"});return i}catch(i){throw i}}async function be(g){try{const{data:i}=await Y({url:"/api/student-actions/academic-leave",method:"POST",data:g});return i}catch(i){throw i}}const we={pagetitle:"'Akademik tatil'",class:"transfer-vacation-page"},Oe={class:"card panel-header-bg"},ke={class:"card-body"},Ce={class:"panel-header"},Be={class:"card-title"},Ne={class:"filterBlock"},Ye={class:"btns c-filter py-1.5 px-4"},$e=a("i",{class:"mdi mdi-filter font-size-14 align-middle me-1"},null,-1),Fe={class:"collapse__block"},Pe={class:"col-xl-3 form--item"},Se={class:"my-2",name:"nameFaculty"},xe={class:"col-xl-3 form--item"},Ue={class:"my-2",name:"nameFaculty"},De={class:"col-xl-3 form--item"},Ge={class:"my-2",name:"nameFaculty"},Le={class:"col-xl-3 form--item"},Te={class:"my-2",name:"nameFaculty"},Ae={class:"row"},Ee={class:"col-xl-8"},Me={class:"card"},Ve={class:"card-body"},je={key:1,class:"table-responsive"},Ie={class:"content-table"},Re={class:"table-row d-grid w-100"},ze=a("th",null,"#",-1),qe={class:"form-check"},He=["value"],Ze={key:2},Je={class:"text-center"},Ke={class:"text-center"},Qe={key:0,class:"element-count mb-2"},We={class:"col-xl-4"},Xe={class:"card"},ea={class:"card-body"},aa={class:"mb-3",name:"nameFaculty"},ta={for:"division-name-select",class:"form-label"},sa={key:0,class:"text-danger small"},oa={class:"mb-3",name:"nameFaculty"},na={for:"division-name-select",class:"form-label"},la={key:0,class:"text-danger small"},ia={class:"mb-3",name:"nameFaculty"},da={for:"division-name-input",class:"form-label"},ra={class:"d-flex justify-content-end"},ca=["disabled"],ua=a("i",{class:"mdi mdi-check font-size-14 align-middle me-1"},null,-1),ka=ae({__name:"transfer-vacation",async setup(g){let i,x;const{t:r}=te(),w=F(!1);C({});const U=se(),e=C({search:"",edu_plan_id:null,academic_year_id:null,semester_id:null,academic_group_id:null,reference_id:null,command_id:null,current_page:1,data:[],links:[],page:1,per_page:y.pagePer,students:[]}),d=C({eduPlanOptions:null,academicYearsOptions:null,semesterOptions:null,academicGroupOptions:null,referenceOptions:null,orderOptions:null}),O=F([]),$=F(!0),D=oe({get(){var s,t;return((s=e==null?void 0:e.students)==null?void 0:s.length)===((t=O==null?void 0:O.value)==null?void 0:t.length)},set(s){s?e.students=O.value:e.students=[]}});[i,x]=ne(()=>h()),await i,x(),le(async()=>{var t;let s=await _e();d.eduPlanOptions=(t=s==null?void 0:s.result)==null?void 0:t.data,d.referenceOptions=await ye().then(n=>n.result),d.orderOptions=await ge().then(n=>{var m;return(m=n==null?void 0:n.result)==null?void 0:m.data.map(c=>({id:c.id,name:c.name,date:c.date}))})}),b(()=>e.edu_plan_id,async()=>{var s,t;if(e.academic_year_id=null,e.semester_id=null,e.academic_group_id=null,d.academicYearsOptions=null,d.academicGroupOptions=null,d.semesterOptions=null,await h(),e.edu_plan_id){let n=await me(e.edu_plan_id);d.academicYearsOptions=(s=n==null?void 0:n.result)==null?void 0:s.data.map(c=>({id:c.id,name:c.name}));let m=await pe(e.edu_plan_id);d.academicGroupOptions=(t=m==null?void 0:m.result)==null?void 0:t.data.map(c=>({id:c.id,name:c.name}))}}),b(()=>e.academic_year_id,async()=>{var s;if(e.semester_id=null,d.semesterOptions=null,await h(),e.edu_plan_id&&e.academic_year_id){let t=await fe(e);d.semesterOptions=(s=t==null?void 0:t.result)==null?void 0:s.data.map(n=>({id:n.id,name:n.course+"-"+r("course")+" "+n.semester+"-"+r("semester")}))}}),b(()=>e.semester_id,async()=>{await h()}),b(()=>e.academic_group_id,async()=>{await h()}),b(()=>e.current_page,async s=>{Number(s)&&(e.page=Number(s),await h(s))});async function I(){await h()}b(()=>e.command_id,()=>{e.command_id?(console.log(e.command_id),e.dateCommand=d.orderOptions.find(s=>s.id==e.command_id).date):e.dateCommand=null});async function R(){var s,t;try{w.value=!0,he.fire({title:r("Delete_message.Are_you_sure"),text:r("Delete_message.Action_irreversible"),showCancelButton:!0,confirmButtonColor:"#34c38f",cancelButtonColor:"#f46a6a",cancelButtonText:r("No_Cancel"),confirmButtonText:r("transfer")}).then(async n=>{n.value&&(await be(e),U.success(r("Data_was_successfully_transferred")),h(),z())})}catch(n){Object.assign(k,(t=(s=n.response)==null?void 0:s.data)==null?void 0:t.errors),U.error(r("Failed")+": "+n.message)}finally{w.value=!1}}function z(){e.students=[],e.reference_id=null,e.command_id=null}const k=C({command_id:[],reference_id:[],students:[]});async function h(s){let t=C({page:s||1,per_page:e.per_page});e.edu_plan_id&&(t.edu_plan_id=e.edu_plan_id),e.academic_year_id&&(t.academic_year_id=e.academic_year_id),e.semester_id&&(t.semester_id=e.semester_id),e.academic_group_id&&(t.academic_group_id=e.academic_group_id),w.value=!0;try{if($.value){$.value=!1;const n=await ve(t);Object.assign(e,n.result),O.value=e.data.map(m=>m.id),setTimeout(()=>{$.value=!0},100)}}catch(n){console.log(n)}finally{w.value=!1}}return(s,t)=>{const n=B("a-select"),m=B("b-card"),c=B("b-collapse"),q=X,H=W,Z=B("a-input"),J=B("a-form"),K=ie("b-toggle");return u(),f("div",we,[a("div",Oe,[a("div",ke,[a("div",Ce,[a("h5",Be,l(s.$t("academic_leave")),1),a("div",Ne,[P((u(),f("button",Ye,[$e,M(l(s.$t("Filter")),1)])),[[K,void 0,void 0,{"collapse-3":!0}]])])])])]),a("div",Fe,[p(c,{visible:"",id:"collapse-3"},{default:S(()=>[p(m,null,{default:S(()=>[a("form",{class:"row",onSubmit:de(I,["prevent"])},[a("div",Pe,[a("div",Se,[p(n,{"filter-option":_(y).filterOptionByName,"show-search":"","allow-clear":"",value:e.edu_plan_id,"onUpdate:value":t[0]||(t[0]=o=>e.edu_plan_id=o),"field-names":{value:"id",label:"name"},options:d.eduPlanOptions,placeholder:s.$t("Please_select_curriculum")},null,8,["filter-option","value","options","placeholder"])])]),a("div",xe,[a("div",Ue,[p(n,{"filter-option":_(y).filterOptionByName,"show-search":"","allow-clear":"",value:e.academic_year_id,"onUpdate:value":t[1]||(t[1]=o=>e.academic_year_id=o),disabled:!e.edu_plan_id,"field-names":{value:"id",label:"name"},options:d.academicYearsOptions,placeholder:_(r)("Choose_Education_Year")},null,8,["filter-option","value","disabled","options","placeholder"])])]),a("div",De,[a("div",Ge,[p(n,{"filter-option":_(y).filterOptionByName,"show-search":"","allow-clear":"",disabled:!e.academic_year_id,value:e.semester_id,"onUpdate:value":t[2]||(t[2]=o=>e.semester_id=o),"field-names":{value:"id",label:"name"},options:d.semesterOptions,placeholder:_(r)("Choose_Semester")},null,8,["filter-option","disabled","value","options","placeholder"])])]),a("div",Le,[a("div",Te,[p(n,{"filter-option":_(y).filterOptionByName,"show-search":"","allow-clear":"",disabled:!e.edu_plan_id,value:e.academic_group_id,"onUpdate:value":t[3]||(t[3]=o=>e.academic_group_id=o),"field-names":{value:"id",label:"name"},options:d.academicGroupOptions,placeholder:_(r)("Choose_Group")},null,8,["filter-option","disabled","value","options","placeholder"])])])],32)]),_:1})]),_:1})]),a("div",Ae,[a("div",Ee,[a("div",Me,[a("div",Ve,[w.value?(u(),V(q,{key:0})):N("",!0),e.data.length?(u(),f("div",je,[a("table",Ie,[a("thead",null,[a("tr",Re,[ze,a("th",null,[P(a("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":t[4]||(t[4]=o=>D.value=o)},null,512),[[j,D.value]])]),a("th",null,l(s.$t("Student")),1),a("th",null,l(s.$t("by_Specialty")),1),a("th",null,l(s.$t("Education_Year_Name")),1),a("th",null,l(s.$t("Payment_Form")),1)])]),a("tbody",null,[(u(!0),f(re,null,ce(e.data,(o,v)=>{var G,L,T,A,E;return u(),f("tr",{class:"table-row w-100 d-grid",key:o.id},[a("td",null,l((e.current_page-1)*e.per_page+v+1),1),a("td",null,[a("div",qe,[P(a("input",{type:"checkbox",class:"form-check-input","onUpdate:modelValue":t[5]||(t[5]=Q=>e.students=Q),value:o.id},null,8,He),[[j,e.students]])])]),a("td",null,l(o.name)+" "+l(o.surname),1),a("td",null,l((G=o==null?void 0:o.specialty)==null?void 0:G.id)+" / "+l((L=o==null?void 0:o.specialty)==null?void 0:L.name),1),a("td",null,l((A=(T=o==null?void 0:o.semester)==null?void 0:T.academic_year)==null?void 0:A.name),1),a("td",null,l((E=o==null?void 0:o.payment_type)==null?void 0:E.name),1)])}),128))])]),e.last_page>1?(u(),V(H,ue({key:0,class:"mt-2"},{...e},{"current-page":e.current_page,"onUpdate:currentPage":t[6]||(t[6]=o=>e.current_page=o)}),null,16,["current-page"])):N("",!0)])):(u(),f("div",Ze,[a("h5",Je,l(s.$t("No_data")),1),a("p",Ke,l(s.$t("No_information_found")),1)]))])]),e.data.length?(u(),f("span",Qe,l(e.current_page)+"-"+l((e==null?void 0:e.data.length)+e.per_page*(e.current_page-1))+"/ "+l(s.$t("Total_Point"))+": "+l(e.total),1)):N("",!0)]),a("div",We,[a("div",Xe,[a("div",ea,[p(J,null,{default:S(()=>{var o;return[a("div",aa,[a("label",ta,l(s.$t("Status_Change_Reason")),1),p(n,{"filter-option":_(y).filterOptionByName,"show-search":"","allow-clear":"",value:e.reference_id,"onUpdate:value":t[7]||(t[7]=v=>e.reference_id=v),"field-names":{value:"id",label:"name"},options:d.referenceOptions,placeholder:_(r)("choose__reason")},null,8,["filter-option","value","options","placeholder"]),k.reference_id?(u(),f("span",sa,l(k.reference_id[0]),1)):N("",!0)]),a("div",oa,[a("label",na,l(s.$t("Decree")),1),p(n,{"filter-option":_(y).filterOptionByName,"show-search":"","allow-clear":"",value:e.command_id,"onUpdate:value":t[8]||(t[8]=v=>e.command_id=v),"field-names":{value:"id",label:"name"},options:d.orderOptions,placeholder:_(r)("Select_the_command")},null,8,["filter-option","value","options","placeholder"]),k.command_id?(u(),f("span",la,l(k.command_id[0]),1)):N("",!0)]),a("div",ia,[a("label",da,l(s.$t("Circulation_Doc_Date")),1),p(Z,{value:e.dateCommand,"onUpdate:value":t[9]||(t[9]=v=>e.dateCommand=v),placeholder:"YYYY-MM-DD",disabled:"","value-format":"YYYY-MM-DD"},null,8,["value"])]),a("div",ra,[a("button",{onClick:R,disabled:!((o=e==null?void 0:e.students)!=null&&o.length)||!e.command_id||!e.reference_id,class:"btns c-save",type:"button"},[ua,M("Ok ")],8,ca)])]}),_:1})])])])])])}}});export{ka as default};
