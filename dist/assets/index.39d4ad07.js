import{_ as T}from"./Pagination.f4a9fc5d.js";import{_ as U}from"./LoadingOverlay.vue_vue_type_script_setup_true_lang.89ce9ad6.js";/* empty css                                                       */import{bR as z,d as D,a as I,Z as w,B as P,y as V,w as $,i as v,b6 as A,o as c,e as p,f as s,t as l,z as O,bs as M,j as r,k as m,v as R,g as k,s as B,l as C,F as q,r as Z,aR as H}from"./index.3390162f.js";import{j as J}from"./index.30e99442.js";import{a as K,b as Q,s as W}from"./id.5a6e5f30.js";import{h as X}from"./helper.569bc08f.js";import"./_plugin-vue_export-helper.cdc0426e.js";import"./vue.runtime.esm-bundler.84001772.js";import"./sweetalert2.all.fdef424e.js";import"./moment.2cad4b18.js";const G=z();async function x(f,n){try{const{data:h}=await G({url:`api/academic-debtors?semester_id=${f}&academic_group_id=${n}`,method:"GET"});return h}catch(h){throw h}}async function ee(f){try{const{data:n}=await G({url:"api/academic-debtors/export",params:f,responseType:"blob"});return n}catch(n){throw n}}const ae={pagetitle:"'Akademik qarzdorlar'",class:"debtorsPage"},se={class:"card panel-header-bg"},te={class:"card-body"},oe={class:"panel-header"},le={class:"card-title"},ie={class:"panel-toggles"},de={class:"filterBlock"},ne=["disabled"],re=s("i",{class:"mdi mdi-download font-size-14 align-middle me-1"},null,-1),ce={class:"btns c-filter py-1.5 px-4"},_e=s("i",{class:"mdi mdi-filter font-size-14 align-middle me-1"},null,-1),ue={class:"collapse__block"},pe={class:"my-2 col-md-3 form--item"},me={for:"yu"},he={class:"my-2 col-md-3 form--item"},be={for:"yu"},fe={class:"my-2 col-md-2 form--item"},ve={class:"my-2 col-md-2 form--item"},ye={class:"my-2 col-md-2"},ge=["disabled"],we=s("i",{class:"mdi mdi-eye me-2"},null,-1),$e={class:"card"},Oe={class:"card-body"},ke={key:1,class:"table-responsive"},Ce={class:"content-table"},Ne={class:"table-row d-grid w-100"},Pe=s("th",null,"#",-1),Be={key:2},Ge={class:"text-center"},Se={class:"text-center"},Ye={key:0,class:"element-count mb-2"},Me=D({__name:"index",setup(f){const{t:n}=I(),h=w({}),b=P(!1),y=P(!0),e=w({search:"",data:[],edu_plan_id:null,academic_year_id:null,course:null,semester_id:null,academic_group_id:null,current_page:1}),d=w({eduPlanOptions:null,academicYearsOptions:null,semesterOptions:null,academicGroupOptions:null});V(async()=>{d.eduPlanOptions=await J().then(a=>{var o;return(o=a==null?void 0:a.result)==null?void 0:o.data})}),$(()=>e.edu_plan_id,async()=>{var a,o;if(e.academic_year_id=null,e.semester_id=null,e.academic_group_id=null,d.academicYearsOptions=null,d.academicGroupOptions=null,d.semesterOptions=null,e.data=[],e.total=0,e.edu_plan_id){let i=await K(e.edu_plan_id);d.academicYearsOptions=(a=i==null?void 0:i.result)==null?void 0:a.data.map(u=>({id:u.id,name:u.name}));let _=await Q(e.edu_plan_id);d.academicGroupOptions=(o=_==null?void 0:_.result)==null?void 0:o.data.map(u=>({id:u.id,name:u.name}))}}),$(()=>e.academic_year_id,async()=>{var a;if(e.semester_id=null,d.semesterOptions=null,await g(),e.edu_plan_id&&e.academic_year_id){let o=await W(e);d.semesterOptions=(a=o==null?void 0:o.result)==null?void 0:a.data.map(i=>({id:i.id,semester:i.semester,name:i.course+"-"+n("Course")+" "+i.semester+"-"+n("semester")}))}}),$(()=>e.current_page,async a=>{Number(a)&&(e.page=Number(a),await g())});async function S(){await g()}async function g(){try{if(b.value=!0,Object.assign(h,e),e.semester_id&&e.academic_group_id&&y.value){y.value=!1;const a=await x(e.semester_id,e.academic_group_id);Object.assign(e,a.result),setTimeout(()=>{y.value=!0},100)}}catch(a){console.log(a)}finally{b.value=!1}}async function Y(){let a={};e.search&&(a.search=e.search),e.course&&(a.course=e.course),e.academic_group_id&&(a.academic_group_id=e.academic_group_id),e.semester_id&&(a.semester_id=e.semester_id),e.academic_year_id&&(a.academic_year_id=e.academic_year_id),e.edu_plan_id&&(a.edu_plan_id=e.edu_plan_id);try{b.value=!0,await X.downloadFile(ee,a)}catch(o){console.log({error:o})}finally{b.value=!1}}return(a,o)=>{const i=v("a-select"),_=v("a-space"),u=v("b-card"),E=v("b-collapse"),F=U,L=T,j=A("b-toggle");return c(),p("div",ae,[s("div",se,[s("div",te,[s("div",oe,[s("h5",le,l(a.$t("Debtor_List")),1),s("div",ie,[s("div",de,[s("button",{onClick:o[0]||(o[0]=t=>Y()),disabled:(e==null?void 0:e.data.length)===0,class:"btns c-save py-1.5 px-4 me-3",type:"submit"},[re,O(l(a.$t("Excel_report")),1)],8,ne),M((c(),p("button",ce,[_e,O(l(a.$t("Filter")),1)])),[[j,void 0,void 0,{"collapse-3":!0}]])])])])])]),s("div",ue,[r(E,{visible:"",id:"collapse-3"},{default:m(()=>[r(u,null,{default:m(()=>[s("form",{class:"row",onSubmit:o[5]||(o[5]=R(t=>S(),["prevent"]))},[s("div",pe,[r(_,null,{default:m(()=>[r(i,{"allow-clear":"",value:e.edu_plan_id,"onUpdate:value":o[1]||(o[1]=t=>e.edu_plan_id=t),"field-names":{value:"id",label:"name"},options:d.eduPlanOptions,placeholder:a.$t("Please_select_curriculum")},null,8,["value","options","placeholder"])]),_:1}),s("label",me,l(a.$t("Choose_Curriculum")),1)]),s("div",he,[r(_,null,{default:m(()=>[r(i,{"allow-clear":"",value:e.academic_year_id,"onUpdate:value":o[2]||(o[2]=t=>e.academic_year_id=t),"field-names":{value:"id",label:"name"},options:d.academicYearsOptions,disabled:!e.edu_plan_id,placeholder:k(n)("Choose_Education_Year")},null,8,["value","options","disabled","placeholder"])]),_:1}),s("label",be,l(a.$t("Choose_Education_Year")),1)]),s("div",fe,[r(_,null,{default:m(()=>[r(i,{"allow-clear":"",value:e.semester_id,"onUpdate:value":o[3]||(o[3]=t=>e.semester_id=t),"field-names":{value:"id",label:"name"},options:d.semesterOptions,disabled:!e.academic_year_id,placeholder:k(n)("Choose_Semester")},null,8,["value","options","disabled","placeholder"])]),_:1}),s("label",null,l(a.$t("Choose_Semester")),1)]),s("div",ve,[r(_,null,{default:m(()=>[r(i,{"allow-clear":"",value:e.academic_group_id,"onUpdate:value":o[4]||(o[4]=t=>e.academic_group_id=t),"field-names":{value:"id",label:"name"},options:d.academicGroupOptions,disabled:!e.edu_plan_id,placeholder:k(n)("Choose_Group")},null,8,["value","options","disabled","placeholder"])]),_:1}),s("label",null,l(a.$t("Choose_Group")),1)]),s("div",ye,[s("button",{disabled:!e.edu_plan_id||!e.academic_group_id||!e.academic_year_id||!e.semester_id,class:"btn-search c-save",type:"submit"},[we,O(l(a.$t("View")),1)],8,ge)])],32)]),_:1})]),_:1})]),s("div",$e,[s("div",Oe,[b.value?(c(),B(F,{key:0})):C("",!0),e.data.length?(c(),p("div",ke,[s("table",Ce,[s("thead",null,[s("tr",Ne,[Pe,s("th",null,l(a.$t("Student")),1),s("th",null,l(a.$t("Group")),1),s("th",null,l(a.$t("Education_Year_Name")),1),s("th",null,l(a.$t("Semester_Name")),1),s("th",null,l(a.$t("Subject_name")),1)])]),s("tbody",null,[(c(!0),p(q,null,Z(e.data,(t,N)=>(c(),p("tr",{class:"table-row d-grid w-100",key:N},[s("td",null,l((e.current_page-1)*e.per_page+N+1),1),s("td",null,l(t==null?void 0:t.fullname),1),s("td",null,l(t==null?void 0:t.academic_group),1),s("td",null,l(t==null?void 0:t.academic_year),1),s("td",null,l(t==null?void 0:t.semester)+"-"+l(a.$t("semestr")),1),s("td",null,l(t==null?void 0:t.subject),1)]))),128))])]),e.last_page>1?(c(),B(L,H({key:0,class:"mt-2"},{...e},{"current-page":e.current_page,"onUpdate:currentPage":o[6]||(o[6]=t=>e.current_page=t)}),null,16,["current-page"])):C("",!0)])):(c(),p("div",Be,[s("h5",Ge,l(a.$t("No_data")),1),s("p",Se,l(a.$t("No_information_found")),1)]))])]),e.total?(c(),p("span",Ye,l(e.current_page)+"-"+l(e.data.length+e.per_page*(e.current_page-1))+"/ "+l(a.$t("Total_Point"))+": "+l(e.total),1)):C("",!0)])}}});export{Me as default};
